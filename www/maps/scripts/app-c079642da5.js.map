{"version":3,"sources":["scripts/app.js"],"names":["MarkerClusterer","map","opt_markers","opt_options","this","extend","google","maps","OverlayView","map_","markers_","clusters_","sizes","styles_","ready_","options","gridSize_","minClusterSize_","maxZoom_","imagePath_","MARKER_CLUSTER_IMAGE_PATH_","imageExtension_","MARKER_CLUSTER_IMAGE_EXTENSION_","zoomOnClick_","undefined","averageCenter_","setupStyles_","setMap","prevZoom_","getZoom","that","event","addListener","zoom","resetViewport","redraw","length","addMarkers","Cluster","markerClusterer","markerClusterer_","getMap","getGridSize","getMinClusterSize","isAverageCenter","center_","bounds_","clusterIcon_","ClusterIcon","getStyles","cluster","styles","opt_padding","getMarkerClusterer","padding_","cluster_","div_","sums_","visible_","angular","module","openTermsDirective","restrict","link","scope","elem","attr","openModal","href","window","cordova","ThemeableBrowser","open","statusbar","color","toolbar","height","title","showPageTitle","backButtonCanClose","bind","directive","configLanguage","$translatePartialLoaderProvider","$translateProvider","AppConfig","tmhDynamicLocaleProvider","useLoader","urlTemplate","useSanitizeValueStrategy","useLocalStorage","localeLocationPattern","langvar","navigator","language","userlanguage","userlangvar","split","preferredLocale","searchLang","_","some","locales","code","filter","item","preferredLanguage","moment","locale","$inject","config","constant","path","configCompile","$compileProvider","debugInfoEnabled","startParse","$localStorage","$location","$rootScope","Parse","initialize","parse","appId","serverURL","server","currentUser","User","current","unit","mapType","type","console","log","runIonic","$ionicPlatform","$translate","$cordovaGlobalization","ConnectMonitor","ready","plugins","Keyboard","disableScroll","StatusBar","styleLightContent","registerBackButtonAction","preventDefault","lang","use","globalization","getPreferredLanguage","then","configIonic","$ionicConfigProvider","platform","ios","backButton","previousTitleText","icon","android","views","swipeBackEnabled","text","tabs","position","navBar","alignTitle","maxCache","configFacebook","$facebookProvider","setAppId","facebookAppId","setPermissions","runFacebook","LangVar","userLanguage","userLangVar","substring","toUpperCase","d","s","id","js","fjs","getElementsByTagName","getElementById","createElement","src","parentNode","insertBefore","document","run","app","name","url","image","routes","home","login","statusBarColor","gaTrackingId","onesignal","translation","DAO","tables","columns","username","email","facebookimg","gender","img","facebook","qtdFollow","status","createdAt","attributes","user_id","followId","location","isLiked","likes","action","userAvatar","userName","gallery_id","key","value","$stateProvider","$urlRouterProvider","addPart","state","templateUrl","controller","controllerAs","abstract","template","$state","logOut","go","clear","tabHome","tabSearch","tabActivity","tabProfile","otherwise","prototype","obj1","obj2","object","property","apply","onAdd","setReady_","draw","size","i","push","width","fitMapToMarkers","marker","markers","getMarkers","bounds","LatLngBounds","getPosition","fitBounds","setStyles","isZoomOnClick","getTotalMarkers","setMaxZoom","maxZoom","getMaxZoom","calculator_","numStyles","index","count","dv","parseInt","Math","min","setCalculator","calculator","getCalculator","opt_nodraw","pushMarkerTo_","isAdded","repaint","addMarker","removeMarker_","indexOf","m","splice","removeMarker","removed","removeMarkers","r","createClusters_","getTotalClusters","setGridSize","setMinClusterSize","getExtendedBounds","projection","getProjection","tr","LatLng","getNorthEast","lat","lng","bl","getSouthWest","trPix","fromLatLngToDivPixel","x","y","blPix","ne","fromDivPixelToLatLng","sw","isMarkerInBounds_","contains","clearMarkers","opt_hide","remove","oldClusters","slice","setTimeout","distanceBetweenPoints_","p1","p2","R","dLat","PI","dLon","a","sin","cos","c","atan2","sqrt","addToClosestCluster_","distance","clusterToAddTo","center","getCenter","isMarkerInClusterBounds","mapBounds","getBounds","isMarkerAlreadyAdded","l","calculateBounds_","len","updateIcon","getSize","mz","hide","sums","setCenter","setSums","show","triggerClusterClick","trigger","pos","getPosFromLatLng_","style","cssText","createCss","innerHTML","panes","getPanes","overlayMouseTarget","appendChild","isDragging","addDomListener","latlng","iconAnchor_","width_","height_","top","left","display","onRemove","removeChild","text_","index_","useStyle","max","url_","textColor_","anchor_","textSize_","backgroundPosition_","backgroundPosition","txtColor","txtSize","join","WebGLProgram","gl","vertexSource","fragmentSource","_collect","source","prefix","collection","RegExp","replace","match","_compile","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","uniform","attribute","_vsh","VERTEX_SHADER","_fsh","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","getAttribLocation","u","getUniformLocation","WebGLImageFilter","_drawCount","_sourceTexture","_lastInChain","_currentFramebufferIndex","_tempFramebuffers","_filterChain","_width","_height","_vertexBuffer","_currentProgram","_canvas","getContext","addFilter","args","Array","call","arguments","_filter","func","reset","_resize","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texImage2D","RGBA","UNSIGNED_BYTE","_compileShader","SHADER","FRAGMENT_IDENTITY","_draw","f","vertices","Float32Array","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","viewport","_getTempFramebuffer","_createFramebufferTexture","fbo","createFramebuffer","bindFramebuffer","FRAMEBUFFER","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","texture","LINEAR","framebufferTexture2D","COLOR_ATTACHMENT0","flags","target","flipY","DRAW","INTERMEDIATE","uniform1f","drawArrays","TRIANGLES","__program","VERTEX_IDENTITY","floatSize","BYTES_PER_ELEMENT","vertSize","enableVertexAttribArray","vertexAttribPointer","FLOAT","uv","colorMatrix","matrix","WITHOUT_ALPHA","WITH_ALPHA","program","uniform1fv","brightness","b","saturation","amount","desaturate","contrast","v","o","negative","hue","rotation","lumR","lumG","lumB","desaturateLuminance","sepia","brownie","vintagePinhole","kodachrome","technicolor","polaroid","shiftToBGR","convolution","pixelSizeX","pixelSizeY","uniform2f","px","detectEdges","sobelX","sobelY","sharpen","emboss","blur","blurSizeX","blurSizeY","hashtag","$filter","replacedText","targetAttr","isDefined","replacePattern1","replacePattern2","words","input","isNaN","inputWords","signinModalDirective","$ionicModal","Loading","Toast","UserForm","signinModalLink","$scope","formFields","routeLogged","form","password","submitLogin","rForm","data","copy","$invalid","start","signIn","closeModal","end","resp","alert","fromTemplateUrl","animation","focusFirstInput","modal","$on","signupModalDirective","signupModalLink","register","submitRegister","$valid","signUp","error","buyDirective","$cordovaInAppBrowser","buyLink","closeButton","imagePressed","align","compareToDirective","targetModel","require","element","attrs","ctrl","compare","e1","val","e2","$watch","newValue","$setValidity","distanceModalDirective","distanceModalLink","storage","distances","onDistanceSelected","closeDistanceModal","emailValidatorDirective","emailValidatorLink","ngModel","$asyncValidators","modelValue","viewValue","validateEmail","facebookLoginDirective","$q","Facebook","Dialog","facebookLoginLink","facebookLogin","loading","logIn","fbAuthData","fbData","me","findByEmail","user","get","signInViaFacebook","updateWithFacebookData","$broadcast","instant","facebookStatus","getCurrentUser","userFacebook","focusMeDirective","$timeout","openKeyboard","focus","click","heartDirective","heartLink","addClass","ionLoading","runLoading","$ionicLoading","showLoading","hideLoading","seconds","factory","PhotogramLoadingDirective","photogramFollowDirective","Photogram","modalFollow","getFollow","photoGridDirective","Gallery","$ionicPopup","Share","FeedbackModal","$ionicActionSheet","photoGridCtrl","isLoadingViewShown","isGalleriesViewShown","isErrorViewShown","isEmptyViewShown","showGalleries","showErrorView","showEmptyView","ensureMoreData","isMoreData","setGalleries","setCurrentPage","page","params","loadFeed","feed","objectId","unshift","onLoadMore","moreDataCanBeLoaded","showLoadingView","onReload","gallery","actionButtons","share","message","confirm","res","destroy","$emit","buttons","buttonDelete","actionSheet","titleText","cancelText","buttonClicked","profile","photoCommentDirective","$http","$ionicScrollDelegate","GalleryComment","GalleryForm","init","nocomments","galleryObj","openModalComment","formComment","submitComment","deleteComment","editComment","getComments","myIndexValue","searchPeople","term","peopleList","getFollowing","response","each","imageUrl","photo","_url","bio","people","when","getPeopleTextRaw","obj","onTap","e","update","comments","galleryId","dataForm","create","photoLikeDirective","_model","progress","liked","likeGallery","likesTotal","photoListDirective","photoListController","openComment","load","openLikers","profileModalEditDirective","logout","linkFacebook","facebookLink","submitUpdateProfile","profileModalDirective","profileModalLink","follow","loadingFollow","userObj","isFollow","followersTotal","modalProfile","changeTab","tab","list","grid","ionSearchDirective","getData","search","watchSearch","minLength","str","results","placeholder","$apply","settingsModalDirective","Auth","getLoggedUser","languages","sref","usernameValidatorDirective","usernameValidatorLink","validateUsername","$provide","PLURAL_CATEGORY","ZERO","ONE","TWO","FEW","MANY","OTHER","DATETIME_FORMATS","AMPMS","DAY","ERANAMES","ERAS","FIRSTDAYOFWEEK","MONTH","SHORTDAY","SHORTMONTH","STANDALONEMONTH","WEEKENDRANGE","fullDate","longDate","medium","mediumDate","mediumTime","short","shortDate","shortTime","NUMBER_FORMATS","CURRENCY_SYM","DECIMAL_SEP","GROUP_SEP","PATTERNS","gSize","lgSize","maxFrac","minFrac","minInt","negPre","negSuf","posPre","posSuf","pluralCat","n","opt_precision","pt_br","defineLocale","months","monthsShort","weekdays","weekdaysShort","weekdaysMin","longDateFormat","LT","LTS","L","LL","LLL","LLLL","calendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","day","sameElse","relativeTime","future","past","mm","h","hh","dd","M","MM","yy","ordinalParse","ordinal","GalleryFormFactory","templateOptions","required","iconPlaceholder","label","toggleClass","formShare","UserFormFactory","valueProp","labelProp","ActionSheetFactory","Camera","$cordovaActionSheet","defer","option","sourceType","getPicture","resolve","reject","promise","buttonLabels","addCancelButtonWithLabel","androidEnableCancelButton","androidTheme","actionsheet","ANDROID_THEMES","THEME_HOLO_LIGHT","btnIndex","cancel","setSessionToken","sessionToken","mSessionToken","ensureLoggedIn","become","recoverPassword","requestPasswordReset","success","resetPassword","CameraFactory","$cordovaCamera","PictureSourceType","CAMERA","PHOTOLIBRARY","quality","targetWidth","targetHeight","saveToPhotoAlbum","correctOrientation","destinationType","DestinationType","DATA_URL","encodingType","EncodingType","JPEG","fileInput","on","evt","tempImage","currentTarget","files","reader","FileReader","onload","result","readAsDataURL","toBase64Image","img_path","imageResizer","resizeImage","imageDataType","ImageResizer","IMAGE_DATA_TYPE_URL","resizeType","RESIZE_TYPE_FACTOR","format","RESIZE_TYPE_MIN_PIXEL","pixelDensity","storeImage","photoAlbum","service","ConnectMonitorFactory","$cordovaNetwork","watch","ionic","Platform","isWebView","onLine","isOnline","networkState","addEventListener","DAOFactory","$interval","database","_db","sqlitePlugin","openDatabase","createFromLocation","_promises","forEach","table","query","_query","_tables","all","getLastSync","column","lastSync","rows","insert","_columns","_values","bindings","transaction","executeSql","paginate","_table","_where","_join","_order","limit","_limit","_query1","total","TOTAL","fetchAll","output","DataUtilFactory","parseData","string","parts","Date","parseString","toLocaleDateString","getDate","inicio","year","getFullYear","month","getMonth","formatDate","milliseconds","getMonthName","meses","getFirstDay","getLastDay","DialogFactory","$cordovaDialogs","buttonsText","FacebookFactory","$facebook","$cordovaFacebook","getLoginStatus","api","fields","invite","showDialog","method","ui","friends","getTime","FacebookUtils","access_token","expiration_date","set","Boolean","save","ParseCloud","ParseObject","Object","getStatus","isApproved","Query","order","ascending","descending","date","startOf","endOf","greaterThanOrEqualTo","toDate","lessThanOrEqualTo","doesNotExist","equalTo","include","skip","find","defineProperty","GeoPoint","latitude","longitude","itemId","GalleryFactory","objPlace","address","geo","expiresAt","GeolocationFactory","getCurrentPosition","$cordovaGeolocation","geolocation","timeout","enableHighAccuracy","maximumAge","GoogleAnalyticsFactory","$cordovaGoogleAnalytics","trackingId","debugMode","startTrackerWithId","canTrack","warn","TAG","trackEvent","category","trackView","viewName","trackException","description","isFatal","InstallFactory","OneSignalFactory","OneSignal","setLogLevel","logLevel","visualLevel","googleProjectNumber","jsonData","JSON","stringify","enableInAppAlertNotification","ParseCloudFactory","Cloud","upload","file","ext","filename","File","PhotogramShareFactory","$window","socialsharing","shareWithOptions","subject","ToastFactory","$cordovaToast","okType","msg","UserFactory","$cordovaDevice","getFollowers","getLikers","device","getDevice","getCordova","model","getModel","getPlatform","uuid","getUUID","version","getVersion","userAgent","roleName","acl","ACL","setPublicReadAccess","setPublicWriteAccess","setACL","authData","expiration","setSeconds","getSeconds","authResponse","expiresIn","toISOString","facebookAuthData","userID","accessToken","fetch","userFetched","getPublicData","first","userData","Promise","setPhoto","parseFile","userId","findUsername","delete","ionLanguageDirective","modalLanguageLink","styleDefault","searchValue","selectLanguage","GeoServiceFactory","getLocation","posOptions","coords","err","findMe","getGoogleAddress","logErr","address_normal","formatted_address","address_components","imagem","numero","short_name","rua","long_name","bairro","cidade","estado","uf","pais","paisCode","cep","w","parseAddress","place","resume","geometry","addressType","types","componentForm","componentFormName","street","number","city","country","searchAddress","deferred","autocompleteService","getQueryPredictions","getDetails","placeId","detailsService","places","AutocompleteService","PlacesService","street_number","route","locality","sublocality","neighborhood","political","administrative_area_level_1","postal_code","ionLocationDirective","GeoService","ionLocationLink","suggestions","selectPlace","place_id","closeModalLocation","choosePlace","modalLocation","fromTemplate","loading1","FeedbackModalFactory","GalleryFeedback","GalleryFeedbackForm","submitFeedback","$new","photogramId","GalleryFeedbackFormFactory","feedbackDirective","PhotogramFeedback","PhotogramFeedbackForm","photogram","submit","GalleryCommentController","$stateParams","$ionicHistory","comment","canEdit","scrollBottom","goBack","formEdit","LoadingController","$cordovaSplashscreen","intro","localStorage","splashscreen","ProfileController","vm","galleries","empty","more","isMe","openFollowers","openFollowing","MainTabController","PhotoService","ActionSheet","PhotoFilter","ParseFile","postPhoto","modalPost","editFilter","modalFilter","closeAddress","close","base64","imageUploaded","AccountController","getFollower","loadingFollowers","loadingFollowing","loadingPhotos","ActivityController","GalleryActivity","openProfile","HomeController","SearchCtrl","onSearch","SearchMapController","Geolocation","removeGallerys","mapOptions","setPosition","mapTypeId","MapTypeId","ROADMAP","Map","myPosition","loadGallerys","errorMessage","markerOption","Animation","DROP","Size","scaledSize","origin","Point","anchor","Marker","imagePath","latlngbounds","setGallerys","imageThumb","maxRating","scopes","states","onSearchHere","onGalleryClicked","UserAvatarController","submitAvatar","userAvatarDirective","UserFollowerController","users","clearSearch","UserFollowingController","UserIntroController","UserLikerController","UserListController","UserMergeController","tempUser","recoveryPassDirective","recovery","erro","button","$viewValue","isUndefined","forgot","UserRecoveryPassController","submitForgot","WalkthroughController","$ionicSlideBoxDelegate","currentPlatform","slideIndex","slideChanged","next","previous","slides","camanDirective","CamanJs","camanDirectiveLink","effect","ionCropDirective","$jrCrop","ionCropLink","getElem","fileUpload","crop","chooseText","canvas","toDataURL","cropSave","photoShareDirective","PhotogramSetting","photoShareLink","allowEdit","allowRotation","goHome","closeModalPost","submitPost","post","closePost","photoFilterCarouselDirective","filters","applyFilter","photoFilterDirective","CamanJsFactory","Caman","revert","render","resetEffect","jrCropController","View","inherit","imgWidth","imgHeight","imgSelect","imgFull","posX","posY","scale","rotate","last_scale","last_posX","last_posY","last_rotate","self","loadImage","naturalWidth","naturalHeight","el","querySelector","cloneNode","bindHandlers","initImage","imgAspectRatio","selectAspectRatio","centerX","centerY","setImageTransform","setPosWithinBoundaries","calcMaxPos","min_pos_x","max_pos_x","min_pos_y","max_pos_y","currWidth","currHeight","scaleMin","transforming_correctX","transforming_correctY","scaleMax","image_ratio","cropper_ratio","prevent_default_directions","onGesture","gesture","deltaX","deltaY","transform","CSS","TRANSFORM","context","correctX","correctY","sourceX","sourceY","translate","drawImage","prop","defaultOptions","aspectRatio","initOptions","_options","PhotoFilterFactory","submitCapture","dataUrl","PhotoServiceFactory","$cordovaCapture","capture","filterModal","buttonCancel","popoverOptions","CameraPopoverOptions","cropModal","setting","shareModal","shareSocial","social","socials","sociais","openFilter","closeFilter","submitFilter","templateFilter","cropImage","getVideo","captureVideo","duration","mediaFiles","fullPath","jrCrop","VideoFactory","createFileEntry","fileURI","resolveLocalFileSystemURL","entry","copyFile","fail","fileEntry","substr","lastIndexOf","newName","makeid","dataDirectory","fileSystem2","copyTo","succ","onCopySuccess","nativeURL","PKVideoThumbnail","createThumbnail","prevSucc","prevImageSuccess","correctUrl","possible","charAt","floor","random","saveVideo","localURL","$templateCache","put"],"mappings":"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","file":"scripts/app-c079642da5.js","sourcesContent":["(function () {\n    'use strict';\n    angular\n        .module('starter', [\n            'ionic',\n            'formlyIonic',\n            'ngMessages',\n            'ngCookies',\n            'ngStorage',\n            'pascalprecht.translate', // angular-translate\n            'tmh.dynamicLocale', // angular-dynamic-locale\n            'angularMoment',\n            'ngFacebook',\n            'angular-cache',\n            'ngSanitize',\n            'mentio',\n            'ion-affix',\n            'jett.ionic.scroll.sista',\n            'ngCordova',\n            'ionic.components',\n            'app.main',\n        ]);\n\n})();\n\n(function () {\n    'use strict';\n    angular\n        .module('ionic.components', [\n            'ion-language',\n            'ion-location',\n            // 'ion-affix',\n            // 'ngCache',\n            'ion-photo'\n        ]);\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('href', openTermsDirective);\n\n    function openTermsDirective() {\n        return {\n            restrict: 'A',\n            link    : function (scope, elem, attr) {\n\n                elem.bind('click', openModal);\n\n                function openModal() {\n                    var href = attr.href;\n\n                    if (window.cordova) {\n                        // Keep in mind that you must add your own images to native resource.\n                        // Images below are for sample only. They are not imported by this plugin.\n                        window.cordova.ThemeableBrowser.open(href, '_blank', {\n                            statusbar         : {\n                                color: '#ffffffff'\n                            },\n                            toolbar           : {\n                                height: 44,\n                                color : '#f0f0f0ff'\n                            },\n                            title             : {\n                                color        : '#000',\n                                showPageTitle: true\n                            },\n                            backButtonCanClose: true\n                        })\n                        ;\n                    } else {\n                        window.open(href);\n                    }\n\n                    return false;\n                }\n            }\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('app.main', [\n            'ionic',\n            'ngCordova',\n        ]);\n\n})();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('ion-language', [\n            'ngCookies',\n            'pascalprecht.translate', // angular-translate\n            'tmh.dynamicLocale' // angular-dynamic-locale\n        ])\n        .config(configLanguage);\n\n    function configLanguage($translatePartialLoaderProvider, $translateProvider, AppConfig, tmhDynamicLocaleProvider) {\n\n        // angular-translate configuration\n        $translateProvider.useLoader('$translatePartialLoader', {\n            urlTemplate: '{part}/i18n/{lang}.json'\n        });\n        $translateProvider.useSanitizeValueStrategy(null);\n\n        // Translate Config\n        //$translateProvider.useMissingTranslationHandlerLog();\n        $translateProvider.useLocalStorage(); // saves selected language to localStorage\n        tmhDynamicLocaleProvider.localeLocationPattern('../bower_components/angular-i18n/angular-locale_{{locale}}.js');\n\n        var langvar     = navigator.language || navigator.userlanguage;\n        var userlangvar = langvar.split('-')[0];\n        var language    = AppConfig.preferredLocale;\n        var searchLang  = _.some(AppConfig.locales, {\n            code: userlangvar\n        });\n\n        if (searchLang) {\n            language = AppConfig.locales.filter(function (item) {\n                return language == item.code\n            })[0].code;\n        }\n        $translateProvider.preferredLanguage(language);\n        moment.locale(language);\n    }\n\n\n})();\n\n(function () {\n  'use strict';\n  angular\n    .module('ion-location', [\n      'ionic'\n    ]);\n\n})();\n(function () {\n    'use strict';\n    angular\n        .module('ion-photo', [\n            'ionic',\n            'ngCordova',\n            'jrCrop'\n        ])\n        .constant('config', {\n            path: 'app/component/ion-photo'\n        })\n\n})();\n(function () {\n    'use strict';\n    angular\n        .module('app.main');\n\n})();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('starter')\n        .run(startParse)\n        .run(runIonic)\n        .run(runFacebook)\n        .config(configCompile)\n        .config(configFacebook)\n        .config(configIonic);\n\n    function configCompile($compileProvider) {\n        $compileProvider.debugInfoEnabled(false);\n    }\n\n    function startParse(AppConfig, $localStorage, $location, $rootScope) {\n        Parse.initialize(AppConfig.parse.appId);\n        Parse.serverURL        = AppConfig.parse.server;\n        $rootScope.currentUser = Parse.User.current();\n\n        if (!$localStorage.unit) {\n            $localStorage.unit = AppConfig.map.unit;\n        }\n\n        if (!$localStorage.mapType) {\n            $localStorage.mapType = AppConfig.map.type;\n        }\n\n        console.log($rootScope.currentUser);\n        if (!$rootScope.currentUser) {\n            $location.path('/');\n        }\n    }\n\n    function runIonic($ionicPlatform, $localStorage, $translate, $cordovaGlobalization, ConnectMonitor, AppConfig, User) {\n\n        $ionicPlatform.ready(function () {\n\n            if (window.cordova && window.cordova.plugins.Keyboard) {\n                cordova.plugins.Keyboard.disableScroll(true);\n                window.StatusBar.styleLightContent();\n            }\n\n            // Remove back button android\n            $ionicPlatform.registerBackButtonAction(function (event) {\n                event.preventDefault();\n            }, 100);\n\n            if ($localStorage.lang) {\n                $translate.use($localStorage.lang);\n            } else {\n                if (typeof navigator.globalization !== 'undefined') {\n                    $cordovaGlobalization.getPreferredLanguage().then(function (language) {\n                        $translate.use((language.value).split('-')[0]);\n                    }, null);\n                }\n            }\n\n            //OneSignal.init(AppConfig.onesignal.id, AppConfig.onesignal.google);\n\n            // Enable to debug issues.\n            //if (window.plugins.OneSignal) {\n            //    window.plugins.OneSignal.setLogLevel({\n            //        logLevel   : 4,\n            //        visualLevel: 4\n            //    });\n            //\n            //    // Update with your OneSignal AppId and googleProjectNumber before running.\n            //    window.plugins.OneSignal.init(AppConfig.onesignal.id, {googleProjectNumber: AppConfig.onesignal.google}, function (jsonData) {\n            //        //alert(\"Notification received:\\n\" + JSON.stringify(jsonData));\n            //        console.log(jsonData);\n            //\n            //    });\n            //\n            //    window.plugins.OneSignal.enableInAppAlertNotification(true);\n            //\n            //}\n            //ConnectMonitor.watch();\n        });\n\n\n    }\n\n    function configIonic($ionicConfigProvider) {\n        $ionicConfigProvider.platform.ios.backButton.previousTitleText(' ').icon('ion-ios-arrow-left');\n        $ionicConfigProvider.platform.android.backButton.previousTitleText(' ').icon('ion-ios-arrow-left');\n        $ionicConfigProvider.views.swipeBackEnabled (false);\n        $ionicConfigProvider.backButton.text(' ').icon('ion-ios-arrow-left');\n        //$ionicConfigProvider.backButton.previousTitleText (false).text ('Voltar').icon ('ion-ios-arrow-left');\n        //$ionicConfigProvider.views.transition ('platform');\n        $ionicConfigProvider.tabs.position('bottom');\n        $ionicConfigProvider.navBar.alignTitle('center');\n        $ionicConfigProvider.views.maxCache(1);\n    }\n\n    // Facebook\n    function configFacebook($facebookProvider, AppConfig) {\n        //if (!window.cordova) {\n            $facebookProvider.setAppId(AppConfig.facebookAppId);\n            $facebookProvider.setPermissions('id,name,email,user_likes,bio');\n        //}\n    }\n\n    function runFacebook(AppConfig) {\n\n        //if (!window.cordova) {\n            console.log('Facebook Browser');\n            var LangVar     = window.navigator.language || window.navigator.userLanguage;\n            var userLangVar = LangVar.substring(0, 2) + '_' + LangVar.substring(3, 5).toUpperCase();\n\n            (function (d, s, id) {\n                var js, fjs = d.getElementsByTagName(s)[0];\n                if (d.getElementById(id)) {return;}\n                js     = d.createElement(s);\n                js.id  = id;\n                js.src = 'http://connect.facebook.net/' + userLangVar + '/sdk.js';\n                fjs.parentNode.insertBefore(js, fjs);\n            }(document, 'script', 'facebook-jssdk'));\n        //}\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('ionic').constant('AppConfig', AppConfig());\n\n    function AppConfig() {\n        return {\n            path           : 'app/module/photogram',\n            app            : {\n                name : 'Photogram',\n                url  : 'http://photogramapp.com',\n                image: 'http://photogramapp.com/social-share.jpg',\n            },\n            routes         : {\n                home : 'tab.home',\n                login: 'user.intro'\n            },\n            statusBarColor : '#00796B',\n            gaTrackingId   : 'UA-69485876-2',\n            facebookAppId  : '1024016557617380',\n            parse          : {\n                appId : 'myAppId',\n                //server: 'https://photogramapp.com/parse/',\n                server: 'http://localhost:1337/parse/',\n            },\n            onesignal      : {\n                id    : '7b08c66d-d5a3-47b9-b091-b7f4a5bb7624',\n                google: 'AIzaSyCEBeAMSs4nrAC-2cvG6N6Q_KqJpnUrnh0'\n            },\n            map            : {\n                unit: 'mi',\n                type: 'normal',\n            },\n            locales        : [\n                {\n                    translation: 'portugues',\n                    code       : 'pt'\n                },\n                {\n                    translation: 'english',\n                    code       : 'en'\n                },\n                {\n                    translation: 'turkish',\n                    code       : 'tr'\n                },\n                {\n                    translation: 'persian',\n                    code       : 'fa'\n                },\n                {\n                    translation: 'german',\n                    code       : 'de'\n                }\n            ],\n            preferredLocale: 'en',\n            DAO            : {\n                name  : 'photogram_db',\n                tables: [\n                    {\n                        name   : 'User',\n                        columns: {\n                            id         : 'TEXT PRIMARY KEY',\n                            name       : 'TEXT',\n                            username   : 'TEXT',\n                            email      : 'TEXT',\n                            language   : 'TEXT',\n                            facebookimg: 'TEXT',\n                            gender     : 'TEXT',\n                            img        : 'TEXT',\n                            facebook   : 'INTEGER',\n                            qtdFollow  : 'INTEGER',\n                            status     : 'TEXT',\n                            createdAt  : 'INTEGER',\n                            attributes : 'TEXT'\n                        }\n                    },\n                    {\n                        name   : 'UserFollow',\n                        columns: {\n                            id      : 'TEXT PRIMARY KEY',\n                            user_id : 'TEXT',\n                            followId: 'TEXT'\n                        },\n                    },\n                    {\n                        name   : 'Gallery',\n                        columns: {\n                            id       : 'TEXT PRIMARY KEY',\n                            img      : 'TEXT',\n                            title    : 'TEXT',\n                            user_id  : 'TEXT',\n                            location : 'TEXT',\n                            isLiked  : 'BOOLEAN',\n                            likes    : 'INTEGER',\n                            createdAt: 'INTEGER'\n                        }\n                    },\n                    {\n                        name   : 'GalleryActivity',\n                        columns: {\n                            id        : 'TEXT PRIMARY KEY',\n                            action    : 'TEXT',\n                            img       : 'TEXT',\n                            userAvatar: 'TEXT',\n                            userName  : 'TEXT',\n                            user_id   : 'TEXT',\n                            gallery_id: 'TEXT',\n                            createdAt : 'INTEGER'\n                        }\n                    },\n                    {\n                        name   : 'GalleryComment',\n                        columns: {\n                            id        : 'TEXT PRIMARY KEY',\n                            name      : 'TEXT',\n                            user_id   : 'TEXT',\n                            userName  : 'TEXT',\n                            gallery_id: 'TEXT',\n                            createdAt : 'INTEGER'\n                        }\n                    },\n                    {\n                        name   : 'GallerySetting',\n                        columns: {\n                            key  : 'TEXT',\n                            value: 'TEXT'\n                        }\n                    }\n                ]\n            }\n        };\n    }\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').config(routes);\n\n    function routes($stateProvider, $urlRouterProvider, $translatePartialLoaderProvider) {\n\n        // Translation\n        $translatePartialLoaderProvider.addPart('app/');\n\n        $stateProvider\n\n            .state('loading', {\n                url         : '/',\n                templateUrl : 'app/main/loading/loading.html',\n                controller  : 'LoadingCtrl',\n                controllerAs: 'vm'\n            })\n\n            .state('walkthrough', {\n                url         : '/walkthrough',\n                templateUrl : 'app/main/walkthrough/walkthrough.html',\n                controller  : 'WalkthroughCtrl',\n                controllerAs: 'vm'\n            })\n\n            .state('user', {\n                url        : '/user',\n                abstract   : true,\n                templateUrl: 'app/main/user-layout/user-layout.html'\n            })\n\n            .state('user.avatar', {\n                url         : '/avatar',\n                templateUrl : 'app/main/user-avatar/user-avatar.html',\n                controller  : 'UserAvatarCtrl',\n                controllerAs: 'vm'\n            })\n\n            .state('user.intro', {\n                url        : '/intro',\n                templateUrl: 'app/main/user-intro/user-intro.html',\n                controller : 'UserIntroCtrl'\n            })\n\n            .state('user.merge', {\n                url         : '/merge',\n                controller  : 'UserMergeCtrl',\n                controllerAs: 'vm',\n                templateUrl : 'app/main/user-merge/merge.html'\n            })\n\n            .state('logout', {\n                url         : '/logout',\n                template    : '<ion-view view-title=\"Logout\" cache-view=\"false\"><ion-content></ion-content></ion-view>',\n                controller  : function (User, $state) {\n                    User.logOut();\n                    $state.go('user.login', {clear: true});\n                },\n                controllerAs: 'vm'\n            })\n\n\n            .state('profile', {\n                url         : '/profile/:username',\n                templateUrl : 'app/main/profile/profile.html',\n                controllerAs: 'vm',\n            })\n\n\n            .state('tab', {\n                url         : '/tab',\n                abstract    : true,\n                controller  : 'MainTabCtrl',\n                controllerAs: 'vm',\n                templateUrl : 'app/main/tab/main-tab.html'\n            })\n\n            .state('tab.home', {\n                url  : '/home',\n                views: {\n                    tabHome: {\n                        controller  : 'HomeCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/tab-home/home.html'\n                    }\n                }\n            })\n\n            .state('tab.homeProfile', {\n                url  : '/home/:username',\n                views: {\n                    tabHome: {\n                        controller  : 'ProfileCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/profile/profile.html'\n                    }\n                }\n            })\n\n            .state('galleryComments', {\n                url         : '/home/:galleryId/comments',\n                controller  : 'GalleryComment',\n                controllerAs: 'vm',\n                templateUrl : 'app/main/gallery-comment/gallery-comment.html'\n            })\n\n            .state('tab.homeGalleryLikers', {\n                url  : '/home/:galleryId/likers',\n                views: {\n                    tabHome: {\n                        controller  : 'UserLikersCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-likers/user-likers.html'\n                    }\n                }\n            })\n\n            .state('tab.homeProfileFollowers', {\n                url  : '/home/:username/followers',\n                views: {\n                    tabHome: {\n                        controller  : 'UserFollowerCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-followers/user-followers.html'\n                    }\n                }\n            })\n\n            .state('tab.homeProfileFollowing', {\n                url  : '/home/:username/follwing',\n                views: {\n                    tabHome: {\n                        controller  : 'UserFollowingCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-following/user-following.html'\n                    }\n                }\n            })\n\n            .state('tab.homeUserlist', {\n                url  : '/home/userlist',\n                views: {\n                    tabHome: {\n                        controller  : 'UserListCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-list/user-list.html'\n                    }\n                }\n            })\n\n            .state('tab.search', {\n                url  : '/search/:text',\n                views: {\n                    tabSearch: {\n                        controller  : 'SearchCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/tab-search/search.html',\n                    }\n                }\n            })\n\n            .state('tab.map', {\n                url  : '/map',\n                views: {\n                    tabSearch: {\n                        controller  : 'SearchMapCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/tab-search-map/searchMap.html',\n                    }\n                }\n            })\n\n            .state('tab.mapProfile', {\n                url  : '/map/:username',\n                views: {\n                    tabSearch: {\n                        controller  : 'ProfileCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/profile/profile.html'\n                    }\n                }\n            })\n\n            .state('tab.mapProfileFollowers', {\n                url  : '/map/:username/followers',\n                views: {\n                    tabSearch: {\n                        controller  : 'UserFollowerCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-followers/user-followers.html'\n                    }\n                }\n            })\n\n            .state('tab.mapProfileFollowing', {\n                url  : '/map/:username/follwing',\n                views: {\n                    tabActivity: {\n                        controller  : 'UserFollowingCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-following/user-following.html'\n                    }\n                }\n            })\n\n            .state('tab.account', {\n                url  : '/account',\n                views: {\n                    tabProfile: {\n                        controller  : 'AccountCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/tab-account/account.html'\n                    }\n                }\n            })\n\n            .state('tab.accountFollowers', {\n                url  : '/account/:username/followers',\n                views: {\n                    tabProfile: {\n                        controller  : 'UserFollowerCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-followers/user-followers.html'\n                    }\n                }\n            })\n\n            .state('tab.accountFollowing', {\n                url  : '/account/:username/follwing',\n                views: {\n                    tabProfile: {\n                        controller  : 'UserFollowingCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-following/user-following.html'\n                    }\n                }\n            })\n\n            .state('tab.activity', {\n                url  : '/activity',\n                views: {\n                    tabActivity: {\n                        controller  : 'ActivityCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/tab-activity/activity.html'\n                    }\n                }\n            })\n\n            .state('tab.activityProfile', {\n                url  : '/activity/:username',\n                views: {\n                    tabActivity: {\n                        controller  : 'ProfileCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/profile/profile.html'\n                    }\n                }\n            })\n\n            .state('tab.activityProfileFollowers', {\n                url  : '/activity/:username/followers',\n                views: {\n                    tabActivity: {\n                        controller  : 'UserFollowerCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-followers/user-followers.html'\n                    }\n                }\n            })\n\n            .state('tab.activityProfileFollowing', {\n                url  : '/activity/:username/follwing',\n                views: {\n                    tabActivity: {\n                        controller  : 'UserFollowingCtrl',\n                        controllerAs: 'vm',\n                        templateUrl : 'app/main/user-following/user-following.html'\n                    }\n                }\n            })\n\n        ;\n\n        // Translation\n        //$translatePartialLoaderProvider.addPart('app/main');\n        $urlRouterProvider.otherwise('/');\n\n    }\n\n\n})();\n// ==ClosureCompiler==\n// @compilation_level ADVANCED_OPTIMIZATIONS\n// @externs_url https://raw.githubusercontent.com/google/closure-compiler/master/contrib/externs/maps/google_maps_api_v3.js\n// ==/ClosureCompiler==\n\n/**\n * @name MarkerClusterer for Google Maps v3\n * @version version 1.0\n * @author Luke Mahe\n * @fileoverview\n * The library creates and manages per-zoom-level clusters for large amounts of\n * markers.\n * <br/>\n * This is a v3 implementation of the\n * <a href=\"http://gmaps-utility-library-dev.googlecode.com/svn/tags/markerclusterer/\"\n * >v2 MarkerClusterer</a>.\n */\n\n/**\n * @license\n * Copyright 2010 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * A Marker Clusterer that clusters markers.\n *\n * @param {google.maps.Map} map The Google map to attach to.\n * @param {Array.<google.maps.Marker>=} opt_markers Optional markers to add to\n *   the cluster.\n * @param {Object=} opt_options support the following options:\n *     'gridSize': (number) The grid size of a cluster in pixels.\n *     'maxZoom': (number) The maximum zoom level that a marker can be part of a\n *                cluster.\n *     'zoomOnClick': (boolean) Whether the default behaviour of clicking on a\n *                    cluster is to zoom into it.\n *     'averageCenter': (boolean) Whether the center of each cluster should be\n *                      the average of all markers in the cluster.\n *     'minimumClusterSize': (number) The minimum number of markers to be in a\n *                           cluster before the markers are hidden and a count\n *                           is shown.\n *     'styles': (object) An object that has style properties:\n *       'url': (string) The image url.\n *       'height': (number) The image height.\n *       'width': (number) The image width.\n *       'anchor': (Array) The anchor position of the label text.\n *       'textColor': (string) The text color.\n *       'textSize': (number) The text size.\n *       'backgroundPosition': (string) The position of the backgound x, y.\n *       'iconAnchor': (Array) The anchor position of the icon x, y.\n * @constructor\n * @extends google.maps.OverlayView\n */\nfunction MarkerClusterer(map, opt_markers, opt_options) {\n    // MarkerClusterer implements google.maps.OverlayView interface. We use the\n    // extend function to extend MarkerClusterer with google.maps.OverlayView\n    // because it might not always be available when the code is defined so we\n    // look for it at the last possible moment. If it doesn't exist now then\n    // there is no point going ahead :)\n    this.extend(MarkerClusterer, google.maps.OverlayView);\n    this.map_ = map;\n\n    /**\n     * @type {Array.<google.maps.Marker>}\n     * @private\n     */\n    this.markers_ = [];\n\n    /**\n     *  @type {Array.<Cluster>}\n     */\n    this.clusters_ = [];\n\n    this.sizes = [53, 56, 66, 78, 90];\n\n    /**\n     * @private\n     */\n    this.styles_ = [];\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.ready_ = false;\n\n    var options = opt_options || {};\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.gridSize_ = options['gridSize'] || 60;\n\n    /**\n     * @private\n     */\n    this.minClusterSize_ = options['minimumClusterSize'] || 2;\n\n\n    /**\n     * @type {?number}\n     * @private\n     */\n    this.maxZoom_ = options['maxZoom'] || null;\n\n    this.styles_ = options['styles'] || [];\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.imagePath_ = options['imagePath'] ||\n        this.MARKER_CLUSTER_IMAGE_PATH_;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.imageExtension_ = options['imageExtension'] ||\n        this.MARKER_CLUSTER_IMAGE_EXTENSION_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.zoomOnClick_ = true;\n\n    if (options['zoomOnClick'] != undefined) {\n        this.zoomOnClick_ = options['zoomOnClick'];\n    }\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.averageCenter_ = false;\n\n    if (options['averageCenter'] != undefined) {\n        this.averageCenter_ = options['averageCenter'];\n    }\n\n    this.setupStyles_();\n\n    this.setMap(map);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.prevZoom_ = this.map_.getZoom();\n\n    // Add the map event listeners\n    var that = this;\n    google.maps.event.addListener(this.map_, 'zoom_changed', function() {\n        var zoom = that.map_.getZoom();\n\n        if (that.prevZoom_ != zoom) {\n            that.prevZoom_ = zoom;\n            that.resetViewport();\n        }\n    });\n\n    google.maps.event.addListener(this.map_, 'idle', function() {\n        that.redraw();\n    });\n\n    // Finally, add the markers\n    if (opt_markers && opt_markers.length) {\n        this.addMarkers(opt_markers, false);\n    }\n}\n\n\n/**\n * The marker cluster image path.\n *\n * @type {string}\n * @private\n */\nMarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_ = '../images/m';\n\n\n/**\n * The marker cluster image path.\n *\n * @type {string}\n * @private\n */\nMarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_ = 'png';\n\n\n/**\n * Extends a objects prototype by anothers.\n *\n * @param {Object} obj1 The object to be extended.\n * @param {Object} obj2 The object to extend with.\n * @return {Object} The new extended object.\n * @ignore\n */\nMarkerClusterer.prototype.extend = function(obj1, obj2) {\n    return (function(object) {\n        for (var property in object.prototype) {\n            this.prototype[property] = object.prototype[property];\n        }\n        return this;\n    }).apply(obj1, [obj2]);\n};\n\n\n/**\n * Implementaion of the interface method.\n * @ignore\n */\nMarkerClusterer.prototype.onAdd = function() {\n    this.setReady_(true);\n};\n\n/**\n * Implementaion of the interface method.\n * @ignore\n */\nMarkerClusterer.prototype.draw = function() {};\n\n/**\n * Sets up the styles object.\n *\n * @private\n */\nMarkerClusterer.prototype.setupStyles_ = function() {\n    if (this.styles_.length) {\n        return;\n    }\n\n    for (var i = 0, size; size = this.sizes[i]; i++) {\n        this.styles_.push({\n            url: this.imagePath_ + (i + 1) + '.' + this.imageExtension_,\n            height: size,\n            width: size\n        });\n    }\n};\n\n/**\n *  Fit the map to the bounds of the markers in the clusterer.\n */\nMarkerClusterer.prototype.fitMapToMarkers = function() {\n    var markers = this.getMarkers();\n    var bounds = new google.maps.LatLngBounds();\n    for (var i = 0, marker; marker = markers[i]; i++) {\n        bounds.extend(marker.getPosition());\n    }\n\n    this.map_.fitBounds(bounds);\n};\n\n\n/**\n *  Sets the styles.\n *\n *  @param {Object} styles The style to set.\n */\nMarkerClusterer.prototype.setStyles = function(styles) {\n    this.styles_ = styles;\n};\n\n\n/**\n *  Gets the styles.\n *\n *  @return {Object} The styles object.\n */\nMarkerClusterer.prototype.getStyles = function() {\n    return this.styles_;\n};\n\n\n/**\n * Whether zoom on click is set.\n *\n * @return {boolean} True if zoomOnClick_ is set.\n */\nMarkerClusterer.prototype.isZoomOnClick = function() {\n    return this.zoomOnClick_;\n};\n\n/**\n * Whether average center is set.\n *\n * @return {boolean} True if averageCenter_ is set.\n */\nMarkerClusterer.prototype.isAverageCenter = function() {\n    return this.averageCenter_;\n};\n\n\n/**\n *  Returns the array of markers in the clusterer.\n *\n *  @return {Array.<google.maps.Marker>} The markers.\n */\nMarkerClusterer.prototype.getMarkers = function() {\n    return this.markers_;\n};\n\n\n/**\n *  Returns the number of markers in the clusterer\n *\n *  @return {Number} The number of markers.\n */\nMarkerClusterer.prototype.getTotalMarkers = function() {\n    return this.markers_.length;\n};\n\n\n/**\n *  Sets the max zoom for the clusterer.\n *\n *  @param {number} maxZoom The max zoom level.\n */\nMarkerClusterer.prototype.setMaxZoom = function(maxZoom) {\n    this.maxZoom_ = maxZoom;\n};\n\n\n/**\n *  Gets the max zoom for the clusterer.\n *\n *  @return {number} The max zoom level.\n */\nMarkerClusterer.prototype.getMaxZoom = function() {\n    return this.maxZoom_;\n};\n\n\n/**\n *  The function for calculating the cluster icon image.\n *\n *  @param {Array.<google.maps.Marker>} markers The markers in the clusterer.\n *  @param {number} numStyles The number of styles available.\n *  @return {Object} A object properties: 'text' (string) and 'index' (number).\n *  @private\n */\nMarkerClusterer.prototype.calculator_ = function(markers, numStyles) {\n    var index = 0;\n    var count = markers.length;\n    var dv = count;\n    while (dv !== 0) {\n        dv = parseInt(dv / 10, 10);\n        index++;\n    }\n\n    index = Math.min(index, numStyles);\n    return {\n        text: count,\n        index: index\n    };\n};\n\n\n/**\n * Set the calculator function.\n *\n * @param {function(Array, number)} calculator The function to set as the\n *     calculator. The function should return a object properties:\n *     'text' (string) and 'index' (number).\n *\n */\nMarkerClusterer.prototype.setCalculator = function(calculator) {\n    this.calculator_ = calculator;\n};\n\n\n/**\n * Get the calculator function.\n *\n * @return {function(Array, number)} the calculator function.\n */\nMarkerClusterer.prototype.getCalculator = function() {\n    return this.calculator_;\n};\n\n\n/**\n * Add an array of markers to the clusterer.\n *\n * @param {Array.<google.maps.Marker>} markers The markers to add.\n * @param {boolean=} opt_nodraw Whether to redraw the clusters.\n */\nMarkerClusterer.prototype.addMarkers = function(markers, opt_nodraw) {\n    for (var i = 0, marker; marker = markers[i]; i++) {\n        this.pushMarkerTo_(marker);\n    }\n    if (!opt_nodraw) {\n        this.redraw();\n    }\n};\n\n\n/**\n * Pushes a marker to the clusterer.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @private\n */\nMarkerClusterer.prototype.pushMarkerTo_ = function(marker) {\n    marker.isAdded = false;\n    if (marker['draggable']) {\n        // If the marker is draggable add a listener so we update the clusters on\n        // the drag end.\n        var that = this;\n        google.maps.event.addListener(marker, 'dragend', function() {\n            marker.isAdded = false;\n            that.repaint();\n        });\n    }\n    this.markers_.push(marker);\n};\n\n\n/**\n * Adds a marker to the clusterer and redraws if needed.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @param {boolean=} opt_nodraw Whether to redraw the clusters.\n */\nMarkerClusterer.prototype.addMarker = function(marker, opt_nodraw) {\n    this.pushMarkerTo_(marker);\n    if (!opt_nodraw) {\n        this.redraw();\n    }\n};\n\n\n/**\n * Removes a marker and returns true if removed, false if not\n *\n * @param {google.maps.Marker} marker The marker to remove\n * @return {boolean} Whether the marker was removed or not\n * @private\n */\nMarkerClusterer.prototype.removeMarker_ = function(marker) {\n    var index = -1;\n    if (this.markers_.indexOf) {\n        index = this.markers_.indexOf(marker);\n    } else {\n        for (var i = 0, m; m = this.markers_[i]; i++) {\n            if (m == marker) {\n                index = i;\n                break;\n            }\n        }\n    }\n\n    if (index == -1) {\n        // Marker is not in our list of markers.\n        return false;\n    }\n\n    marker.setMap(null);\n\n    this.markers_.splice(index, 1);\n\n    return true;\n};\n\n\n/**\n * Remove a marker from the cluster.\n *\n * @param {google.maps.Marker} marker The marker to remove.\n * @param {boolean=} opt_nodraw Optional boolean to force no redraw.\n * @return {boolean} True if the marker was removed.\n */\nMarkerClusterer.prototype.removeMarker = function(marker, opt_nodraw) {\n    var removed = this.removeMarker_(marker);\n\n    if (!opt_nodraw && removed) {\n        this.resetViewport();\n        this.redraw();\n        return true;\n    } else {\n        return false;\n    }\n};\n\n\n/**\n * Removes an array of markers from the cluster.\n *\n * @param {Array.<google.maps.Marker>} markers The markers to remove.\n * @param {boolean=} opt_nodraw Optional boolean to force no redraw.\n */\nMarkerClusterer.prototype.removeMarkers = function(markers, opt_nodraw) {\n    var removed = false;\n\n    for (var i = 0, marker; marker = markers[i]; i++) {\n        var r = this.removeMarker_(marker);\n        removed = removed || r;\n    }\n\n    if (!opt_nodraw && removed) {\n        this.resetViewport();\n        this.redraw();\n        return true;\n    }\n};\n\n\n/**\n * Sets the clusterer's ready state.\n *\n * @param {boolean} ready The state.\n * @private\n */\nMarkerClusterer.prototype.setReady_ = function(ready) {\n    if (!this.ready_) {\n        this.ready_ = ready;\n        this.createClusters_();\n    }\n};\n\n\n/**\n * Returns the number of clusters in the clusterer.\n *\n * @return {number} The number of clusters.\n */\nMarkerClusterer.prototype.getTotalClusters = function() {\n    return this.clusters_.length;\n};\n\n\n/**\n * Returns the google map that the clusterer is associated with.\n *\n * @return {google.maps.Map} The map.\n */\nMarkerClusterer.prototype.getMap = function() {\n    return this.map_;\n};\n\n\n/**\n * Sets the google map that the clusterer is associated with.\n *\n * @param {google.maps.Map} map The map.\n */\nMarkerClusterer.prototype.setMap = function(map) {\n    this.map_ = map;\n};\n\n\n/**\n * Returns the size of the grid.\n *\n * @return {number} The grid size.\n */\nMarkerClusterer.prototype.getGridSize = function() {\n    return this.gridSize_;\n};\n\n\n/**\n * Sets the size of the grid.\n *\n * @param {number} size The grid size.\n */\nMarkerClusterer.prototype.setGridSize = function(size) {\n    this.gridSize_ = size;\n};\n\n\n/**\n * Returns the min cluster size.\n *\n * @return {number} The grid size.\n */\nMarkerClusterer.prototype.getMinClusterSize = function() {\n    return this.minClusterSize_;\n};\n\n/**\n * Sets the min cluster size.\n *\n * @param {number} size The grid size.\n */\nMarkerClusterer.prototype.setMinClusterSize = function(size) {\n    this.minClusterSize_ = size;\n};\n\n\n/**\n * Extends a bounds object by the grid size.\n *\n * @param {google.maps.LatLngBounds} bounds The bounds to extend.\n * @return {google.maps.LatLngBounds} The extended bounds.\n */\nMarkerClusterer.prototype.getExtendedBounds = function(bounds) {\n    var projection = this.getProjection();\n\n    // Turn the bounds into latlng.\n    var tr = new google.maps.LatLng(bounds.getNorthEast().lat(),\n        bounds.getNorthEast().lng());\n    var bl = new google.maps.LatLng(bounds.getSouthWest().lat(),\n        bounds.getSouthWest().lng());\n\n    // Convert the points to pixels and the extend out by the grid size.\n    var trPix = projection.fromLatLngToDivPixel(tr);\n    trPix.x += this.gridSize_;\n    trPix.y -= this.gridSize_;\n\n    var blPix = projection.fromLatLngToDivPixel(bl);\n    blPix.x -= this.gridSize_;\n    blPix.y += this.gridSize_;\n\n    // Convert the pixel points back to LatLng\n    var ne = projection.fromDivPixelToLatLng(trPix);\n    var sw = projection.fromDivPixelToLatLng(blPix);\n\n    // Extend the bounds to contain the new bounds.\n    bounds.extend(ne);\n    bounds.extend(sw);\n\n    return bounds;\n};\n\n\n/**\n * Determins if a marker is contained in a bounds.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @param {google.maps.LatLngBounds} bounds The bounds to check against.\n * @return {boolean} True if the marker is in the bounds.\n * @private\n */\nMarkerClusterer.prototype.isMarkerInBounds_ = function(marker, bounds) {\n    return bounds.contains(marker.getPosition());\n};\n\n\n/**\n * Clears all clusters and markers from the clusterer.\n */\nMarkerClusterer.prototype.clearMarkers = function() {\n    this.resetViewport(true);\n\n    // Set the markers a empty array.\n    this.markers_ = [];\n};\n\n\n/**\n * Clears all existing clusters and recreates them.\n * @param {boolean} opt_hide To also hide the marker.\n */\nMarkerClusterer.prototype.resetViewport = function(opt_hide) {\n    // Remove all the clusters\n    for (var i = 0, cluster; cluster = this.clusters_[i]; i++) {\n        cluster.remove();\n    }\n\n    // Reset the markers to not be added and to be invisible.\n    for (var i = 0, marker; marker = this.markers_[i]; i++) {\n        marker.isAdded = false;\n        if (opt_hide) {\n            marker.setMap(null);\n        }\n    }\n\n    this.clusters_ = [];\n};\n\n/**\n *\n */\nMarkerClusterer.prototype.repaint = function() {\n    var oldClusters = this.clusters_.slice();\n    this.clusters_.length = 0;\n    this.resetViewport();\n    this.redraw();\n\n    // Remove the old clusters.\n    // Do it in a timeout so the other clusters have been drawn first.\n    window.setTimeout(function() {\n        for (var i = 0, cluster; cluster = oldClusters[i]; i++) {\n            cluster.remove();\n        }\n    }, 0);\n};\n\n\n/**\n * Redraws the clusters.\n */\nMarkerClusterer.prototype.redraw = function() {\n    this.createClusters_();\n};\n\n\n/**\n * Calculates the distance between two latlng locations in km.\n * @see http://www.movable-type.co.uk/scripts/latlong.html\n *\n * @param {google.maps.LatLng} p1 The first lat lng point.\n * @param {google.maps.LatLng} p2 The second lat lng point.\n * @return {number} The distance between the two points in km.\n * @private\n */\nMarkerClusterer.prototype.distanceBetweenPoints_ = function(p1, p2) {\n    if (!p1 || !p2) {\n        return 0;\n    }\n\n    var R = 6371; // Radius of the Earth in km\n    var dLat = (p2.lat() - p1.lat()) * Math.PI / 180;\n    var dLon = (p2.lng() - p1.lng()) * Math.PI / 180;\n    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.cos(p1.lat() * Math.PI / 180) * Math.cos(p2.lat() * Math.PI / 180) *\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    var d = R * c;\n    return d;\n};\n\n\n/**\n * Add a marker to a cluster, or creates a new cluster.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @private\n */\nMarkerClusterer.prototype.addToClosestCluster_ = function(marker) {\n    var distance = 40000; // Some large number\n    var clusterToAddTo = null;\n    var pos = marker.getPosition();\n    for (var i = 0, cluster; cluster = this.clusters_[i]; i++) {\n        var center = cluster.getCenter();\n        if (center) {\n            var d = this.distanceBetweenPoints_(center, marker.getPosition());\n            if (d < distance) {\n                distance = d;\n                clusterToAddTo = cluster;\n            }\n        }\n    }\n\n    if (clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)) {\n        clusterToAddTo.addMarker(marker);\n    } else {\n        var cluster = new Cluster(this);\n        cluster.addMarker(marker);\n        this.clusters_.push(cluster);\n    }\n};\n\n\n/**\n * Creates the clusters.\n *\n * @private\n */\nMarkerClusterer.prototype.createClusters_ = function() {\n    if (!this.ready_) {\n        return;\n    }\n\n    // Get our current map view bounds.\n    // Create a new bounds object so we don't affect the map.\n    var mapBounds = new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),\n        this.map_.getBounds().getNorthEast());\n    var bounds = this.getExtendedBounds(mapBounds);\n\n    for (var i = 0, marker; marker = this.markers_[i]; i++) {\n        if (!marker.isAdded && this.isMarkerInBounds_(marker, bounds)) {\n            this.addToClosestCluster_(marker);\n        }\n    }\n};\n\n\n/**\n * A cluster that contains markers.\n *\n * @param {MarkerClusterer} markerClusterer The markerclusterer that this\n *     cluster is associated with.\n * @constructor\n * @ignore\n */\nfunction Cluster(markerClusterer) {\n    this.markerClusterer_ = markerClusterer;\n    this.map_ = markerClusterer.getMap();\n    this.gridSize_ = markerClusterer.getGridSize();\n    this.minClusterSize_ = markerClusterer.getMinClusterSize();\n    this.averageCenter_ = markerClusterer.isAverageCenter();\n    this.center_ = null;\n    this.markers_ = [];\n    this.bounds_ = null;\n    this.clusterIcon_ = new ClusterIcon(this, markerClusterer.getStyles(),\n        markerClusterer.getGridSize());\n}\n\n/**\n * Determins if a marker is already added to the cluster.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @return {boolean} True if the marker is already added.\n */\nCluster.prototype.isMarkerAlreadyAdded = function(marker) {\n    if (this.markers_.indexOf) {\n        return this.markers_.indexOf(marker) != -1;\n    } else {\n        for (var i = 0, m; m = this.markers_[i]; i++) {\n            if (m == marker) {\n                return true;\n            }\n        }\n    }\n    return false;\n};\n\n\n/**\n * Add a marker the cluster.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @return {boolean} True if the marker was added.\n */\nCluster.prototype.addMarker = function(marker) {\n    if (this.isMarkerAlreadyAdded(marker)) {\n        return false;\n    }\n\n    if (!this.center_) {\n        this.center_ = marker.getPosition();\n        this.calculateBounds_();\n    } else {\n        if (this.averageCenter_) {\n            var l = this.markers_.length + 1;\n            var lat = (this.center_.lat() * (l-1) + marker.getPosition().lat()) / l;\n            var lng = (this.center_.lng() * (l-1) + marker.getPosition().lng()) / l;\n            this.center_ = new google.maps.LatLng(lat, lng);\n            this.calculateBounds_();\n        }\n    }\n\n    marker.isAdded = true;\n    this.markers_.push(marker);\n\n    var len = this.markers_.length;\n    if (len < this.minClusterSize_ && marker.getMap() != this.map_) {\n        // Min cluster size not reached so show the marker.\n        marker.setMap(this.map_);\n    }\n\n    if (len == this.minClusterSize_) {\n        // Hide the markers that were showing.\n        for (var i = 0; i < len; i++) {\n            this.markers_[i].setMap(null);\n        }\n    }\n\n    if (len >= this.minClusterSize_) {\n        marker.setMap(null);\n    }\n\n    this.updateIcon();\n    return true;\n};\n\n\n/**\n * Returns the marker clusterer that the cluster is associated with.\n *\n * @return {MarkerClusterer} The associated marker clusterer.\n */\nCluster.prototype.getMarkerClusterer = function() {\n    return this.markerClusterer_;\n};\n\n\n/**\n * Returns the bounds of the cluster.\n *\n * @return {google.maps.LatLngBounds} the cluster bounds.\n */\nCluster.prototype.getBounds = function() {\n    var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n    var markers = this.getMarkers();\n    for (var i = 0, marker; marker = markers[i]; i++) {\n        bounds.extend(marker.getPosition());\n    }\n    return bounds;\n};\n\n\n/**\n * Removes the cluster\n */\nCluster.prototype.remove = function() {\n    this.clusterIcon_.remove();\n    this.markers_.length = 0;\n    delete this.markers_;\n};\n\n\n/**\n * Returns the center of the cluster.\n *\n * @return {number} The cluster center.\n */\nCluster.prototype.getSize = function() {\n    return this.markers_.length;\n};\n\n\n/**\n * Returns the center of the cluster.\n *\n * @return {Array.<google.maps.Marker>} The cluster center.\n */\nCluster.prototype.getMarkers = function() {\n    return this.markers_;\n};\n\n\n/**\n * Returns the center of the cluster.\n *\n * @return {google.maps.LatLng} The cluster center.\n */\nCluster.prototype.getCenter = function() {\n    return this.center_;\n};\n\n\n/**\n * Calculated the extended bounds of the cluster with the grid.\n *\n * @private\n */\nCluster.prototype.calculateBounds_ = function() {\n    var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n    this.bounds_ = this.markerClusterer_.getExtendedBounds(bounds);\n};\n\n\n/**\n * Determines if a marker lies in the clusters bounds.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @return {boolean} True if the marker lies in the bounds.\n */\nCluster.prototype.isMarkerInClusterBounds = function(marker) {\n    return this.bounds_.contains(marker.getPosition());\n};\n\n\n/**\n * Returns the map that the cluster is associated with.\n *\n * @return {google.maps.Map} The map.\n */\nCluster.prototype.getMap = function() {\n    return this.map_;\n};\n\n\n/**\n * Updates the cluster icon\n */\nCluster.prototype.updateIcon = function() {\n    var zoom = this.map_.getZoom();\n    var mz = this.markerClusterer_.getMaxZoom();\n\n    if (mz && zoom > mz) {\n        // The zoom is greater than our max zoom so show all the markers in cluster.\n        for (var i = 0, marker; marker = this.markers_[i]; i++) {\n            marker.setMap(this.map_);\n        }\n        return;\n    }\n\n    if (this.markers_.length < this.minClusterSize_) {\n        // Min cluster size not yet reached.\n        this.clusterIcon_.hide();\n        return;\n    }\n\n    var numStyles = this.markerClusterer_.getStyles().length;\n    var sums = this.markerClusterer_.getCalculator()(this.markers_, numStyles);\n    this.clusterIcon_.setCenter(this.center_);\n    this.clusterIcon_.setSums(sums);\n    this.clusterIcon_.show();\n};\n\n\n/**\n * A cluster icon\n *\n * @param {Cluster} cluster The cluster to be associated with.\n * @param {Object} styles An object that has style properties:\n *     'url': (string) The image url.\n *     'height': (number) The image height.\n *     'width': (number) The image width.\n *     'anchor': (Array) The anchor position of the label text.\n *     'textColor': (string) The text color.\n *     'textSize': (number) The text size.\n *     'backgroundPosition: (string) The background postition x, y.\n * @param {number=} opt_padding Optional padding to apply to the cluster icon.\n * @constructor\n * @extends google.maps.OverlayView\n * @ignore\n */\nfunction ClusterIcon(cluster, styles, opt_padding) {\n    cluster.getMarkerClusterer().extend(ClusterIcon, google.maps.OverlayView);\n\n    this.styles_ = styles;\n    this.padding_ = opt_padding || 0;\n    this.cluster_ = cluster;\n    this.center_ = null;\n    this.map_ = cluster.getMap();\n    this.div_ = null;\n    this.sums_ = null;\n    this.visible_ = false;\n\n    this.setMap(this.map_);\n}\n\n\n/**\n * Triggers the clusterclick event and zoom's if the option is set.\n *\n * @param {google.maps.MouseEvent} event The event to propagate\n */\nClusterIcon.prototype.triggerClusterClick = function(event) {\n    var markerClusterer = this.cluster_.getMarkerClusterer();\n\n    // Trigger the clusterclick event.\n    google.maps.event.trigger(markerClusterer, 'clusterclick', this.cluster_, event);\n\n    if (markerClusterer.isZoomOnClick()) {\n        // Zoom into the cluster.\n        this.map_.fitBounds(this.cluster_.getBounds());\n    }\n};\n\n\n/**\n * Adding the cluster icon to the dom.\n * @ignore\n */\nClusterIcon.prototype.onAdd = function() {\n    this.div_ = document.createElement('DIV');\n    if (this.visible_) {\n        var pos = this.getPosFromLatLng_(this.center_);\n        this.div_.style.cssText = this.createCss(pos);\n        this.div_.innerHTML = this.sums_.text;\n    }\n\n    var panes = this.getPanes();\n    panes.overlayMouseTarget.appendChild(this.div_);\n\n    var that = this;\n    var isDragging = false;\n    google.maps.event.addDomListener(this.div_, 'click', function(event) {\n        // Only perform click when not preceded by a drag\n        if (!isDragging) {\n            that.triggerClusterClick(event);\n        }\n    });\n    google.maps.event.addDomListener(this.div_, 'mousedown', function() {\n        isDragging = false;\n    });\n    google.maps.event.addDomListener(this.div_, 'mousemove', function() {\n        isDragging = true;\n    });\n};\n\n\n/**\n * Returns the position to place the div dending on the latlng.\n *\n * @param {google.maps.LatLng} latlng The position in latlng.\n * @return {google.maps.Point} The position in pixels.\n * @private\n */\nClusterIcon.prototype.getPosFromLatLng_ = function(latlng) {\n    var pos = this.getProjection().fromLatLngToDivPixel(latlng);\n\n    if (typeof this.iconAnchor_ === 'object' && this.iconAnchor_.length === 2) {\n        pos.x -= this.iconAnchor_[0];\n        pos.y -= this.iconAnchor_[1];\n    } else {\n        pos.x -= parseInt(this.width_ / 2, 10);\n        pos.y -= parseInt(this.height_ / 2, 10);\n    }\n    return pos;\n};\n\n\n/**\n * Draw the icon.\n * @ignore\n */\nClusterIcon.prototype.draw = function() {\n    if (this.visible_) {\n        var pos = this.getPosFromLatLng_(this.center_);\n        this.div_.style.top = pos.y + 'px';\n        this.div_.style.left = pos.x + 'px';\n    }\n};\n\n\n/**\n * Hide the icon.\n */\nClusterIcon.prototype.hide = function() {\n    if (this.div_) {\n        this.div_.style.display = 'none';\n    }\n    this.visible_ = false;\n};\n\n\n/**\n * Position and show the icon.\n */\nClusterIcon.prototype.show = function() {\n    if (this.div_) {\n        var pos = this.getPosFromLatLng_(this.center_);\n        this.div_.style.cssText = this.createCss(pos);\n        this.div_.style.display = '';\n    }\n    this.visible_ = true;\n};\n\n\n/**\n * Remove the icon from the map\n */\nClusterIcon.prototype.remove = function() {\n    this.setMap(null);\n};\n\n\n/**\n * Implementation of the onRemove interface.\n * @ignore\n */\nClusterIcon.prototype.onRemove = function() {\n    if (this.div_ && this.div_.parentNode) {\n        this.hide();\n        this.div_.parentNode.removeChild(this.div_);\n        this.div_ = null;\n    }\n};\n\n\n/**\n * Set the sums of the icon.\n *\n * @param {Object} sums The sums containing:\n *   'text': (string) The text to display in the icon.\n *   'index': (number) The style index of the icon.\n */\nClusterIcon.prototype.setSums = function(sums) {\n    this.sums_ = sums;\n    this.text_ = sums.text;\n    this.index_ = sums.index;\n    if (this.div_) {\n        this.div_.innerHTML = sums.text;\n    }\n\n    this.useStyle();\n};\n\n\n/**\n * Sets the icon to the the styles.\n */\nClusterIcon.prototype.useStyle = function() {\n    var index = Math.max(0, this.sums_.index - 1);\n    index = Math.min(this.styles_.length - 1, index);\n    var style = this.styles_[index];\n    this.url_ = style['url'];\n    this.height_ = style['height'];\n    this.width_ = style['width'];\n    this.textColor_ = style['textColor'];\n    this.anchor_ = style['anchor'];\n    this.textSize_ = style['textSize'];\n    this.backgroundPosition_ = style['backgroundPosition'];\n    this.iconAnchor_ = style['iconAnchor'];\n};\n\n\n/**\n * Sets the center of the icon.\n *\n * @param {google.maps.LatLng} center The latlng to set as the center.\n */\nClusterIcon.prototype.setCenter = function(center) {\n    this.center_ = center;\n};\n\n\n/**\n * Create the css text based on the position of the icon.\n *\n * @param {google.maps.Point} pos The position.\n * @return {string} The css style text.\n */\nClusterIcon.prototype.createCss = function(pos) {\n    var style = [];\n    style.push('background-image:url(' + this.url_ + ');');\n    var backgroundPosition = this.backgroundPosition_ ? this.backgroundPosition_ : '0 0';\n    style.push('background-position:' + backgroundPosition + ';');\n\n    if (typeof this.anchor_ === 'object') {\n        if (typeof this.anchor_[0] === 'number' && this.anchor_[0] > 0 &&\n            this.anchor_[0] < this.height_) {\n            style.push('height:' + (this.height_ - this.anchor_[0]) +\n                'px; padding-top:' + this.anchor_[0] + 'px;');\n        } else if (typeof this.anchor_[0] === 'number' && this.anchor_[0] < 0 &&\n            -this.anchor_[0] < this.height_) {\n            style.push('height:' + this.height_ + 'px; line-height:' + (this.height_ + this.anchor_[0]) +\n                'px;');\n        } else {\n            style.push('height:' + this.height_ + 'px; line-height:' + this.height_ +\n                'px;');\n        }\n        if (typeof this.anchor_[1] === 'number' && this.anchor_[1] > 0 &&\n            this.anchor_[1] < this.width_) {\n            style.push('width:' + (this.width_ - this.anchor_[1]) +\n                'px; padding-left:' + this.anchor_[1] + 'px;');\n        } else {\n            style.push('width:' + this.width_ + 'px; text-align:center;');\n        }\n    } else {\n        style.push('height:' + this.height_ + 'px; line-height:' +\n            this.height_ + 'px; width:' + this.width_ + 'px; text-align:center;');\n    }\n\n    var txtColor = this.textColor_ ? this.textColor_ : 'black';\n    var txtSize = this.textSize_ ? this.textSize_ : 11;\n\n    style.push('cursor:pointer; top:' + pos.y + 'px; left:' +\n        pos.x + 'px; color:' + txtColor + '; position:absolute; font-size:' +\n        txtSize + 'px; font-family:Arial,sans-serif; font-weight:bold');\n    return style.join('');\n};\n\n\n// Export Symbols for Closure\n// If you are not going to compile with closure then you can remove the\n// code below.\nwindow['MarkerClusterer'] = MarkerClusterer;\nMarkerClusterer.prototype['addMarker'] = MarkerClusterer.prototype.addMarker;\nMarkerClusterer.prototype['addMarkers'] = MarkerClusterer.prototype.addMarkers;\nMarkerClusterer.prototype['clearMarkers'] =\n    MarkerClusterer.prototype.clearMarkers;\nMarkerClusterer.prototype['fitMapToMarkers'] =\n    MarkerClusterer.prototype.fitMapToMarkers;\nMarkerClusterer.prototype['getCalculator'] =\n    MarkerClusterer.prototype.getCalculator;\nMarkerClusterer.prototype['getGridSize'] =\n    MarkerClusterer.prototype.getGridSize;\nMarkerClusterer.prototype['getExtendedBounds'] =\n    MarkerClusterer.prototype.getExtendedBounds;\nMarkerClusterer.prototype['getMap'] = MarkerClusterer.prototype.getMap;\nMarkerClusterer.prototype['getMarkers'] = MarkerClusterer.prototype.getMarkers;\nMarkerClusterer.prototype['getMaxZoom'] = MarkerClusterer.prototype.getMaxZoom;\nMarkerClusterer.prototype['getStyles'] = MarkerClusterer.prototype.getStyles;\nMarkerClusterer.prototype['getTotalClusters'] =\n    MarkerClusterer.prototype.getTotalClusters;\nMarkerClusterer.prototype['getTotalMarkers'] =\n    MarkerClusterer.prototype.getTotalMarkers;\nMarkerClusterer.prototype['redraw'] = MarkerClusterer.prototype.redraw;\nMarkerClusterer.prototype['removeMarker'] =\n    MarkerClusterer.prototype.removeMarker;\nMarkerClusterer.prototype['removeMarkers'] =\n    MarkerClusterer.prototype.removeMarkers;\nMarkerClusterer.prototype['resetViewport'] =\n    MarkerClusterer.prototype.resetViewport;\nMarkerClusterer.prototype['repaint'] =\n    MarkerClusterer.prototype.repaint;\nMarkerClusterer.prototype['setCalculator'] =\n    MarkerClusterer.prototype.setCalculator;\nMarkerClusterer.prototype['setGridSize'] =\n    MarkerClusterer.prototype.setGridSize;\nMarkerClusterer.prototype['setMaxZoom'] =\n    MarkerClusterer.prototype.setMaxZoom;\nMarkerClusterer.prototype['onAdd'] = MarkerClusterer.prototype.onAdd;\nMarkerClusterer.prototype['draw'] = MarkerClusterer.prototype.draw;\n\nCluster.prototype['getCenter'] = Cluster.prototype.getCenter;\nCluster.prototype['getSize'] = Cluster.prototype.getSize;\nCluster.prototype['getMarkers'] = Cluster.prototype.getMarkers;\n\nClusterIcon.prototype['onAdd'] = ClusterIcon.prototype.onAdd;\nClusterIcon.prototype['draw'] = ClusterIcon.prototype.draw;\nClusterIcon.prototype['onRemove'] = ClusterIcon.prototype.onRemove;\n\n/* \nWebGLImageFilter - MIT Licensed\n\n2013, Dominic Szablewski - phoboslab.org\n*/\n\n(function(window){\n\nvar WebGLProgram = function( gl, vertexSource, fragmentSource ) {\n\n\tvar _collect = function( source, prefix, collection ) {\n\t\tvar r = new RegExp('\\\\b' + prefix + ' \\\\w+ (\\\\w+)', 'ig');\n\t\tsource.replace(r, function(match, name) {\n\t\t\tcollection[name] = 0;\n\t\t\treturn match;\n\t\t});\n\t};\n\n\tvar _compile = function( gl, source, type ) {\n\t\tvar shader = gl.createShader(type);\n\t\tgl.shaderSource(shader, source);\n\t\tgl.compileShader(shader);\n\n\t\tif( !gl.getShaderParameter(shader, gl.COMPILE_STATUS) ) {\n\t\t\tconsole.log(gl.getShaderInfoLog(shader));\n\t\t\treturn null;\n\t\t}\n\t\treturn shader;\n\t};\n\n\n\tthis.uniform = {};\n\tthis.attribute = {};\n\n\tvar _vsh = _compile(gl, vertexSource, gl.VERTEX_SHADER);\n\tvar _fsh = _compile(gl, fragmentSource, gl.FRAGMENT_SHADER);\n\n\tthis.id = gl.createProgram();\n\tgl.attachShader(this.id, _vsh);\n\tgl.attachShader(this.id, _fsh);\n\tgl.linkProgram(this.id);\n\n\tif( !gl.getProgramParameter(this.id, gl.LINK_STATUS) ) {\n\t\tconsole.log(gl.getProgramInfoLog(this.id));\n\t}\n\n\tgl.useProgram(this.id);\n\n\t// Collect attributes\n\t_collect(vertexSource, 'attribute', this.attribute);\n\tfor( var a in this.attribute ) {\n\t\tthis.attribute[a] = gl.getAttribLocation(this.id, a);\n\t}\n\n\t// Collect uniforms\n\t_collect(vertexSource, 'uniform', this.uniform);\n\t_collect(fragmentSource, 'uniform', this.uniform);\n\tfor( var u in this.uniform ) {\n\t\tthis.uniform[u] = gl.getUniformLocation(this.id, u);\n\t}\n};\n\n\nvar WebGLImageFilter = window.WebGLImageFilter = function() {\n\tvar \n\t\tgl = null,\n\t\t_drawCount = 0,\n\t\t_sourceTexture = null,\n\t\t_lastInChain = false,\n\t\t_currentFramebufferIndex = -1,\n\t\t_tempFramebuffers = [null, null],\n\t\t_filterChain = [],\n\t\t_width = -1, \n\t\t_height = -1,\n\t\t_vertexBuffer = null,\n\t\t_currentProgram = null,\n\t\t_canvas = document.createElement('canvas');\n\n\tvar gl = _canvas.getContext(\"webgl\") || _canvas.getContext(\"experimental-webgl\");\n\tif( !gl ) {\n\t\tthrow \"Couldn't get WebGL context\";\n\t}\n\n\t\n\tthis.addFilter = function( name ) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar filter = _filter[name];\n\n\t\t_filterChain.push({func:filter, args:args});\n\t};\n\n\tthis.reset = function() {\n\t\t_filterChain = [];\n\t};\n\t\n\tthis.apply = function( image ) {\n\t\t_resize( image.width, image.height );\n\t\t_drawCount = 0;\n\n\t\t// Create the texture for the input image\n\t\t_sourceTexture = gl.createTexture();\n\t\tgl.bindTexture(gl.TEXTURE_2D, _sourceTexture);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST); \n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n\t\t// No filters? Just draw\n\t\tif( _filterChain.length == 0 ) {\n\t\t\tvar program = _compileShader(SHADER.FRAGMENT_IDENTITY);\n\t\t\t_draw();\n\t\t\treturn _canvas;\n\t\t}\n\n\t\tfor( var i = 0; i < _filterChain.length; i++ ) {\n\t\t\t_lastInChain = (i == _filterChain.length-1);\n\t\t\tvar f = _filterChain[i];\n\n\t\t\tf.func.apply(this, f.args || []);\n\t\t}\n\n\t\treturn _canvas;\n\t};\n\n\tvar _resize = function( width, height ) {\n\t\t// Same width/height? Nothing to do here\n\t\tif( width == _width && height == _height ) { return; }\n\n\n\t\t_canvas.width = _width = width;\n\t\t_canvas.height = _height = height;\n\n\t\t// Create the context if we don't have it yet\n\t\tif( !_vertexBuffer ) {\n\t\t\t// Create the vertex buffer for the two triangles [x, y, u, v] * 6\n\t\t\tvar vertices = new Float32Array([\n\t\t\t\t-1, -1, 0, 1,  1, -1, 1, 1,  -1, 1, 0, 0,\n\t\t\t\t-1, 1, 0, 0,  1, -1, 1, 1,  1, 1, 1, 0\n\t\t\t]);\n\t\t\t_vertexBuffer = gl.createBuffer(),\n\t\t\tgl.bindBuffer(gl.ARRAY_BUFFER, _vertexBuffer);\n\t\t\tgl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n\n\t\t\t// Note sure if this is a good idea; at least it makes texture loading\n\t\t\t// in Ejecta instant.\n\t\t\tgl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n\t\t}\n\n\t\tgl.viewport(0, 0, _width, _height);\n\n\t\t// Delete old temp framebuffers\n\t\t_tempFramebuffers = [null, null];\n\t};\n\n\tvar _getTempFramebuffer = function( index ) {\n\t\t_tempFramebuffers[index] = \n\t\t\t_tempFramebuffers[index] || \n\t\t\t_createFramebufferTexture( _width, _height );\n\n\t\treturn _tempFramebuffers[index];\n\t};\n\n\tvar _createFramebufferTexture = function( width, height ) {\n\t\tvar fbo = gl.createFramebuffer();\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\n\n\t\tvar renderbuffer = gl.createRenderbuffer();\n\t\tgl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n\n\t\tvar texture = gl.createTexture();\n\t\tgl.bindTexture(gl.TEXTURE_2D, texture);\n\t\tgl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n\t\tgl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n\t\tgl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n\n\t\tgl.bindTexture(gl.TEXTURE_2D, null);\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n\t\treturn {fbo: fbo, texture: texture};\n\t};\n\n\tvar _draw = function( flags ) {\n\t\tvar source = null, \n\t\t\ttarget = null,\n\t\t\tflipY = false;\n\n\t\t// Set up the source\n\t\tif( _drawCount == 0 ) {\n\t\t\t// First draw call - use the source texture\n\t\t\tsource = _sourceTexture;\n\t\t}\n\t\telse {\n\t\t\t// All following draw calls use the temp buffer last drawn to\n\t\t\tsource =  _getTempFramebuffer(_currentFramebufferIndex).texture;\n\t\t}\n\t\t_drawCount++;\n\n\n\t\t// Set up the target\n\t\tif( _lastInChain && !(flags & DRAW.INTERMEDIATE) ) {\n\t\t\t// Last filter in our chain - draw directly to the WebGL Canvas. We may\n\t\t\t// also have to flip the image vertically now\n\t\t\ttarget = null;\n\t\t\tflipY = _drawCount % 2 == 0;\n\t\t}\n\t\telse {\n\t\t\t// Intermediate draw call - get a temp buffer to draw to\n\t\t\t_currentFramebufferIndex = (_currentFramebufferIndex+1) % 2;\n\t\t\ttarget = _getTempFramebuffer(_currentFramebufferIndex).fbo;\n\t\t}\n\n\t\t// Bind the source and target and draw the two triangles\n\t\tgl.bindTexture(gl.TEXTURE_2D, source);\n\t\tgl.bindFramebuffer(gl.FRAMEBUFFER, target);\n\n\t\tgl.uniform1f(_currentProgram.uniform.flipY, (flipY ? -1 : 1) );\n\t\tgl.drawArrays(gl.TRIANGLES, 0, 6);\n\t};\n\n\tvar _compileShader = function( fragmentSource ) {\n\t\tif( fragmentSource.__program ) {\n\t\t\t_currentProgram = fragmentSource.__program;\n\t\t\tgl.useProgram(_currentProgram.id);\n\t\t\treturn _currentProgram;\n\t\t}\n\n\t\t// Compile shaders\n\t\t_currentProgram = new WebGLProgram( gl, SHADER.VERTEX_IDENTITY, fragmentSource );\n\n\t\tvar floatSize = Float32Array.BYTES_PER_ELEMENT;\n\t\tvar vertSize = 4 * floatSize;\n\t\tgl.enableVertexAttribArray(_currentProgram.attribute.pos);\n\t\tgl.vertexAttribPointer(_currentProgram.attribute.pos, 2, gl.FLOAT, false, vertSize , 0 * floatSize);\n\t\tgl.enableVertexAttribArray(_currentProgram.attribute.uv);\n\t\tgl.vertexAttribPointer(_currentProgram.attribute.uv, 2, gl.FLOAT, false, vertSize, 2 * floatSize);\n\n\t\tfragmentSource.__program = _currentProgram;\n\t\treturn _currentProgram;\n\t};\n\n\n\tvar DRAW = { INTERMEDIATE: 1 };\n\n\tvar SHADER = {};\n\tSHADER.VERTEX_IDENTITY = [\n\t\t'precision highp float;',\n\t\t'attribute vec2 pos;',\n\t\t'attribute vec2 uv;',\n\t\t'varying vec2 vUv;',\n\t\t'uniform float flipY;',\n\n\t\t'void main(void) {',\n\t\t\t'vUv = uv;',\n\t\t\t'gl_Position = vec4(pos.x, pos.y*flipY, 0.0, 1.);',\n\t\t'}'\n\t].join('\\n');\n\n\tSHADER.FRAGMENT_IDENTITY = [\n\t\t'precision highp float;',\n\t\t'varying vec2 vUv;',\n\t\t'uniform sampler2D texture;',\n\n\t\t'void main(void) {',\n\t\t\t'gl_FragColor = texture2D(texture, vUv);',\n\t\t'}',\n\t].join('\\n');\n\n\n\tvar _filter = {};\n\n\n\n\t// ----------------------------------------------------------------------------\n\t// Color Matrix Filter\n\n\t_filter.colorMatrix = function( matrix ) {\n\t\t// Create a Float32 Array and normalize the offset component to 0-1\n\t\tvar m = new Float32Array(matrix);\n\t\tm[4] /= 255;\n\t\tm[9] /= 255;\n\t\tm[14] /= 255;\n\t\tm[19] /= 255;\n\n\t\t// Can we ignore the alpha value? Makes things a bit faster.\n\t\tvar shader = (1==m[18]&&0==m[3]&&0==m[8]&&0==m[13]&&0==m[15]&&0==m[16]&&0==m[17]&&0==m[19])\n\t\t\t? _filter.colorMatrix.SHADER.WITHOUT_ALPHA\n\t\t\t: _filter.colorMatrix.SHADER.WITH_ALPHA;\n\t\t\n\t\tvar program = _compileShader(shader);\n\t\tgl.uniform1fv(program.uniform.m, m);\n\t\t_draw();\n\t};\n\n\t_filter.colorMatrix.SHADER = {};\n\t_filter.colorMatrix.SHADER.WITH_ALPHA = [\n\t\t'precision highp float;',\n\t\t'varying vec2 vUv;',\n\t\t'uniform sampler2D texture;',\n\t\t'uniform float m[20];',\n\n\t\t'void main(void) {',\n\t\t\t'vec4 c = texture2D(texture, vUv);',\n\t\t\t'gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[3] * c.a + m[4];',\n\t\t\t'gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[8] * c.a + m[9];',\n\t\t\t'gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[13] * c.a + m[14];',\n\t\t\t'gl_FragColor.a = m[15] * c.r + m[16] * c.g + m[17] * c.b + m[18] * c.a + m[19];',\n\t\t'}',\n\t].join('\\n');\n\t_filter.colorMatrix.SHADER.WITHOUT_ALPHA = [\n\t\t'precision highp float;',\n\t\t'varying vec2 vUv;',\n\t\t'uniform sampler2D texture;',\n\t\t'uniform float m[20];',\n\n\t\t'void main(void) {',\n\t\t\t'vec4 c = texture2D(texture, vUv);',\n\t\t\t'gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[4];',\n\t\t\t'gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[9];',\n\t\t\t'gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[14];',\n\t\t\t'gl_FragColor.a = c.a;',\n\t\t'}',\n\t].join('\\n');\n\n\t_filter.brightness = function( brightness ) {\n\t\tvar b = (brightness || 0) + 1;\n\t\t_filter.colorMatrix([\n\t\t\t\tb, 0, 0, 0, 0,\n\t\t\t\t0, b, 0, 0, 0,\n\t\t\t\t0, 0, b, 0, 0,\n\t\t\t\t0, 0, 0, 1, 0\n\t\t]);\n\t};\n\n\t_filter.saturation = function( amount ) {\n\t\tvar x = (amount || 0) * 2/3 + 1;\n\t\tvar y = ((x-1) *-0.5);\n\t\t_filter.colorMatrix([\n\t\t\tx, y, y, 0, 0,\n\t\t\ty, x, y, 0, 0,\n\t\t\ty, y, x, 0, 0,\n\t\t\t0, 0, 0, 1, 0\n\t\t]);\n\t};\n\n\t_filter.desaturate = function() {\n\t\t_filter.saturation(-1);\n\t};\n\n\t_filter.contrast = function( amount ) {\n\t\tvar v = (amount || 0) + 1;\n\t\tvar o = -128 * (v-1);\n\t\t\n\t\t_filter.colorMatrix([\n\t\t\tv, 0, 0, 0, o,\n\t\t\t0, v, 0, 0, o,\n\t\t\t0, 0, v, 0, o,\n\t\t\t0, 0, 0, 1, 0\n\t\t]);\n\t};\n\n\t_filter.negative = function() {\n\t\t_filter.contrast(-2);\n\t};\n\n\t_filter.hue = function( rotation ) {\n\t\trotation = (rotation || 0)/180 * Math.PI;\n\t\tvar cos = Math.cos(rotation),\n\t\t\tsin = Math.sin(rotation),\n\t\t\tlumR = 0.213,\n\t\t\tlumG = 0.715,\n\t\t\tlumB = 0.072;\n\n\t\t_filter.colorMatrix([\n\t\t\t\tlumR+cos*(1-lumR)+sin*(-lumR),lumG+cos*(-lumG)+sin*(-lumG),lumB+cos*(-lumB)+sin*(1-lumB),0,0,\n\t\t\t\tlumR+cos*(-lumR)+sin*(0.143),lumG+cos*(1-lumG)+sin*(0.140),lumB+cos*(-lumB)+sin*(-0.283),0,0,\n\t\t\t\tlumR+cos*(-lumR)+sin*(-(1-lumR)),lumG+cos*(-lumG)+sin*(lumG),lumB+cos*(1-lumB)+sin*(lumB),0,0,\n\t\t\t\t0, 0, 0, 1, 0\n\t\t]);\n\t};\n\n\t_filter.desaturateLuminance = function() {\n\t\t_filter.colorMatrix([\n\t\t\t0.2764723, 0.9297080, 0.0938197, 0, -37.1,\n\t\t\t0.2764723, 0.9297080, 0.0938197, 0, -37.1,\n\t\t\t0.2764723, 0.9297080, 0.0938197, 0, -37.1,\n\t\t\t0, 0, 0, 1, 0\n\t\t]);\n\t};\n\n\t_filter.sepia = function() {\n\t\t_filter.colorMatrix([\n\t\t\t0.393, 0.7689999, 0.18899999, 0, 0,\n\t\t\t0.349, 0.6859999, 0.16799999, 0, 0,\n\t\t\t0.272, 0.5339999, 0.13099999, 0, 0,\n\t\t\t0,0,0,1,0\n\t\t]);\n\t};\n\n\t_filter.brownie = function() {\n\t\t_filter.colorMatrix([\n\t\t\t0.5997023498159715,0.34553243048391263,-0.2708298674538042,0,47.43192855600873,\n\t\t\t-0.037703249837783157,0.8609577587992641,0.15059552388459913,0,-36.96841498319127,\n\t\t\t0.24113635128153335,-0.07441037908422492,0.44972182064877153,0,-7.562075277591283,\n\t\t\t0,0,0,1,0\n\t\t]);\n\t};\n\n\t_filter.vintagePinhole = function() {\n\t\t_filter.colorMatrix([\n\t\t\t0.6279345635605994,0.3202183420819367,-0.03965408211312453,0,9.651285835294123,\n\t\t\t0.02578397704808868,0.6441188644374771,0.03259127616149294,0,7.462829176470591,\n\t\t\t0.0466055556782719,-0.0851232987247891,0.5241648018700465,0,5.159190588235296,\n\t\t\t0,0,0,1,0\n\t\t]);\n\t};\n\n\t_filter.kodachrome = function() {\n\t\t_filter.colorMatrix([\n\t\t\t1.1285582396593525,-0.3967382283601348,-0.03992559172921793,0,63.72958762196502,\n\t\t\t-0.16404339962244616,1.0835251566291304,-0.05498805115633132,0,24.732407896706203,\n\t\t\t-0.16786010706155763,-0.5603416277695248,1.6014850761964943,0,35.62982807460946,\n\t\t\t0,0,0,1,0\n\t\t]);\n\t};\n\n\t_filter.technicolor = function() {\n\t\t_filter.colorMatrix([\n\t\t\t1.9125277891456083,-0.8545344976951645,-0.09155508482755585,0,11.793603434377337,\n\t\t\t-0.3087833385928097,1.7658908555458428,-0.10601743074722245,0,-70.35205161461398,\n\t\t\t-0.231103377548616,-0.7501899197440212,1.847597816108189,0,30.950940869491138,\n\t\t\t0,0,0,1,0\n\t\t]);\n\t};\n\n\t_filter.polaroid = function() {\n\t\t_filter.colorMatrix([\n\t\t\t1.438,-0.062,-0.062,0,0,\n\t\t\t-0.122,1.378,-0.122,0,0,\n\t\t\t-0.016,-0.016,1.483,0,0,\n\t\t\t0,0,0,1,0\n\t\t]);\n\t};\n\n\t_filter.shiftToBGR = function() {\n\t\t_filter.colorMatrix([\n\t\t\t0,0,1,0,0,\n\t\t\t0,1,0,0,0,\n\t\t\t1,0,0,0,0,\n\t\t\t0,0,0,1,0\n\t\t]);\n\t};\n\n\n\t// ----------------------------------------------------------------------------\n\t// Convolution Filter\n\n\t_filter.convolution = function( matrix ) {\n\t\tvar m = new Float32Array(matrix);\n\t\tvar pixelSizeX = 1 / _width;\n\t\tvar pixelSizeY = 1 / _height;\n\n\t\tvar program = _compileShader(_filter.convolution.SHADER);\n\t\tgl.uniform1fv(program.uniform.m, m);\n\t\tgl.uniform2f(program.uniform.px, pixelSizeX, pixelSizeY);\n\t\t_draw();\n\t};\n\n\t_filter.convolution.SHADER = [\n\t\t'precision highp float;',\n\t\t'varying vec2 vUv;',\n\t\t'uniform sampler2D texture;',\n\t\t'uniform vec2 px;',\n\t\t'uniform float m[9];',\n\n\t\t'void main(void) {',\n\t\t\t'vec4 c11 = texture2D(texture, vUv - px);', // top left\n\t\t\t'vec4 c12 = texture2D(texture, vec2(vUv.x, vUv.y - px.y));', // top center\n\t\t\t'vec4 c13 = texture2D(texture, vec2(vUv.x + px.x, vUv.y - px.y));', // top right\n\n\t\t\t'vec4 c21 = texture2D(texture, vec2(vUv.x - px.x, vUv.y) );', // mid left\n\t\t\t'vec4 c22 = texture2D(texture, vUv);', // mid center\n\t\t\t'vec4 c23 = texture2D(texture, vec2(vUv.x + px.x, vUv.y) );', // mid right\n\n\t\t\t'vec4 c31 = texture2D(texture, vec2(vUv.x - px.x, vUv.y + px.y) );', // bottom left\n\t\t\t'vec4 c32 = texture2D(texture, vec2(vUv.x, vUv.y + px.y) );', // bottom center\n\t\t\t'vec4 c33 = texture2D(texture, vUv + px );', // bottom right\n\n\t\t\t'gl_FragColor = ',\n\t\t\t\t'c11 * m[0] + c12 * m[1] + c22 * m[2] +',\n\t\t\t\t'c21 * m[3] + c22 * m[4] + c23 * m[5] +',\n\t\t\t\t'c31 * m[6] + c32 * m[7] + c33 * m[8];',\n\t\t\t'gl_FragColor.a = c22.a;',\n\t\t'}',\n\t].join('\\n');\n\n\n\t_filter.detectEdges = function() {\n\t\t_filter.convolution.call(this, [\n\t\t\t0, 1, 0,\n\t\t\t1 -4, 1,\n\t\t\t0, 1, 0\n\t\t]);\n\t};\n\n        _filter.sobelX = function() {\n                _filter.convolution.call(this, [\n                        -1, 0, 1,\n                        -2, 0, 2,\n                        -1, 0, 1\n                ]);\n        };\n\n        _filter.sobelY = function() {\n                _filter.convolution.call(this, [\n                        -1, -2, -1,\n                         0,  0,  0,\n                         1,  2,  1\n                ]);\n        };\n\n\t_filter.sharpen = function( amount ) {\n\t\tvar a = amount || 1;\n\t\t_filter.convolution.call(this, [\n\t\t\t0, -1*a, 0,\n\t\t\t-1*a, 1 + 4*a, -1*a,\n\t\t\t0, -1*a, 0\n\t\t]);\n\t};\n\n\t_filter.emboss = function( size ) {\n\t\tvar s = size || 1;\n\t\t_filter.convolution.call(this, [\n\t\t\t-2*s, -1*s, 0,\n\t\t\t-1*s, 1, 1*s,\n\t\t\t0, 1*s, 2*s\n\t\t]);\n\t};\n\n\n\t// ----------------------------------------------------------------------------\n\t// Blur Filter\n\n\t_filter.blur = function( size ) {\n\t\tvar blurSizeX = (size/7) / _width;\n\t\tvar blurSizeY = (size/7) / _height;\n\n\t\tvar program = _compileShader(_filter.blur.SHADER);\n\n\t\t// Vertical\n\t\tgl.uniform2f(program.uniform.px, 0, blurSizeY);\n\t\t_draw(DRAW.INTERMEDIATE);\n\n\t\t// Horizontal\n\t\tgl.uniform2f(program.uniform.px, blurSizeX, 0);\n\t\t_draw();\n\t};\n\n\t_filter.blur.SHADER = [\n\t\t'precision highp float;',\n\t\t'varying vec2 vUv;',\n\t\t'uniform sampler2D texture;',\n\t\t'uniform vec2 px;',\n\n\t\t'void main(void) {',\n\t\t\t'gl_FragColor = vec4(0.0);',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-7.0*px.x, -7.0*px.y))*0.0044299121055113265;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-6.0*px.x, -6.0*px.y))*0.00895781211794;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-5.0*px.x, -5.0*px.y))*0.0215963866053;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-4.0*px.x, -4.0*px.y))*0.0443683338718;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-3.0*px.x, -3.0*px.y))*0.0776744219933;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-2.0*px.x, -2.0*px.y))*0.115876621105;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2(-1.0*px.x, -1.0*px.y))*0.147308056121;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv                             )*0.159576912161;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 1.0*px.x,  1.0*px.y))*0.147308056121;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 2.0*px.x,  2.0*px.y))*0.115876621105;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 3.0*px.x,  3.0*px.y))*0.0776744219933;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 4.0*px.x,  4.0*px.y))*0.0443683338718;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 5.0*px.x,  5.0*px.y))*0.0215963866053;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 6.0*px.x,  6.0*px.y))*0.00895781211794;',\n\t\t\t'gl_FragColor += texture2D(texture, vUv + vec2( 7.0*px.x,  7.0*px.y))*0.0044299121055113265;',\n\t\t'}',\n\t].join('\\n');\n};\n\n})(window);\n\n(function () {\n    'use strict';\n\n    angular.module('starter').filter('hashtag', hashtag);\n\n    function hashtag($filter) {\n        return function (text, target) {\n            if (!text) return text;\n\n            var replacedText = $filter('linky')(text, target);\n\n            var targetAttr = \"\";\n            if (angular.isDefined(target)) {\n                targetAttr = target;\n            }\n\n            // replace #hashtags and send them to twitter\n            var replacePattern1 = /(^|\\s)#(\\w*[a-zA-Z_]+\\w*)/gim;\n            replacedText        = text.replace(replacePattern1, '$1<a href=\"#/tab/search/%23$2\"' + targetAttr + '>#$2</a>');\n\n            // replace @mentions but keep them to our site\n            var replacePattern2 = /(^|\\s)\\@(\\w*[a-zA-Z_]+\\w*)/gim;\n            replacedText        = replacedText.replace(replacePattern2, '$1<a href=\"#/tab/home/$2\" >@$2</a>');\n\n            return replacedText;\n        };\n    }\n\n})();\n\n\n(function () {\n    'use strict';\n\n    angular.module('starter').filter('words', words);\n\n    function words() {\n\n        ////////////////\n\n        return function (input, words) {\n            if (isNaN(words)) {\n                return input;\n            }\n            if (words <= 0) {\n                return '';\n            }\n            if (input) {\n                var inputWords = input.split(/\\s+/);\n                if (inputWords.length > words) {\n                    input = inputWords.slice(0, words).join(' ') + '\\u2026';\n                }\n            }\n            return input;\n        };\n    }\n\n})();\n\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('signinModal', signinModalDirective);\n\n    function signinModalDirective($ionicModal, Loading, User, $state, Toast, UserForm, AppConfig, $rootScope) {\n        return {\n            restrict: 'A',\n            link    : signinModalLink,\n        };\n\n        function signinModalLink($scope, elem, attr) {\n            elem.bind('click', function () {\n\n                $scope.formFields  = UserForm.login;\n                $scope.routeLogged = AppConfig.routes.home;\n\n                $scope.form = {\n                    username: '',\n                    password: ''\n                };\n\n                $scope.submitLogin = function (rForm, data) {\n                    var form = angular.copy(data);\n                    if (!rForm.$invalid) {\n                        Loading.start();\n                        User.signIn(form).then(function (data) {\n                            console.log(data);\n                            $rootScope.currentUser = data;\n                            $state.go($scope.routeLogged, {\n                                clear: true\n                            });\n                            $scope.closeModal();\n                            Loading.end();\n                        }).catch(function (resp) {\n                            Toast.alert({\n                                title: 'Error',\n                                text : 'Incorrect username or password'\n                            });\n                            Loading.end();\n                        });\n                    } else {\n                        return false;\n                    }\n                };\n\n                $ionicModal.fromTemplateUrl('app/directive/SigninModalDirective.html', {\n                    scope          : $scope,\n                    animation      : 'slide-in-up',\n                    focusFirstInput: true,\n                }).then(function (modal) {\n                    $scope.modal = modal;\n                    $scope.modal.show();\n                });\n\n                $scope.closeModal = function () {\n                    $scope.modal.hide();\n                };\n                // Cleanup the modal when we're done with it!\n                $scope.$on('$destroy', function () {\n                    $scope.modal.remove();\n                });\n            });\n        }\n    }\n\n})();\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('signupModal', signupModalDirective);\n\n    function signupModalDirective(UserForm, AppConfig, Loading, User, $state, Toast, $ionicModal, $rootScope) {\n        return {\n            restrict: 'A',\n            link    : signupModalLink,\n        };\n\n        function signupModalLink($scope, elem, attr) {\n            elem.bind('click', function () {\n\n                $scope.formFields  = UserForm.register;\n                $scope.routeLogged = AppConfig.routes.home;\n\n                $scope.form = {\n                    username: '',\n                    email   : '',\n                    password: ''\n                };\n\n                $scope.submitRegister = function (rForm, data) {\n                    if (rForm.$valid) {\n                        Loading.start();\n                        var form = angular.copy(data);\n                        User.signUp(form).then(function (resp) {\n                            console.log(resp);\n\n                            // After register, login\n                            User.signIn({\n                                username: form.username,\n                                password: form.password\n                            }).then(function (data) {\n                                console.log(data);\n                                $rootScope.currentUser = Parse.User.current();\n                                $state.go('user.avatar', {\n                                    clear: true\n                                });\n                                Loading.end();\n                                $scope.closeModal();\n                            }).catch(function (resp) {\n                                console.log(resp);\n                                Toast.alert({\n                                    title: 'Alert',\n                                    text : resp.error\n                                });\n                                Loading.end();\n                            });\n                        }).catch(function (resp) {\n                            console.log(resp);\n                            Toast.alert({\n                                title: 'Alert',\n                                text : resp.error\n                            });\n                            Loading.end();\n                        });\n                    }\n\n\n                };\n\n                $ionicModal.fromTemplateUrl('app/directive/SignupModalDirective.html', {\n                    scope          : $scope,\n                    animation      : 'slide-in-up',\n                    focusFirstInput: true,\n                }).then(function (modal) {\n                    $scope.modal = modal;\n                    $scope.modal.show();\n                });\n\n                $scope.closeModal = function () {\n                    $scope.modal.hide();\n                };\n                // Cleanup the modal when we're done with it!\n                $scope.$on('$destroy', function () {\n                    $scope.modal.remove();\n                });\n            });\n        }\n    }\n\n})();\n(function () {\n    'use strict';\n    angular\n        .module('starter')\n        .directive('buy', buyDirective);\n\n    function buyDirective($cordovaInAppBrowser) {\n        return {\n            restrict: 'A',\n            link: buyLink\n        };\n\n        function buyLink(scope, elem) {\n            elem.bind('click', function () {\n                var url     = 'https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=FAW4JZS7KJM5S';\n\n                if(window.cordova ) {\n                    cordova\n                        .ThemeableBrowser\n                        .open(url, '_blank', {\n                            statusbar: {\n                                color: '#ffffffff'\n                            },\n                            toolbar: {\n                                height: 44,\n                                color: '#f0f0f0ff'\n                            },\n                            title: {\n                                color: '#333333',\n                                showPageTitle: true\n                            },\n                            closeButton: {\n                                image: 'close',\n                                imagePressed: 'close_pressed',\n                                align: 'left',\n                                event: 'closePressed'\n                            },\n                            backButtonCanClose: true\n                        });\n                } else {\n                    window.open(url,'_blank');\n                }\n            });\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('compareTo', compareToDirective);\n\n    function compareToDirective() {\n        return {\n            restrict: 'A',\n            scope   : {\n                targetModel: '=compareTo'\n            },\n            require : 'ngModel',\n            link    : function postLink(scope, element, attrs, ctrl) {\n\n                var compare = function () {\n\n                    var e1 = element.val();\n                    var e2 = scope.targetModel;\n\n                    if (e2 !== null) {\n                        return e1 === e2;\n                    }\n\n                    return false;\n                };\n\n                scope.$watch(compare, function (newValue) {\n                    ctrl.$setValidity('errorCompareTo', newValue);\n                });\n\n            }\n        };\n    }\n\n})();\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('distanceModal', distanceModalDirective);\n\n    function distanceModalDirective($localStorage, $ionicModal) {\n        return {\n            restrict: 'A',\n            link    : distanceModalLink\n        };\n\n        function distanceModalLink($scope, elem, attr) {\n\n            elem.bind('click', function () {\n                    $scope.storage   = $localStorage;\n                    $scope.distances = [\n                        {\n                            val : 0.20,\n                            text: 'perto'\n                        },\n                        {\n                            val : 0.60,\n                            text: 'longe'\n                        },\n                        {\n                            val : 1.00,\n                            text: '1 ' + $scope.storage.unit\n                        },\n                        {\n                            val : 5.00,\n                            text: '5 ' + $scope.storage.unit\n                        },\n                        {\n                            val : 10.00,\n                            text: '10 ' + $scope.storage.unit\n                        },\n                        {\n                            val : 25.00,\n                            text: '25 ' + $scope.storage.unit\n                        },\n                        {\n                            val : 50.00,\n                            text: '50 ' + $scope.storage.unit\n                        },\n                        {\n                            val : 100.00,\n                            text: '100 ' + $scope.storage.unit\n                        },\n                    ];\n\n                    $ionicModal.fromTemplateUrl('app/directive/distanceModal.html', {\n                        scope: $scope\n                    }).then(function (modal) {\n                        $scope.modal = modal;\n                        $scope.modal.show();\n\n                    });\n\n                    $scope.onDistanceSelected = function (distance) {\n                        console.log('Distance', distance);\n                    };\n\n                    $scope.closeDistanceModal = function () {\n                        $scope.modal.hide();\n                        $scope.modal.remove();\n                    };\n\n\n                }\n            );\n        }\n    }\n\n})\n();\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('emailValidator', emailValidatorDirective);\n\n    function emailValidatorDirective(User) {\n        return {\n            require: 'ngModel',\n            link    : emailValidatorLink,\n        };\n\n        function emailValidatorLink(scope, elem, attr,ngModel) {\n            ngModel.$asyncValidators.email = function  (modelValue, viewValue) {\n                console.log(viewValue);\n                if(viewValue) {\n                    return User.validateEmail(viewValue);\n                }\n            }\n        }\n    }\n\n})();\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('facebookLogin', facebookLoginDirective);\n\n    function facebookLoginDirective(Loading, $state, $q, $translate, AppConfig, Facebook, Dialog, User, $rootScope, Toast) {\n        return {\n            restrict: 'E',\n            link    : facebookLoginLink,\n            template: '<button class=\"button button-block button-facebook\"><i class=\"icon ion-social-facebook\"></i> <ion-spinner ng-if=\"loading\"></ion-spinner> <span ng-if=\"!loading\">{{ name || \\'loginWithFacebook\\'| translate}}</span> </button>',\n        };\n\n        function facebookLoginLink(scope, elem, attr) {\n\n            scope.facebookStatus = null;\n            Facebook.getCurrentUser().then(function (resp) {\n                console.log(resp);\n                scope.facebookStatus = resp;\n                return resp;\n            }).then(function (facebookStatus) {\n                if (facebookStatus.status === 'connected') {\n                    Facebook.me().then(function (userFacebook) {\n                        scope.name = userFacebook.name;\n                    });\n                }\n            }).catch(function () {\n                console.log('Not logged');\n            });\n\n            elem.bind('click', facebookLogin);\n\n            function facebookLogin() {\n                console.log('Facebook login');\n                scope.loading = true;\n\n                Facebook.logIn().then(function (fbAuthData) {\n                        console.log(fbAuthData);\n                        if (fbAuthData.status === 'connected') {\n                            var fbData = null;\n                            return Facebook.me().then(function (data) {\n                                fbData = data;\n                                return User.findByEmail(data.email);\n                            }).then(function (user) {\n                                if (!user.id) {\n                                    return User.signInViaFacebook(fbAuthData);\n                                } else {\n                                    if (user.get('authData').facebook.id === fbData.id) {\n                                        return User.signInViaFacebook(fbAuthData);\n                                    }\n                                }\n                            }).then(function () {\n                                return User.updateWithFacebookData(fbData);\n                            }).then(function (user) {\n                                $rootScope.currentUser = user;\n                                $state.go(AppConfig.routes.home, {\n                                    clear: true\n                                });\n                                console.log(user, user.attributes);\n                                $rootScope.$broadcast('onUserLogged');\n                                Loading.end();\n                                Toast.alert({text: $translate.instant('loggedInAsText') + ' ' + user.get('email')});\n                            }, function (error) {\n                                Dialog.alert(error);\n                            });\n                        }\n\n                    }\n                ).catch(function () {\n                    Loading.end();\n                });\n\n            }\n\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').directive('focusMe', focusMeDirective);\n\n    function focusMeDirective($timeout, $rootScope) {\n        return {\n            restrict: 'A',\n            link    : function (scope, element, attrs) {\n\n                $rootScope.$on('openKeyboard', openKeyboard);\n\n                openKeyboard();\n\n                function openKeyboard() {\n                    $timeout(function () {\n                        element[0].focus();\n                        element[0].click();\n                        if (window.cordova) {\n                            cordova.plugins.Keyboard.show();\n                        }\n                    }, 750);\n                }\n            }\n        };\n    }\n\n})();\n\n(function () {\n  'use strict';\n\n angular\n    .module('starter')\n    .directive('heart', heartDirective);\n\n  function heartDirective() {\n    return {\n      restrict: 'A',\n      scope: {\n        item: '='\n      },\n      link: heartLink\n    };\n\n    function heartLink(scope, elem, attr) {\n      elem.bind('click', function () {\n        console.log(scope.item);\n        elem.addClass('happy');\n      });\n    }\n  }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter')\n           .directive('ionLoading', ionLoading)\n           .run(runLoading)\n           .factory('Loading', Loading);\n\n    function ionLoading() {\n        return {\n            restrict: 'E',\n            scope   : {\n                icon   : '@',\n                loading: '='\n            },\n            template: '<div class=\"padding text-center loading\" ng-show=\"loading\"><ion-spinner icon=\"{{ icon }}\"></ion-spinner></div>'\n        };\n    }\n\n    function runLoading($rootScope, $ionicLoading) {\n        //Loading\n        $rootScope.$on('ionicLoading:true', function (text) {\n            $rootScope.loading = true;\n            $ionicLoading.show(text);\n        });\n        $rootScope.$on('ionicLoading:false', function () {\n            $rootScope.loading = false;\n            $ionicLoading.hide();\n        });\n    }\n\n    function Loading($rootScope, $timeout) {\n        var seconds = 0;\n\n        return {\n            start: showLoading,\n            end: hideLoading,\n        };\n\n\n        function showLoading(text) {\n            $rootScope.$broadcast('ionicLoading:true', text);\n        }\n\n        function hideLoading() {\n            $timeout(function () {\n                $rootScope.$broadcast('ionicLoading:false');\n            }, parseInt(seconds + '000'));\n        }\n    }\n})();\n(function () {\n  'use strict';\n\n  angular\n    .module('starter')\n    .directive('loading', PhotogramLoadingDirective);\n\n  function PhotogramLoadingDirective() {\n    return {\n      restrict: 'E',\n      scope   : {\n        loading: '=',\n        icon   : '@'\n      },\n      template: '<div class=\"padding text-center loading\" ng-show=\"loading\"><ion-spinner icon=\"{{ icon }}\"></ion-spinner></div>'\n    };\n  }\n\n})();\n\n(function () {\n  'use strict';\n  \n  angular\n    .module('starter')\n    .directive('photogramFollow', photogramFollowDirective);\n\n  function photogramFollowDirective($ionicModal, AppConfig, Photogram) {\n\n    var path = AppConfig.path;\n\n    return {\n      restrict: 'A',\n      scope: {\n        user: '='\n      },\n      link: function (scope, elem, attr) {\n        elem.bind('click', openModal);\n        scope.closeModal = closeModal;\n\n        function openModal() {\n          $ionicModal.fromTemplateUrl(path + '/directive/follow/photogram.follow.modal.html', {\n            scope: scope\n          }).then(function (modal) {\n            scope.modalFollow = modal;\n            console.log('Open modal follow', scope.user);\n\n            Photogram\n              .getFollow(scope.user)\n              .then(function (resp) {\n                console.log(resp);\n                scope.data = resp;\n                scope.modalFollow.show();\n              });\n\n          });\n        }\n\n        function closeModal() {\n          scope.modalFollow.hide();\n          scope.modalFollow.remove();\n        }\n      }\n    }\n  }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('photoGrid', photoGridDirective);\n\n    function photoGridDirective(Gallery, $rootScope, $ionicPopup, Share, FeedbackModal, $ionicActionSheet) {\n\n        return {\n            restrict   : 'E',\n            scope      : {\n                username: '=',\n                user    : '=',\n                profile : '='\n            },\n            templateUrl: 'app/directive/photoGridDirective.html',\n            link       : photoGridCtrl\n        };\n\n        function photoGridCtrl($scope, elem, attr) {\n            $scope.params      = {};\n            $scope.params.page = 1;\n            $scope.data        = [];\n\n            if ($scope.username) {\n                $scope.params.username = $scope.username;\n            }\n\n            $scope.loading = true;\n\n            $rootScope.$on('photoInclude', function (elem, item) {\n                if (item.objectId) {\n                    item.id = item.objectId;\n                }\n                $scope.data.unshift(item);\n            });\n\n\n            loadFeed();\n\n            var isLoadingViewShown   = false;\n            var isGalleriesViewShown = false;\n            var isErrorViewShown     = false;\n            var isEmptyViewShown     = false;\n\n            var isMoreData = false;\n\n            function showLoading() {\n                isLoadingViewShown   = true;\n                isGalleriesViewShown = false;\n                isErrorViewShown     = false;\n                isEmptyViewShown     = false;\n            }\n\n            function showGalleries() {\n                isGalleriesViewShown = true;\n                isLoadingViewShown   = false;\n                isErrorViewShown     = false;\n                isEmptyViewShown     = false;\n            }\n\n            function showErrorView() {\n                isErrorViewShown     = true;\n                isGalleriesViewShown = false;\n                isLoadingViewShown   = false;\n                isEmptyViewShown     = false;\n            }\n\n            function showEmptyView() {\n                isEmptyViewShown     = true;\n                isErrorViewShown     = false;\n                isGalleriesViewShown = false;\n                isLoadingViewShown   = false;\n            }\n\n\n            function ensureMoreData(length) {\n                isMoreData = false;\n                if (length > 0) {\n                    isMoreData = true;\n                }\n            }\n\n            function setGalleries(data) {\n                for (var i = 0; i < data.length; i++) {\n                    $scope.data.push(data[i]);\n                }\n            }\n\n            function setCurrentPage(page) {\n                $scope.params.page = page;\n            }\n\n            function loadFeed() {\n\n                Gallery.feed($scope.params).then(function (data) {\n                    ensureMoreData(data.length);\n                    setCurrentPage($scope.params.page + 1);\n                    setGalleries(data);\n\n                    if ($scope.data.length === 0) {\n                        showEmptyView();\n                    } else {\n                        showGalleries();\n                    }\n\n                    $scope.$broadcast('scroll.infiniteScrollComplete');\n                    $scope.$broadcast('scroll.refreshComplete');\n                    $scope.loading = false;\n\n                }).catch(function () {\n                    if ($scope.data.length === 0) {\n                        showErrorView();\n                    }\n                    isMoreData = false;\n                    $scope.$broadcast('scroll.refreshComplete');\n                });\n            }\n\n            $scope.onLoadMore = function () {\n                loadFeed();\n            };\n\n            $scope.moreDataCanBeLoaded = function () {\n                return isMoreData;\n            };\n\n            $scope.showLoadingView = function () {\n                return isLoadingViewShown;\n            };\n\n            $scope.showGalleries = function () {\n                return isGalleriesViewShown;\n            };\n\n            $scope.showErrorView = function () {\n                return isErrorViewShown;\n            };\n\n            $scope.showEmptyView = function () {\n                return isEmptyViewShown;\n            };\n\n            $scope.onReload = function () {\n                $scope.params.page = 0;\n                $scope.data        = [];\n                showLoading();\n                loadFeed();\n                $scope.$broadcast('scroll.refreshComplete');\n            };\n\n            $scope.action = function (gallery) {\n\n                var buttons = [{\n                    text: '<i class=\"icon ion-share\"></i>' + ('Share')\n                }, {\n                    text: '<i class=\"icon ion-alert-circled\"></i>' + ('Report')\n                }];\n\n\n                console.log(gallery);\n\n                if (Parse.User.current().id === gallery.user_id) {\n                    var buttonDelete = {\n                        text: '<i class=\"icon ion-trash-b\"></i>' + ('Delete your photo')\n                    };\n                    buttons.push(buttonDelete);\n                }\n                var message = {\n                    text : gallery.title,\n                    image: gallery.img\n                };\n\n                var actionSheet = {\n                    buttons      : buttons,\n                    titleText    : ('Photo'),\n                    cancelText   : ('Cancel'),\n                    buttonClicked: actionButtons\n                };\n\n\n                function actionButtons(index) {\n                    switch (index) {\n                        case 0:\n                            Share.share(message);\n                            break;\n                        case 1:\n                            FeedbackModal.modal(gallery);\n                            break;\n                        case 2:\n\n                            $ionicPopup\n                                .confirm({\n                                    title   : ('Delete photo'),\n                                    template: ('Are you sure?')\n                                })\n                                .then(function (res) {\n                                    if (res) {\n                                        Gallery.destroy(gallery).then(function () {\n                                            console.log('Photo deleted');\n                                            $scope.$emit('PhotogramHome:reload');\n                                        });\n                                    }\n                                });\n\n\n                    }\n                    return true;\n                }\n\n                // Show the action sheet\n                $ionicActionSheet.show(actionSheet);\n            };\n\n        }\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('photoComment', photoCommentDirective);\n\n    function photoCommentDirective($ionicModal, $http, $q, $ionicScrollDelegate, Loading, $ionicPopup, User, Dialog, $rootScope, Gallery, GalleryComment, GalleryForm) {\n\n        return {\n            restrict: 'A',\n            scope   : {\n                ngModel: '='\n            },\n            link    : function ($scope, elem) {\n\n\n                elem.bind('click', openModalComment);\n\n                function init() {\n                    $scope.currentUser = Parse.User.current();\n                    $scope.nocomments  = false;\n                    $scope.loading     = false;\n                    $scope.form        = {\n                        gallery: $scope.ngModel.galleryObj,\n                        text   : ''\n                    };\n                }\n\n                function openModalComment() {\n                    console.log($scope.ngModel);\n\n                    init();\n\n                    $scope.loading       = true;\n                    $scope.formFields    = GalleryForm.formComment;\n                    $scope.submitComment = submitComment;\n                    $scope.deleteComment = deleteComment;\n                    $scope.editComment   = editComment;\n                    $scope.closeModal    = function () {\n                        $scope.modal.hide();\n                        $scope.modal.remove();\n                    };\n\n                    getComments();\n\n                    //Mentios\n                    // shows the use of dynamic values in mentio-id and mentio-for to link elements\n                    $scope.myIndexValue = \"5\";\n\n\n                    $scope.searchPeople = function (term) {\n                        var peopleList = [];\n                        return User.getFollowing().then(function (response) {\n                            _.each(response, function (item) {\n                                item.imageUrl = item.photo ? item.photo._url : 'img/user.png';\n                                item.bio      = item.status;\n                                if (item.name.toUpperCase().indexOf(term.toUpperCase()) >= 0) {\n                                    peopleList.push(item);\n                                }\n                            });\n                            $scope.people = peopleList;\n                            console.log(peopleList);\n                            return $q.when(peopleList);\n                        });\n                    };\n\n                    $scope.getPeopleTextRaw = function (item) {\n                        return '@' + item.username;\n                    };\n\n\n                    //$scope.comments = $scope.ngModel.comments || [];\n                    //$timeout(function () {\n                    //    if ($scope.comments.length === 0) {\n                    //        $scope.nocomments = true;\n                    //    }\n                    //}, 500);\n\n\n                    $ionicModal.fromTemplateUrl('app/directive/photoCommentDirective.html', {\n                        scope          : $scope,\n                        focusFirstInput: true\n                    }).then(function (modal) {\n                        $scope.modal = modal;\n                        $scope.modal.show();\n\n                    });\n                }\n\n                function deleteComment(obj) {\n                    console.log(obj);\n                    Dialog.confirm(('Delete comment'), ('You are sure?')).then(function (resp) {\n                        console.log(resp);\n                        if (resp) {\n                            GalleryComment.destroy(obj).then(function (resp) {\n                                console.log(resp);\n                                getComments();\n                            });\n                        }\n                    });\n                }\n\n                function editComment(obj) {\n                    console.log(obj);\n                    // An elaborate, custom popup\n                    $scope.data = angular.copy(obj);\n                    $ionicPopup\n                        .show({\n                            template: '<input type=\"text\" ng-model=\"data.text\">',\n                            title   : ('Edit comment'),\n                            //subTitle: 'Please use normal things',\n                            scope   : scope,\n                            buttons : [{\n                                text: ('Cancel')\n                            }, {\n                                text : '<b>OK</b>',\n                                type : 'button-positive',\n                                onTap: function (e) {\n                                    console.log($scope.data);\n                                    if (!$scope.data.text) {\n                                        //don't allow the user to close unless he enters wifi password\n                                        e.preventDefault();\n                                    } else {\n                                        return $scope.data;\n                                    }\n                                }\n                            }]\n                        })\n                        .then(function (resp) {\n                            console.log(resp);\n                            if (resp) {\n                                GalleryComment.update(resp)\n                                              .then(function (resp) {\n                                                  console.log(resp);\n                                                  getComments();\n                                              });\n                            }\n                        });\n                }\n\n                function getComments() {\n                    $scope.loading = true;\n\n\n                    Gallery.comments({galleryId: $scope.ngModel.id}).then(function (resp) {\n                        $scope.comments         = resp;\n                        $scope.ngModel.comments = resp;\n                        $scope.loading          = false;\n\n                        //$timeout(function () {\n                        //    // Scroll to bottom\n                        //    $ionicScrollDelegate.scrollBottom();\n                        //}, 1);\n                    });\n                }\n\n                function submitComment(rForm, form) {\n                    if (rForm.$valid) {\n                        var dataForm = angular.copy(form);\n                        console.log(dataForm);\n                        Loading.start();\n                        GalleryComment.create(dataForm).then(function (resp) {\n                            console.log(resp);\n                            getComments();\n                            $rootScope.$emit('openKeyboard');\n                            Loading.end();\n                            $scope.closeModal();\n                        });\n                    }\n                }\n\n\n            }\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').directive('photoLike', photoLikeDirective);\n\n    function photoLikeDirective(Gallery) {\n        return {\n            restrict: 'A',\n            scope   : {\n                ngModel: '='\n            },\n            link    : function (scope, elem) {\n                elem.bind('click', function () {\n                        var _model      = scope.ngModel;\n                        _model.progress = true;\n                        _model.liked    = !_model.liked;\n\n                        Gallery.likeGallery({galleryId: scope.ngModel.galleryObj.id}).then(function (resp) {\n                            console.log(resp);\n                            _model.likes    = resp.likes;\n                            _model.progress = false;\n                            console.log(_model, resp);\n                            if (resp.action === 'like') {\n                                scope.ngModel.isLiked = true;\n                                scope.ngModel.likesTotal += 1;\n                            }\n\n                            if (resp.action === 'unlike') {\n                                scope.ngModel.isLiked = false;\n                                scope.ngModel.likesTotal -= 1;\n                            }\n                        });\n                    }\n                );\n\n            }\n        };\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('photoList', photoListDirective);\n\n    function photoListDirective(Gallery, $rootScope, $ionicPopup, $translate, $state, Share, Toast, FeedbackModal, $ionicActionSheet) {\n\n        return {\n            restrict   : 'E',\n            scope      : {\n                username  : '=',\n                profile   : '=',\n                load      : '=',\n                openLikers: '=',\n            },\n            templateUrl: 'app/directive/photoListDirective.html',\n            link       : photoListController\n        };\n\n        function photoListController($scope, elem, attr) {\n            $scope.params      = {};\n            $scope.params.page = 0;\n            $scope.data        = [];\n\n            if ($scope.username) {\n                $scope.params.username = $scope.username;\n            }\n\n            $scope.loading = true;\n\n            $rootScope.$on('photoInclude', function (elem, item) {\n                if (item.objectId) {\n                    item.id = item.objectId;\n                }\n                $scope.data.unshift(item);\n            });\n\n            $scope.openComment = function (galleryId) {\n                $state.go('galleryComments', {galleryId: galleryId})\n            };\n\n            $scope.share = Share.open;\n\n\n            loadFeed();\n\n            var isLoadingViewShown   = false;\n            var isGalleriesViewShown = false;\n            var isErrorViewShown     = false;\n            var isEmptyViewShown     = false;\n            var isMoreData           = false;\n\n            function showLoading() {\n                isLoadingViewShown   = true;\n                isGalleriesViewShown = false;\n                isErrorViewShown     = false;\n                isEmptyViewShown     = false;\n            }\n\n            function showGalleries() {\n                isGalleriesViewShown = true;\n                isLoadingViewShown   = false;\n                isErrorViewShown     = false;\n                isEmptyViewShown     = false;\n            }\n\n            function showErrorView() {\n                isErrorViewShown     = true;\n                isGalleriesViewShown = false;\n                isLoadingViewShown   = false;\n                isEmptyViewShown     = false;\n            }\n\n            function showEmptyView() {\n                isEmptyViewShown     = true;\n                isErrorViewShown     = false;\n                isGalleriesViewShown = false;\n                isLoadingViewShown   = false;\n            }\n\n\n            function ensureMoreData(length) {\n                isMoreData = false;\n                if (length > 0) {\n                    isMoreData = true;\n                }\n            }\n\n            function setGalleries(data) {\n                for (var i = 0; i < data.length; i++) {\n                    $scope.data.push(data[i]);\n                }\n            }\n\n            function setCurrentPage(page) {\n                $scope.params.page = page;\n            }\n\n            function loadFeed() {\n                Gallery.feed($scope.params).then(function (data) {\n                    ensureMoreData(data.length);\n                    setCurrentPage($scope.params.page + 1);\n                    setGalleries(data);\n\n                    if ($scope.data.length === 0) {\n                        showEmptyView();\n                    } else {\n                        showGalleries();\n                    }\n\n                    $scope.loading = false;\n                    $scope.$broadcast('scroll.infiniteScrollComplete');\n                    $scope.$broadcast('scroll.refreshComplete');\n\n                }).catch(function () {\n                    if ($scope.data.length === 0) {\n                        showErrorView();\n                    }\n                    isMoreData = false;\n                    $scope.$broadcast('scroll.refreshComplete');\n                });\n            }\n\n            $scope.onLoadMore = function () {\n                loadFeed();\n            };\n\n            $scope.moreDataCanBeLoaded = function () {\n                return isMoreData;\n            };\n\n            $scope.showLoadingView = function () {\n                return isLoadingViewShown;\n            };\n\n            $scope.showGalleries = function () {\n                return isGalleriesViewShown;\n            };\n\n            $scope.showErrorView = function () {\n                return isErrorViewShown;\n            };\n\n            $scope.showEmptyView = function () {\n                return isEmptyViewShown;\n            };\n\n            $scope.onReload = function () {\n                $scope.params.page = 0;\n                $scope.data        = [];\n                showLoading();\n                loadFeed();\n                $scope.$broadcast('scroll.refreshComplete');\n            };\n\n            $rootScope.$on('onUserLogged', $scope.onReload);\n\n            $scope.action = function (gallery) {\n\n                var buttons = [{\n                    text: '<i class=\"icon ion-alert-circled\"></i>' + $translate.instant('reportText')\n                }];\n\n\n                console.log(gallery);\n\n                if (Parse.User.current().id === gallery.user.obj.id) {\n                    var buttonDelete = {\n                        text: '<i class=\"icon ion-trash-b\"></i>' + $translate.instant('deleteGallery')\n                    };\n                    buttons.push(buttonDelete);\n                }\n                var message = {\n                    text : gallery.title,\n                    image: gallery.img\n                };\n\n                var actionSheet = {\n                    buttons      : buttons,\n                    cancelText   : $translate.instant('cancelText'),\n                    buttonClicked: actionButtons\n                };\n\n\n                function actionButtons(index) {\n                    switch (index) {\n                        case 0:\n                            FeedbackModal.modal(gallery.galleryObj);\n                            break;\n                        case 1:\n\n                            $ionicPopup\n                                .confirm({\n                                    title   : $translate.instant('deleteGalleryConfirmText'),\n                                    template: $translate.instant('areSure')\n                                })\n                                .then(function (res) {\n                                    if (res) {\n                                        Gallery.destroy(gallery.galleryObj).then(function () {\n                                            console.log('Photo deleted');\n                                            Toast.alert({\n                                                title: 'Photo',\n                                                text : 'Photo deleted'\n                                            })\n                                            $scope.onReload();\n                                        });\n                                    }\n                                });\n\n\n                    }\n                    return true;\n                }\n\n                // Show the action sheet\n                $ionicActionSheet.show(actionSheet);\n            };\n\n        }\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('profileModalEdit', profileModalEditDirective);\n\n    function profileModalEditDirective($ionicModal, User, Loading, UserForm, $state) {\n\n        return {\n            restrict: 'A',\n            scope   : {\n                user: '='\n            },\n            template: '',\n            link    : function (scope, elem) {\n\n                scope.linkFacebook        = linkFacebook;\n                scope.logout              = logout;\n                scope.submitUpdateProfile = submitUpdateProfile;\n                scope.closeModal          = closeModal;\n\n                elem.bind('click', openModal);\n                function init() {\n                    var user   = Parse.User.current().attributes;\n                    scope.form = {\n                        name    : user.name,\n                        email   : user.email,\n                        status  : user.status,\n                        photo   : user.photo,\n                        username: user.username,\n                        gender  : user.gender,\n                        facebook: user.facebook\n                    };\n                    console.log(scope.form);\n                    scope.formFields = UserForm.profile;\n                }\n\n\n                function openModal() {\n\n                    init();\n                    $ionicModal.fromTemplateUrl('app/directive/profile-edit-modal.html', {\n                        scope: scope\n                    }).then(function (modal) {\n                        scope.modal = modal;\n                        scope.modal.show();\n                    });\n\n                    // Cleanup the modal when we're done with it!\n                    scope.$on('$destroy', function () {\n                        scope.modal.remove();\n                    });\n\n                }\n\n                function logout() {\n                    $state.go('logout');\n                    scope.closeModal();\n                }\n\n                function linkFacebook() {\n                    User.facebookLink().then(function (resp) {\n                        console.log(resp);\n                    });\n                }\n\n                function submitUpdateProfile() {\n                    var dataForm = angular.copy(scope.form);\n                    Loading.start();\n                    User.update(dataForm).then(function (resp) {\n                        console.log(resp);\n                        scope.user = resp;\n                        Loading.end();\n                        scope.closeModal();\n                    });\n                }\n\n                function closeModal() {\n                    scope.modal.hide();\n                }\n\n            }\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').directive('profileModal', profileModalDirective);\n\n    function profileModalDirective($ionicModal, User) {\n\n        return {\n            restrict: 'A',\n            scope   : {\n                username: '='\n            },\n            link    : profileModalLink\n        };\n\n        function profileModalLink(scope, elem) {\n            elem.bind('click', function () {\n\n                console.log(scope.username);\n\n                User.profile(scope.username).then(function (data) {\n                    console.log(data);\n                    scope.user = data;\n                    openModal();\n                });\n\n            });\n\n            function openModal() {\n\n                console.log(scope.user.attributes);\n\n                $ionicModal.fromTemplateUrl('app/directive/profile-modal.html', {\n                    scope: scope\n                }).then(function (modal) {\n                    scope.modalProfile  = modal;\n                    scope.loadingFollow = true;\n                    scope.changeTab     = changeTab;\n                    scope.follow        = follow;\n                    scope.closeModal    = closeModal;\n                    scope.modalProfile.show();\n\n                    changeTab('list');\n\n                    function follow() {\n\n                        scope.loadingFollow = true;\n                        var status;\n\n                        if (scope.user.follow) {\n                            status = false;\n                        } else {\n                            status = true;\n                        }\n\n                        User.follow(scope.user.userObj.id).then(function (resp) {\n                            console.log('Follow result', resp);\n                            scope.user.isFollow = (resp === 'follow') ? true : false;\n                            if (resp == 'follow') {\n                                scope.user.followersTotal += 1;\n                            }\n                            if (resp == 'unfollow') {\n                                scope.user.followersTotal -= 1;\n                            }\n                            scope.loadingFollow = false;\n                        });\n\n\n                    }\n\n                    function closeModal() {\n                        delete scope.data;\n                        scope.modalProfile.hide();\n                    }\n                });\n\n                // Cleanup the modal when we're done with it!\n                scope.$on('$destroy', function () {\n                    scope.modalProfile.remove();\n                });\n            }\n\n            function changeTab(tab) {\n                if (tab === 'list') {\n                    scope.tab = {\n                        list: true,\n                        grid: false\n                    };\n                } else {\n                    scope.tab = {\n                        list: false,\n                        grid: true\n                    };\n                }\n            }\n\n\n        }\n    }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('starter')\n    .directive('ionSearch', ionSearchDirective);\n\n  function ionSearchDirective($timeout) {\n\n    return {\n      restrict   : 'E',\n      scope      : {\n        getData: '&source',\n        ngModel: '=?',\n        search : '=?filter'\n      },\n      templateUrl: 'app/module/photogram/directive/search/search-directive.html',\n      link       : function (scope, element, attrs) {\n        attrs.minLength = attrs.minLength || 0;\n        scope.placeholder = attrs.placeholder || '';\n        scope.clear = function () {\n          console.log('Limpar campo');\n          scope.input = '';\n          scope.$apply();\n        };\n\n        if (attrs.class) {\n          element.addClass(attrs.class);\n        }\n\n        if (attrs.source) {\n          scope.$watch('search.value', watchSearch);\n        }\n\n        function watchSearch(newValue) {\n          if (newValue.length > attrs.minLength) {\n            $timeout(function () {\n              scope\n                .getData({\n                  str: newValue\n                })\n                .then(function (results) {\n                  scope.ngModel = results;\n                });\n            }, 1000);\n          } else {\n            scope.ngModel = [];\n          }\n        }\n\n      }\n\n    };\n  }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('starter')\n        .directive('settingsModal', settingsModalDirective);\n\n    function settingsModalDirective($ionicModal, $translate, AppConfig, $cordovaInAppBrowser, Share, Auth, User, UserForm, $state) {\n\n        return {\n            restrict: 'A',\n            template: '',\n            link    : function (scope, elem) {\n\n                elem.bind('click', openModal);\n                scope.closeModal     = closeModal;\n                scope.link           = link;\n                scope.share          = Share.share;\n\n                scope.logout = function  () {\n                    $state.go(AppConfig.routes.login);\n                    scope.closeModal();\n                };\n\n                function init() {\n                    scope.form       = Auth.getLoggedUser();\n                    scope.formFields = UserForm.profile;\n                    scope.languages  = AppConfig.locales;\n                    scope.language   = $translate.use();\n                }\n\n                function openModal() {\n\n                    init();\n                    $ionicModal.fromTemplateUrl('app/directive/settings-modal.html', {\n                        scope: scope\n                    }).then(function (modal) {\n                        scope.modal = modal;\n                        scope.modal.show();\n                    });\n                }\n\n                function link(sref) {\n                    $state.go(sref);\n                    scope.closeModal();\n                }\n\n                function submitUpdateProfile(form) {\n                    var dataForm = angular.copy(form);\n                    User.update(dataForm).then(function (resp) {\n                        console.log(resp);\n                        init();\n                        scope.closeModal();\n                    });\n                }\n\n                function closeModal() {\n                    scope.modal.hide();\n                    scope.modal.remove();\n                }\n\n            }\n        };\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').directive('usernameValidator', usernameValidatorDirective);\n\n    function usernameValidatorDirective(User) {\n        return {\n            require: 'ngModel',\n            restrict: 'A',\n            link    : usernameValidatorLink,\n        };\n\n        function usernameValidatorLink(scope, elem, attr, ngModel) {\n            ngModel.$asyncValidators.username = function  (modelValue, viewValue) {\n                if(viewValue) {\n                    return User.validateUsername(viewValue);\n                }\n            }\n        }\n    }\n\n})();\n'use strict';\nangular.module(\"ngLocale\", [], [\"$provide\", function ($provide) {\n  var PLURAL_CATEGORY = {\n    ZERO: \"zero\",\n    ONE: \"one\",\n    TWO: \"two\",\n    FEW: \"few\",\n    MANY: \"many\",\n    OTHER: \"other\"\n  };\n  $provide.value(\"$locale\", {\n    \"DATETIME_FORMATS\": {\n      \"AMPMS\": [\n        \"AM\",\n        \"PM\"\n      ],\n      \"DAY\": [\n        \"domingo\",\n        \"segunda-feira\",\n        \"ter\\u00e7a-feira\",\n        \"quarta-feira\",\n        \"quinta-feira\",\n        \"sexta-feira\",\n        \"s\\u00e1bado\"\n      ],\n      \"ERANAMES\": [\n        \"Antes de Cristo\",\n        \"Ano do Senhor\"\n      ],\n      \"ERAS\": [\n        \"a.C.\",\n        \"d.C.\"\n      ],\n      \"FIRSTDAYOFWEEK\": 6,\n      \"MONTH\": [\n        \"janeiro\",\n        \"fevereiro\",\n        \"mar\\u00e7o\",\n        \"abril\",\n        \"maio\",\n        \"junho\",\n        \"julho\",\n        \"agosto\",\n        \"setembro\",\n        \"outubro\",\n        \"novembro\",\n        \"dezembro\"\n      ],\n      \"SHORTDAY\": [\n        \"dom\",\n        \"seg\",\n        \"ter\",\n        \"qua\",\n        \"qui\",\n        \"sex\",\n        \"s\\u00e1b\"\n      ],\n      \"SHORTMONTH\": [\n        \"jan\",\n        \"fev\",\n        \"mar\",\n        \"abr\",\n        \"mai\",\n        \"jun\",\n        \"jul\",\n        \"ago\",\n        \"set\",\n        \"out\",\n        \"nov\",\n        \"dez\"\n      ],\n      \"STANDALONEMONTH\": [\n        \"janeiro\",\n        \"fevereiro\",\n        \"mar\\u00e7o\",\n        \"abril\",\n        \"maio\",\n        \"junho\",\n        \"julho\",\n        \"agosto\",\n        \"setembro\",\n        \"outubro\",\n        \"novembro\",\n        \"dezembro\"\n      ],\n      \"WEEKENDRANGE\": [\n        5,\n        6\n      ],\n      \"fullDate\": \"EEEE, d 'de' MMMM 'de' y\",\n      \"longDate\": \"d 'de' MMMM 'de' y\",\n      \"medium\": \"d 'de' MMM 'de' y HH:mm:ss\",\n      \"mediumDate\": \"d 'de' MMM 'de' y\",\n      \"mediumTime\": \"HH:mm:ss\",\n      \"short\": \"dd/MM/yy HH:mm\",\n      \"shortDate\": \"dd/MM/yy\",\n      \"shortTime\": \"HH:mm\"\n    },\n    \"NUMBER_FORMATS\": {\n      \"CURRENCY_SYM\": \"R$\",\n      \"DECIMAL_SEP\": \",\",\n      \"GROUP_SEP\": \".\",\n      \"PATTERNS\": [{\n        \"gSize\": 3,\n        \"lgSize\": 3,\n        \"maxFrac\": 3,\n        \"minFrac\": 0,\n        \"minInt\": 1,\n        \"negPre\": \"-\",\n        \"negSuf\": \"\",\n        \"posPre\": \"\",\n        \"posSuf\": \"\"\n      }, {\n        \"gSize\": 3,\n        \"lgSize\": 3,\n        \"maxFrac\": 2,\n        \"minFrac\": 2,\n        \"minInt\": 1,\n        \"negPre\": \"-\\u00a4\",\n        \"negSuf\": \"\",\n        \"posPre\": \"\\u00a4\",\n        \"posSuf\": \"\"\n      }]\n    },\n    \"id\": \"pt-br\",\n    \"pluralCat\": function (n, opt_precision) {\n      if (n >= 0 && n <= 2 && n != 2) {\n        return PLURAL_CATEGORY.ONE;\n      }\n      return PLURAL_CATEGORY.OTHER;\n    }\n  });\n}]);\n(function () {\n    'use strict';\n    //! moment.js locale configuration\n//! locale : brazilian portuguese (pt-br)\n//! author : Caio Ribeiro Pereira : https://github.com/caio-ribeiro-pereira\n    \n    var pt_br = window.moment.defineLocale('pt', {\n        months: 'Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro'.split(\n            '_'),\n        monthsShort: 'Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez'.split('_'),\n        weekdays: 'Domingo_Segunda-Feira_Terça-Feira_Quarta-Feira_Quinta-Feira_Sexta-Feira_Sábado'.split('_'),\n        weekdaysShort: 'Dom_Seg_Ter_Qua_Qui_Sex_Sáb'.split('_'),\n        weekdaysMin: 'Dom_2ª_3ª_4ª_5ª_6ª_Sáb'.split('_'),\n        longDateFormat: {\n            LT: 'HH:mm',\n            LTS: 'HH:mm:ss',\n            L: 'DD/MM/YYYY',\n            LL: 'D [de] MMMM [de] YYYY',\n            LLL: 'D [de] MMMM [de] YYYY [às] HH:mm',\n            LLLL: 'dddd, D [de] MMMM [de] YYYY [às] HH:mm'\n        },\n        calendar: {\n            sameDay: '[Hoje às] LT',\n            nextDay: '[Amanhã às] LT',\n            nextWeek: 'dddd [às] LT',\n            lastDay: '[Ontem às] LT',\n            lastWeek: function () {\n                return (this.day() === 0 || this.day() === 6) ?\n                    '[Último] dddd [às] LT' : // Saturday + Sunday\n                    '[Última] dddd [às] LT'; // Monday - Friday\n            },\n            sameElse: 'L'\n        },\n        relativeTime: {\n            future: 'em %s',\n            past: '%s atrás',\n            s: 'segs',\n            m: 'um minuto',\n            mm: '%d minutos',\n            h: 'uma hora',\n            hh: '%d horas',\n            d: 'um dia',\n            dd: '%d dias',\n            M: 'um mês',\n            MM: '%d meses',\n            y: 'um ano',\n            yy: '%d anos'\n        },\n        ordinalParse: /\\d{1,2}º/,\n        ordinal: '%dº'\n    });\n\n    return pt_br;\n})();\n(function () {\n  'use strict';\n  angular\n    .module('starter')\n    .factory('GalleryForm', GalleryFormFactory);\n\n  function GalleryFormFactory($translate) {\n\n    var form = [{\n      key: 'title',\n      type: 'input',\n      templateOptions: {\n        type: 'text',\n        placeholder: $translate.instant('PHOTOGRAM.FORM.TITLE'),\n        icon: 'icon-envelope',\n        required: true,\n        iconPlaceholder: true,\n        focus: true\n      }\n    }, {\n      key: 'geo',\n      type: 'toggle',\n      templateOptions: {\n        label: $translate.instant('PHOTOGRAM.FORM.GEOLOCATION'),\n        toggleClass: 'positive'\n      }\n    }];\n\n    var formComment = [{\n      key: 'text',\n      type: 'input',\n      templateOptions: {\n        placeholder: $translate.instant('addComment'),\n        type: 'text',\n        required: true,\n        focus: true\n          //icon           : 'icon-envelope',\n          //iconPlaceholder: true\n      }\n    }];\n\n    var formShare = [{\n      key: 'facebook',\n      type: 'toggle',\n      templateOptions: {\n        label: 'Facebook',\n        toggleClass: 'positive'\n      }\n    }, {\n      key: 'twitter',\n      type: 'toggle',\n      templateOptions: {\n        label: 'Twitter',\n        toggleClass: 'positive'\n      }\n    }, {\n      key: 'whatsapp',\n      type: 'toggle',\n      templateOptions: {\n        label: 'Whatsapp',\n        toggleClass: 'positive'\n      }\n    }, {\n      key: 'SMS',\n      type: 'toggle',\n      templateOptions: {\n        label: 'SMS',\n        toggleClass: 'positive'\n      }\n    }, {\n      key: 'email',\n      type: 'toggle',\n      templateOptions: {\n        label: 'Email',\n        toggleClass: 'positive'\n      }\n    }, ];\n    return {\n      form: form,\n      formComment: formComment,\n      formShare: formShare\n    };\n  }\n\n\n})();\n\n(function () {\n    'use strict';\n    angular\n        .module('app.main')\n        .factory('UserForm', UserFormFactory);\n\n    function UserFormFactory($translate) {\n\n        return {\n            login   : login(),\n            register: register(),\n            profile : profile()\n        };\n\n        function login() {\n            return [{\n                type           : 'input',\n                key            : 'username',\n                templateOptions: {\n                    type           : 'text',\n                    placeholder    : $translate.instant('username'),\n                    icon           : 'icon-user',\n                    required       : true,\n                    iconPlaceholder: true\n                }\n            }, {\n                type           : 'input',\n                key            : 'password',\n                templateOptions: {\n                    type           : 'password',\n                    placeholder    : $translate.instant('password'),\n                    icon           : 'icon-lock',\n                    required       : true,\n                    iconPlaceholder: true\n                }\n            }];\n        }\n\n        function register() {\n            return [\n                {\n                    type           : 'input',\n                    key            : 'username',\n                    templateOptions: {\n                        type           : 'text',\n                        placeholder    : $translate.instant('username'),\n                        icon           : 'icon-user',\n                        required       : true,\n                        iconPlaceholder: true\n                    }\n                },\n                {\n                    type           : 'input',\n                    key            : 'email',\n                    templateOptions: {\n                        type           : 'email',\n                        placeholder    : $translate.instant('email'),\n                        icon           : 'icon-envelope',\n                        required       : true,\n                        iconPlaceholder: true\n                    }\n                },\n                {\n                    type           : 'input',\n                    key            : 'password',\n                    templateOptions: {\n                        type           : 'password',\n                        placeholder    : $translate.instant('password'),\n                        icon           : 'icon-lock',\n                        required       : true,\n                        iconPlaceholder: true\n                    }\n                }];\n        }\n\n        function profile() {\n            return [\n                {\n                    key            : 'username',\n                    type           : 'input',\n                    templateOptions: {\n                        type           : 'text',\n                        placeholder    : $translate.instant('username'),\n                        icon           : 'icon-ios-at',\n                        required       : true,\n                        iconPlaceholder: true\n                    }\n                },\n                {\n                    key            : 'name',\n                    type           : 'input',\n                    templateOptions: {\n                        type           : 'text',\n                        placeholder    : $translate.instant('name'),\n                        icon           : 'icon-user',\n                        required       : true,\n                        iconPlaceholder: true\n                    }\n                }, {\n                    key            : 'status',\n                    type           : 'input',\n                    templateOptions: {\n                        type           : 'text',\n                        placeholder    : $translate.instant('status'),\n                        icon           : 'ion-quote',\n                        required       : true,\n                        iconPlaceholder: true\n                    }\n                }, {\n                    type           : 'select',\n                    key            : 'gender',\n                    templateOptions: {\n                        label          : $translate.instant('gender'),\n                        options        : [{\n                            'label': $translate.instant('man'),\n                            'id'   : 'male',\n                        }, {\n                            'label': $translate.instant('woman'),\n                            'id'   : 'female',\n                        }],\n                        valueProp      : 'id',\n                        labelProp      : 'label',\n                        //icon           : 'ion-ios-body-outline',\n                        //iconPlaceholder: true\n                    }\n                }];\n        }\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('ActionSheet', ActionSheetFactory);\n\n    function ActionSheetFactory($ionicActionSheet, Camera, $cordovaActionSheet, $q) {\n\n        return {\n            show : show,\n            image: image\n        };\n\n        function image() {\n            var defer = $q.defer();\n            show({\n                title     : 'Choose an option',\n                cancelText: 'Cancel',\n                options   : [{text: 'Photo Library'}, {text: 'Photo'}]\n            }).then(function (option) {\n                var sourceType;\n                if (option === 1) {\n                    sourceType = 'photoLibrary';\n                }\n\n                if (option === 2) {\n                    sourceType = 'camera';\n                }\n                return Camera.getPicture({sourceType: sourceType});\n            }).then(defer.resolve).catch(defer.reject);\n\n            return defer.promise;\n        }\n\n        function show(params) {\n\n            var defer = $q.defer();\n\n            if (window.cordova) {\n\n                var options = {\n                    title                    : params.title,\n                    buttonLabels             : _.map(params.options, function (item) {return item.text}),\n                    addCancelButtonWithLabel : params.cancelText,\n                    androidEnableCancelButton: true,\n                    androidTheme             : window.plugins.actionsheet.ANDROID_THEMES.THEME_HOLO_LIGHT\n                };\n\n                $cordovaActionSheet.show(options).then(function (btnIndex) {\n                    if (btnIndex !== 3) {\n                        defer.resolve(btnIndex);\n                    }\n                    defer.reject('cancel');\n                });\n\n            } else {\n                var actionSheet = $ionicActionSheet.show({\n                    buttons      : params.options,\n                    titleText    : params.title,\n                    cancelText   : params.cancelText,\n                    cancel       : function () {\n                        actionSheet();\n                    },\n                    buttonClicked: function (btnIndex) {\n                        actionSheet();\n                        if (btnIndex !== 3) {\n                            defer.resolve(btnIndex);\n                        }\n                        defer.reject('cancel');\n                    }\n                });\n\n            }\n            return defer.promise;\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('Auth', function ($q) {\n\n        var mSessionToken = null;\n        return {\n            getLoggedUser  : getLoggedUser,\n            setSessionToken: setSessionToken,\n            ensureLoggedIn : ensureLoggedIn,\n            recoverPassword: recoverPassword,\n            resetPassword  : resetPassword,\n            logIn          : logIn,\n            logOut         : logOut\n        };\n\n        function getLoggedUser() {\n            return Parse.User.current();\n        }\n\n        function setSessionToken(sessionToken) {\n            mSessionToken = sessionToken;\n        }\n\n        function ensureLoggedIn() {\n            var defer = $q.defer();\n\n            if (mSessionToken === null) {\n                defer.reject('Session token invalid');\n                return defer.promise;\n            }\n\n            if (!Parse.User.current()) {\n                Parse.User.become(mSessionToken).then(defer.resolve, defer.reject);\n            } else {\n                defer.resolve(Parse.User.current());\n            }\n\n            return defer.promise;\n        }\n\n        function recoverPassword(email) {\n            var defer = $q.defer();\n            Parse.User.requestPasswordReset(email, {\n                success: defer.resolve,\n                error  : defer.reject\n            });\n\n            return defer.promise;\n        }\n\n        function resetPassword(email) {\n\n            var defer = $q.defer();\n\n            Parse.User.requestPasswordReset(email, {\n                success: defer.resolve,\n                error  : defer.reject\n            });\n\n            return defer.promise;\n        }\n\n        function logIn(obj) {\n            var defer = $q.defer();\n\n            Parse.User.logIn(obj.username, obj.password, {\n                success: defer.resolve,\n                error  : defer.reject\n            });\n\n            return defer.promise;\n        }\n\n        function logOut() {\n            var defer = $q.defer();\n            Parse.User.logOut().then(defer.resolve, defer.reject);\n            return defer.promise;\n        }\n\n\n    });\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').service('Camera', CameraFactory);\n\n    function CameraFactory($cordovaCamera, $q) {\n\n        return {\n            getPicture   : getPicture,\n            resizeImage  : resizeImage,\n            toBase64Image: toBase64Image\n        };\n\n        function getPicture(params) {\n\n            var defer = $q.defer();\n            if (window.cordova) {\n                var sourceType = params.sourceType || Camera.PictureSourceType.CAMERA;\n                if (params.sourceType === 'photoLibrary') {\n                    sourceType = Camera.PictureSourceType.PHOTOLIBRARY;\n                }\n                if (params.sourceType === 'camera') {\n                    sourceType = Camera.PictureSourceType.CAMERA;\n                }\n\n                var options = {\n                    quality           : 70,\n                    targetWidth       : 800,\n                    targetHeight      : 800,\n                    saveToPhotoAlbum  : false,\n                    correctOrientation: true,\n                    sourceType        : sourceType,\n                    destinationType   : Camera.DestinationType.DATA_URL,\n                    encodingType      : Camera.EncodingType.JPEG,\n                };\n\n                $cordovaCamera.getPicture(options).then(defer.resolve, defer.reject);\n            } else {\n                console.log('Input File');\n                //defer.reject('Unsupported platform');\n\n                var fileInput = angular.element('<input type=\"file\" accept=\"image/x-png, image/gif, image/jpeg\" max-size=\"2048\" />');\n                fileInput[0].click();\n                fileInput.on('change', function (evt) {\n                    var tempImage = evt.currentTarget.files[0];\n                    var reader    = new FileReader();\n                    reader.onload = function (evt) {\n                        defer.resolve(evt.target.result);\n                    };\n                    reader.readAsDataURL(tempImage);\n                });\n            }\n\n            return defer.promise;\n        }\n\n        //https://github.com/timkalinowski/PhoneGap-Image-Resizer\n        function toBase64Image(img_path, width, height) {\n            var defer = $q.defer();\n            window.imageResizer.resizeImage(defer.resolve, defer.reject, img_path, width || 1, height || 1, {\n                imageDataType: ImageResizer.IMAGE_DATA_TYPE_URL,\n                resizeType   : ImageResizer.RESIZE_TYPE_FACTOR,\n                format       : 'jpg'\n            });\n\n            return defer.promise;\n        }\n\n        function resizeImage(img_path, width, height) {\n            var defer = $q.defer();\n            window.imageResizer.resizeImage(defer.resolve, defer.reject,  img_path, width || 640, height || 640, {\n                imageDataType: ImageResizer.IMAGE_DATA_TYPE_URL,\n                resizeType   : ImageResizer.RESIZE_TYPE_MIN_PIXEL,\n                pixelDensity : true,\n                storeImage   : false,\n                photoAlbum   : false,\n                format       : 'jpg'\n            });\n\n            return defer.promise;\n        }\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular\n        .module('starter')\n        .factory('ConnectMonitor', ConnectMonitorFactory);\n\n    function ConnectMonitorFactory($rootScope, $cordovaNetwork) {\n        \n        return {\n            watch: watch\n        };\n\n        function watch() {\n\n            if (ionic.Platform.isWebView()) {\n                $rootScope.onLine = $cordovaNetwork.isOnline();\n                $rootScope.$apply();\n\n\n                $rootScope.$on('$cordovaNetwork:online', function (event, networkState) {\n                    console.log('went online');\n                    $rootScope.onLine = true;\n                    $rootScope.$apply();\n                });\n\n                $rootScope.$on('$cordovaNetwork:offline', function (event, networkState) {\n                    console.log('went offline');\n                    $rootScope.onLine = false;\n                    $rootScope.$apply();\n                });\n            } else {\n                $rootScope.onLine = navigator.onLine;\n                $rootScope.$apply();\n\n                window.addEventListener('online', function (e) {\n                    console.log('went online');\n                    $rootScope.onLine = true;\n                    $rootScope.$apply();\n                }, false);\n\n                window.addEventListener('offline', function (e) {\n                    console.log('went offline');\n                    $rootScope.onLine = false;\n                    $rootScope.$apply();\n                }, false);\n            }\n        }\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular\n        .module('starter')\n        .factory('DAO', DAOFactory);\n    function DAOFactory($interval, $q) {\n        var _db;\n        var _tables = [];\n\n        return {\n            init       : init,\n            insert     : insert,\n            query      : query,\n            getLastSync: getLastSync,\n            paginate   : paginate,\n            fetchAll   : fetchAll\n        };\n\n        function init(database) {\n\n            if (!_db) {\n                if (window.sqlitePlugin !== undefined) {\n                    _db = window.sqlitePlugin.openDatabase({\n                        name              : database.name,\n                        location          : 2,\n                        createFromLocation: 1\n                    });\n                } else {\n                    // For debugging in the browser\n                    _db = window.openDatabase(database.name, \"1.0\", \"Database\", 200000);\n                }\n            }\n\n            var _promises = [];\n            angular.forEach(database.tables, function (table) {\n                var columns = [];\n                angular.forEach(table.columns, function (type, name) {\n                    columns.push(name + ' ' + type);\n                });\n                query('DROP TABLE ' + table.name);\n                var _query = 'CREATE TABLE IF NOT EXISTS ' + table.name + ' (' + columns.join(',') + ')';\n                _promises.push(query(_query));\n                _tables.push(table);\n                // console.log(_query);\n                // console.log('Table ' + table.name + ' initialized');\n            });\n\n            return $q.all(_promises);\n        }\n\n        function getLastSync(table, column) {\n            var defer = $q.defer();\n            query(\"SELECT MAX(\" + column + \") as lastSync FROM \" + table)\n                .then(function (data) {\n                    var lastSync = data.rows.item[0].lastSync;\n                    defer.resolve(lastSync);\n                });\n            return defer.promise;\n        }\n\n        function insert(obj) {\n            var defer    = $q.defer();\n            var _columns = [];\n            var _values  = [];\n\n            angular.forEach(obj.columns, function (value, key) {\n                _columns.push(key);\n                if (typeof  value === 'number') {\n                    _values.push(value);\n                } else {\n                    _values.push(\"'\" + value + \"'\");\n                }\n            });\n\n            var _query = \"INSERT OR REPLACE INTO \" + obj.table + \" (\" + _columns.join(',') + \") VALUES (\" + _values.join(',') + \")\"\n            // console.info(_query);\n            query(_query).then(defer.resolve).catch(defer.reject);\n            return defer.promise;\n\n        }\n\n        function query(query, bindings) {\n            bindings  = typeof bindings !== 'undefined' ? bindings : [];\n            var defer = $q.defer();\n\n            _db.transaction(function (transaction) {\n                transaction.executeSql(query, bindings, function (transaction, result) {\n                    // console.log(result);\n                    var results = {\n                        rows: []\n                    };\n                    if (result && result.rows) {\n                        for (var i = 0; i < result.rows.length; i++) {\n                            results.rows.push(angular.copy(result.rows[i]));\n                        }\n                    }\n                    // console.log(results);\n                    defer.resolve(results);\n                }, function (transaction, error) {\n                    console.log(transaction, error);\n                    defer.reject(error);\n                });\n            });\n\n            return defer.promise;\n        }\n\n        function paginate(_table, columns, _where, _join, _order, limit, page) {\n            var defer = $q.defer();\n            if (page === undefined) page = -1;\n            var _columns = columns;\n            var _limit   = limit ? limit : 10;\n            var _query1  = \"SELECT SUM(id) as TOTAL FROM \" + _table + \"  \" + _where;\n            var _query   = \"SELECT \" + _columns + \" FROM \" + _table + \"  \" + _where + \" \" + _join + \" \" + _order + \" LIMIT \" + _limit + \" OFFSET \" + page;\n\n            console.log('query', _query1);\n            console.log('query', _query);\n\n            query(_query1).then(function (data) {\n                var result = {\n                    page : page,\n                    total: data.rows[0].TOTAL,\n                    rows : []\n                };\n\n                query(_query).then(function (data) {\n                    console.log(data);\n\n                    result.rows = data.rows;\n                    defer.resolve(result);\n                });\n            });\n            return defer.promise;\n        }\n\n        function fetchAll(result) {\n            var output = [];\n            for (var i = 0; i < result.rows.length; i++) {\n                output.push(result.rows.item(i));\n            }\n            return output;\n        }\n    }\n})();\n\n(function () {\n    'use strict';\n    angular\n        .module('starter')\n        .factory('DataUtil', DataUtilFactory);\n\n    function DataUtilFactory() {\n\n        return {\n            parseData: parseData,\n            parseString: parseString,\n            getDate: getDate,\n            formatDate: formatDate,\n            getMonthName: getMonthName,\n            getFirstDay: getFirstDay,\n            getLastDay: getLastDay\n        };\n\n        function parseData(string) {\n            var parts = string.split('-');\n            return new Date(parts[0], parts[1] - 1, parts[2]);\n        }\n\n        function parseString(data) {\n            return new Date(data).toLocaleDateString();\n        }\n\n\n        function getDate() {\n            var data   = new Date();\n            var inicio = \"00\";\n            var year   = data.getFullYear();\n            var month  = (inicio + (data.getMonth() + 1)).slice(-inicio.length);\n            var day    = (inicio + (data.getDate())).slice(-inicio.length);\n            return year + '-' + month + '-' + day;\n        }\n\n        function formatDate(milliseconds) {\n            var data   = new Date(milliseconds);\n            var inicio = \"00\";\n            var year   = data.getFullYear();\n            var month  = (inicio + (data.getMonth() + 1)).slice(-inicio.length);\n            var day    = (inicio + (data.getDate())).slice(-inicio.length);\n            return year + '-' + month + '-' + day;\n        }\n\n        function getMonthName(data) {\n            var meses = ['Janeiro', 'Feveiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];\n            return meses[data.getMonth()];\n        }\n\n        function getFirstDay(data) {\n            var year  = data.getFullYear();\n            var month = data.getMonth();\n            return new Date(year, month, 1);\n        }\n\n        function getLastDay(data) {\n            var year  = data.getFullYear();\n            var month = data.getMonth() + 1;\n            return new Date(year, month, 0);\n        }\n\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').service('Dialog', DialogFactory);\n\n    function DialogFactory($cordovaDialogs, $ionicPopup, $q) {\n\n        return {\n            alert  : alert,\n            confirm: confirm\n        };\n\n        function alert(message, title) {\n            var defer = $q.defer();\n            if (window.cordova) {\n                $cordovaDialogs.alert(message, title).then(defer.resolve);\n            } else {\n                $ionicPopup.alert({\n                    title   : title,\n                    template: message\n                });\n            }\n            return defer.promise;\n        }\n\n        function confirm(message, title, buttonsText) {\n            var defer = $q.defer();\n            if (window.cordova) {\n                $cordovaDialogs.confirm(message, title, buttonsText).then(function (result) {\n                    if (result === 2) {\n                        defer.resolve(true);\n                    }\n                    defer.reject(true);\n                });\n\n            } else {\n                $ionicPopup.confirm({\n                    title   : title,\n                    template: message\n                }).then(function (res) {\n                    if (res) {\n                        defer.resolve(true);\n                    } else {\n                        defer.reject(true);\n                    }\n                });\n            }\n            return defer.promise;\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').service('Facebook', FacebookFactory);\n\n    function FacebookFactory($q, $facebook, $cordovaFacebook) {\n\n        var facebook = window.cordova ? $cordovaFacebook : $facebook;\n\n        return {\n            getCurrentUser: getCurrentUser,\n            logIn         : logIn,\n            logOut        : logOut,\n            me            : me,\n            invite        : invite,\n            friends       : friends,\n            api           : api,\n            link          : link\n        };\n\n        function getCurrentUser() {\n            return facebook.getLoginStatus();\n        }\n\n        function logIn() {\n            return facebook.login(['public_profile', 'email']);\n        }\n\n        function logOut() {\n            var defer = $q.defer();\n            $cordovaFacebook.logout().then(defer.resolve, defer.reject);\n            return defer.promise;\n        }\n\n        function me() {\n\n            var defer = $q.defer();\n\n            if (window.cordova) {\n\n                $cordovaFacebook.api('me?fields=name,first_name,last_name,gender,email', ['public_profile'])\n                                .then(defer.resolve, defer.reject);\n\n            } else {\n                facebook.api('/me', {fields: 'name, first_name, last_name, gender, email'})\n                        .then(function (response) {\n                            if (!response || response.error) {\n                                defer.reject(response.error);\n                            } else {\n                                defer.resolve(response);\n                            }\n                        });\n            }\n\n            return defer.promise;\n        }\n\n        function invite() {\n            var defer = $q.defer();\n            if (window.cordova) {\n                facebook.showDialog({\n                    method : 'apprequests',\n                    message: 'Venha para o nosso clube!'\n                }).then(defer.resolve, defer.reject);\n            } else {\n                facebook.ui({\n                    method : 'apprequests',\n                    message: 'Venha para o nosso clube!'\n                }).then(defer.resolve, defer.reject);\n            }\n            return defer.promise;\n        }\n\n\n        function friends() {\n            var defer = $q.defer();\n            facebook.api('me/friends').then(defer.resolve, defer.reject);\n            return defer.promise;\n        }\n\n        function api(api) {\n            var defer = $q.defer();\n            facebook.api(api).then(defer.resolve, defer.reject);\n            return defer.promise;\n        }\n\n        function link(user) {\n            var defer = $q.defer();\n            if (user) {\n                facebook.login(['email']).then(function (response) {\n                    console.log('facebook login', response);\n                    //Pega o Status do Login\n                    var data = new Date(new Date().getTime() + response['authResponse']['expiresIn'] * 1000);\n\n                    console.log(user, response, data);\n\n                    Parse.FacebookUtils.link(user, {\n                        id             : response['authResponse']['userID'],\n                        access_token   : response['authResponse']['accessToken'],\n                        expiration_date: data\n                    }, {\n                        success: function (user) {\n                            // Função caso tenha logado tanto no face quanto no Parse\n                            console.log('User', user);\n                            user.set('facebook', response['authResponse']['userID']);\n                            user.set('facebookimg', 'https://graph.facebook.com/' + response['authResponse']['userID'] + '/picture?width=250&height=250');\n                            user.set('facebook_complete', Boolean(true));\n                            user.save().then(defer.resolve);\n                        }\n                    });\n                }, defer.resolve);\n            } else {\n                defer.reject('not logged');\n            }\n\n            return defer.promise;\n        }\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('GalleryActivity', function ($q, ParseCloud, moment) {\n\n        var ParseObject = Parse.Object.extend('GalleryActivity', {\n            getStatus: function () {\n                if (this.isApproved) {\n                    return 'Approved';\n                } else if (this.isApproved === false) {\n                    return 'Rejected';\n                } else {\n                    return 'Pending';\n                }\n            }\n        }, {\n            update : function (item) {\n                var defer = $q.defer();\n                item.save(null, {\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            destroy: function (item) {\n                var defer = $q.defer();\n                item.destroy({\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            feed   : function (params) {\n                return ParseCloud.run('feedActivity', params);\n            },\n            all    : function (params) {\n                var defer = $q.defer();\n                var query = new Parse.Query(this);\n\n                if (params.filter != '') {\n                    query.contains('words', params.filter);\n                }\n\n                // Order Table\n                if (params.order) {\n                    if (params.order.indexOf('-') < -1) {\n                        query.ascending(params.order);\n                    } else {\n                        query.descending(params.order.replace('-'));\n                    }\n                }\n\n                if (params.date && params.date !== null) {\n                    var start = moment(params.date).startOf('day');\n                    var end   = moment(params.date).endOf('day');\n                    query.greaterThanOrEqualTo('createdAt', start.toDate());\n                    query.lessThanOrEqualTo('createdAt', end.toDate());\n                }\n\n                if (params.status && params.status !== null) {\n\n                    if (params.status === 'pending') {\n                        query.doesNotExist('isApproved');\n                    } else if (params.status === 'rejected') {\n                        query.equalTo('isApproved', false);\n                    } else if (params.status === 'approved') {\n                        query.equalTo('isApproved', true);\n                    }\n\n                }\n\n                query.include('gallery')\n                query.include('user')\n                query.limit(params.limit);\n                query.skip((params.page * params.limit) - params.limit);\n                query.find({\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n\n                return defer.promise;\n            },\n            count  : function (params) {\n                var defer = $q.defer();\n                var query = new Parse.Query(this);\n\n                if (params.filter != '') {\n                    query.contains('words', params.filter);\n                }\n\n\n                if (params.date && params.date !== null) {\n                    var start = moment(params.date).startOf('day');\n                    var end   = moment(params.date).endOf('day');\n                    query.greaterThanOrEqualTo('createdAt', start.toDate());\n                    query.lessThanOrEqualTo('createdAt', end.toDate());\n                }\n\n                if (params.status && params.status !== null) {\n\n                    if (params.status === 'pending') {\n                        query.doesNotExist('isApproved');\n                    } else if (params.status === 'rejected') {\n                        query.equalTo('isApproved', false);\n                    } else if (params.status === 'approved') {\n                        query.equalTo('isApproved', true);\n                    }\n                }\n\n                query.count({\n                    success: function (count) {\n                        defer.resolve(count);\n                    },\n                    error  : function (error) {\n                        defer.reject(error);\n                    }\n                });\n\n                return defer.promise;\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'fromUser', {\n            get: function () {\n                return this.get('fromUser');\n            },\n            set: function (value) {\n                this.set('fromUser', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'toUser', {\n            get: function () {\n                return this.get('toUser');\n            },\n            set: function (value) {\n                this.set('toUser', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'gallery', {\n            get: function () {\n                return this.get('gallery');\n            },\n            set: function (value) {\n                this.set('gallery', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'title', {\n            get: function () {\n                return this.get('title');\n            },\n            set: function (value) {\n                this.set('title', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'hashtags', {\n            get: function () {\n                return this.get('hashtags');\n            },\n            set: function (value) {\n                this.set('hashtags', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'words', {\n            get: function () {\n                return this.get('words');\n            },\n            set: function (value) {\n                this.set('words', value);\n            }\n        });\n\n\n        Object.defineProperty(ParseObject.prototype, 'address', {\n            get: function () {\n                return this.get('address');\n            },\n            set: function (value) {\n                this.set('address', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'image', {\n            get: function () {\n                return this.get('image');\n            },\n            set: function (value) {\n                this.set('image', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'imageThumb', {\n            get: function () {\n                return this.get('imageThumb');\n            },\n            set: function (value) {\n                this.set('imageThumb', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'location', {\n            get: function () {\n                return this.get('location');\n            },\n            set: function (val) {\n                this.set('location', new Parse.GeoPoint({\n                    latitude : val.latitude,\n                    longitude: val.longitude\n                }));\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'isApproved', {\n            get: function () {\n                return this.get('isApproved');\n            },\n            set: function (value) {\n                this.set('isApproved', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'expiresAt', {\n            get: function () {\n                return this.get('expiresAt');\n            },\n            set: function (value) {\n                this.set('expiresAt', value);\n            }\n        });\n\n        return ParseObject;\n\n    });\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('GalleryComment', function ($q, moment) {\n\n        var ParseObject = Parse.Object.extend('GalleryComment', {\n            getStatus: function () {\n                if (this.isApproved) {\n                    return 'Approved';\n                } else if (this.isApproved === false) {\n                    return 'Rejected';\n                } else {\n                    return 'Pending';\n                }\n            }\n        }, {\n            get        : function (itemId) {\n                var defer = $q.defer();\n                new Parse.Query(this)\n                    .get(itemId, {\n                        success: defer.resolve,\n                        error  : defer.reject\n                    });\n\n                return defer.promise;\n            },\n            create : function (item) {\n                var defer = $q.defer();\n                new ParseObject().save(item, {\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            update : function (item) {\n                var defer = $q.defer();\n                item.save(null, {\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            destroy: function (item) {\n                var defer = $q.defer();\n                item.destroy({\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            all    : function (params) {\n                var defer = $q.defer();\n                var query = new Parse.Query(this);\n\n                // Order Table\n\n                query.include('user');\n                query.ascending('createdAt');\n                query.equalTo('gallery', params.gallery);\n                query.limit(params.limit);\n                query.skip((params.page * params.limit) - params.limit);\n                query.find({\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n\n                return defer.promise;\n            },\n            count  : function (params) {\n                var defer = $q.defer();\n                var query = new Parse.Query(this);\n\n                if (params.filter != '') {\n                    query.contains('words', params.filter);\n                }\n\n\n                if (params.date && params.date !== null) {\n                    var start = moment(params.date).startOf('day');\n                    var end   = moment(params.date).endOf('day');\n                    query.greaterThanOrEqualTo('createdAt', start.toDate());\n                    query.lessThanOrEqualTo('createdAt', end.toDate());\n                }\n\n                if (params.status && params.status !== null) {\n\n                    if (params.status === 'pending') {\n                        query.doesNotExist('isApproved');\n                    } else if (params.status === 'rejected') {\n                        query.equalTo('isApproved', false);\n                    } else if (params.status === 'approved') {\n                        query.equalTo('isApproved', true);\n                    }\n                }\n\n                query.count({\n                    success: function (count) {\n                        defer.resolve(count);\n                    },\n                    error  : function (error) {\n                        defer.reject(error);\n                    }\n                });\n\n                return defer.promise;\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'user', {\n            get: function () {\n                return this.get('user');\n            },\n            set: function (value) {\n                this.set('user', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'text', {\n            get: function () {\n                return this.get('text');\n            },\n            set: function (value) {\n                this.set('text', value);\n            }\n        });\n\n        return ParseObject;\n\n    });\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('Gallery', GalleryFactory);\n\n    function GalleryFactory($q, ParseCloud, moment) {\n\n        var ParseObject = Parse.Object.extend('Gallery', {\n                getStatus: function () {\n                    if (this.isApproved) {\n                        return 'Approved';\n                    } else if (this.isApproved === false) {\n                        return 'Rejected';\n                    } else {\n                        return 'Pending';\n                    }\n                }\n            },\n            {\n                create     : function (item) {\n                    var defer    = $q.defer();\n                    var objPlace = new ParseObject();\n\n                    if (item.address.geo) {\n                        item.location = new Parse.GeoPoint(item.address.geo);\n                    }\n\n                    objPlace.save(item, {\n                        success: defer.resolve,\n                        error  : defer.reject\n                    });\n\n                    return defer.promise;\n                },\n                update     : function (item) {\n                    var defer = $q.defer();\n                    item.save(null, {\n                        success: defer.resolve,\n                        error  : defer.reject\n                    });\n                    return defer.promise;\n                },\n                destroy    : function (item) {\n                    var defer = $q.defer();\n                    item.destroy({\n                        success: defer.resolve,\n                        error  : defer.reject\n                    });\n                    return defer.promise;\n                },\n                comments   : function (params) {\n                    return ParseCloud.run('commentGallery', params);\n                },\n                feed       : function (params) {\n                    return ParseCloud.run('feedGallery', params);\n                },\n                follow     : function (params) {\n                    console.log('Follow', params);\n                    return ParseCloud.run('followUser', params);\n                },\n                likeGallery: function (params) {\n                    console.log(params);\n                    return ParseCloud.run('likeGallery', {galleryId: params.galleryId});\n                },\n                get        : function (galleryId) {\n                    var defer = $q.defer();\n                    new Parse.Query(this)\n\n                        .get(galleryId, {\n                            success: defer.resolve,\n                            error  : defer.reject\n                        });\n\n                    return defer.promise;\n                },\n                all        : function (params) {\n                    var defer = $q.defer();\n                    var query = new Parse.Query(this);\n\n                    //if (params.filter != '') {\n                    //    query.contains('words', params.filter);\n                    //}\n\n                    // Order Table\n                    if (params.order) {\n                        if (params.order.indexOf('-') < -1) {\n                            query.ascending(params.order);\n                        } else {\n                            query.descending(params.order.replace('-'));\n                        }\n                    }\n\n                    // Status\n                    if (params.status && params.status !== null) {\n                        if (params.status === 'pending') {\n                            query.doesNotExist('isApproved');\n                        } else if (params.status === 'rejected') {\n                            query.equalTo('isApproved', false);\n                        } else if (params.status === 'approved') {\n                            query.equalTo('isApproved', true);\n                        }\n                    }\n\n                    // Limit by page\n                    query.limit(params.limit);\n\n                    // Paginate\n                    query.skip((params.page * params.limit) - params.limit);\n                    query.find({\n                        success: defer.resolve,\n                        error  : defer.reject\n                    });\n\n                    return defer.promise;\n                },\n                count      : function (params) {\n                    var defer = $q.defer();\n                    var query = new Parse.Query(this);\n\n                    if (params.filter != '') {\n                        query.contains('words', params.filter);\n                    }\n\n                    if (params.date && params.date !== null) {\n                        var start = moment(params.date).startOf('day');\n                        var end   = moment(params.date).endOf('day');\n                        query.greaterThanOrEqualTo('createdAt', start.toDate());\n                        query.lessThanOrEqualTo('createdAt', end.toDate());\n                    }\n\n                    if (params.status && params.status !== null) {\n\n                        if (params.status === 'pending') {\n                            query.doesNotExist('isApproved');\n                        } else if (params.status === 'rejected') {\n                            query.equalTo('isApproved', false);\n                        } else if (params.status === 'approved') {\n                            query.equalTo('isApproved', true);\n                        }\n                    }\n\n                    query.count({\n                        success: function (count) {\n                            defer.resolve(count);\n                        },\n                        error  : function (error) {\n                            defer.reject(error);\n                        }\n                    });\n\n                    return defer.promise;\n                }\n            });\n\n        Object.defineProperty(ParseObject.prototype, 'likesTotal', {\n            get: function () {\n                return this.get('likesTotal');\n            },\n            set: function (value) {\n                this.set('likesTotal', value);\n            }\n        });\n        Object.defineProperty(ParseObject.prototype, 'user', {\n            get: function () {\n                return this.get('user');\n            },\n            set: function (value) {\n                this.set('user', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'title', {\n            get: function () {\n                return this.get('title');\n            },\n            set: function (value) {\n                this.set('title', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'hashtags', {\n            get: function () {\n                return this.get('hashtags');\n            },\n            set: function (value) {\n                this.set('hashtags', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'words', {\n            get: function () {\n                return this.get('words');\n            },\n            set: function (value) {\n                this.set('words', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'location', {\n            get: function () {\n                return this.get('location');\n            },\n            set: function (val) {\n                this.set('location', new Parse.GeoPoint({\n                    latitude : val.latitude,\n                    longitude: val.longitude\n                }));\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'address', {\n            get: function () {\n                return this.get('address');\n            },\n            set: function (value) {\n                this.set('address', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'image', {\n            get: function () {\n                return this.get('image');\n            },\n            set: function (value) {\n                this.set('image', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'icon', {\n            get: function () {\n                return this.get('icon');\n            },\n            set: function (value) {\n                this.set('icon', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'imageThumb', {\n            get: function () {\n                return this.get('imageThumb');\n            },\n            set: function (value) {\n                this.set('imageThumb', value);\n            }\n        });\n\n\n        Object.defineProperty(ParseObject.prototype, 'isApproved', {\n            get: function () {\n                return this.get('isApproved');\n            },\n            set: function (value) {\n                this.set('isApproved', value);\n            }\n        });\n\n        Object.defineProperty(ParseObject.prototype, 'expiresAt', {\n            get: function () {\n                return this.get('expiresAt');\n            },\n            set: function (value) {\n                this.set('expiresAt', value);\n            }\n        });\n\n        return ParseObject;\n\n    }\n\n})();\n\n(function () {\n  'use strict';\n  angular.module('starter').factory('GalleryFeedback', function ($q, moment) {\n\n    var ParseObject = Parse.Object.extend('GalleryFeedback', {\n      getStatus: function () {\n        if (this.isApproved) {\n          return 'Approved';\n        } else if (this.isApproved === false) {\n          return 'Rejected';\n        } else {\n          return 'Pending';\n        }\n      }\n    }, {\n      create : function (item) {\n        var defer    = $q.defer();\n        var objPlace = new ParseObject();\n        item.user    = Parse.User.current();\n        objPlace.save(item, {\n          success: defer.resolve,\n          error  : defer.reject\n        });\n\n        return defer.promise;\n      },\n      update : function (item) {\n        var defer = $q.defer();\n        item.save(null, {\n          success: defer.resolve,\n          error  : defer.reject\n        });\n        return defer.promise;\n      },\n      destroy: function (item) {\n        var defer = $q.defer();\n        item.destroy({\n          success: defer.resolve,\n          error  : defer.reject\n        });\n        return defer.promise;\n      },\n      all    : function (params) {\n        var defer = $q.defer();\n        var query = new Parse.Query(this);\n\n        if (params.filter != '') {\n          query.contains('words', params.filter);\n        }\n\n        if (params.date && params.date !== null) {\n          var start = moment(params.date).startOf('day');\n          var end   = moment(params.date).endOf('day');\n          query.greaterThanOrEqualTo('createdAt', start.toDate());\n          query.lessThanOrEqualTo('createdAt', end.toDate());\n        }\n\n        if (params.status && params.status !== null) {\n\n          if (params.status === 'pending') {\n            query.doesNotExist('isApproved');\n          } else if (params.status === 'rejected') {\n            query.equalTo('isApproved', false);\n          } else if (params.status === 'approved') {\n            query.equalTo('isApproved', true);\n          }\n\n        }\n\n        query.include('gallery')\n        query.include('User')\n        query.descending('createdAt');\n        query.limit(params.limit);\n        query.skip((params.page * params.limit) - params.limit);\n        query.find({\n          success: defer.resolve,\n          error  : defer.reject\n        });\n\n        return defer.promise;\n      },\n      count  : function (params) {\n        var defer = $q.defer();\n        var query = new Parse.Query(this);\n\n        if (params.filter != '') {\n          query.contains('words', params.filter);\n        }\n\n        if (params.date && params.date !== null) {\n          var start = moment(params.date).startOf('day');\n          var end   = moment(params.date).endOf('day');\n          query.greaterThanOrEqualTo('createdAt', start.toDate());\n          query.lessThanOrEqualTo('createdAt', end.toDate());\n        }\n\n        // Order Table\n        if (params.order) {\n          if (params.order.indexOf('-') < -1) {\n            query.ascending(params.order);\n          } else {\n            query.descending(params.order.replace('-'));\n          }\n        }\n\n        if (params.status && params.status !== null) {\n\n          if (params.status === 'pending') {\n            query.doesNotExist('isApproved');\n          } else if (params.status === 'rejected') {\n            query.equalTo('isApproved', false);\n          } else if (params.status === 'approved') {\n            query.equalTo('isApproved', true);\n          }\n        }\n\n        query.count({\n          success: function (count) {\n            defer.resolve(count);\n          },\n          error  : function (error) {\n            defer.reject(error);\n          }\n        });\n\n        return defer.promise;\n      }\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'user', {\n      get: function () {\n        return this.get('user');\n      },\n      set: function (value) {\n        this.set('user', value);\n      }\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'subject', {\n      get: function () {\n        return this.get('subject');\n      },\n      set: function (value) {\n        this.set('subject', value);\n      }\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'title', {\n      get: function () {\n        return this.get('title');\n      },\n      set: function (value) {\n        this.set('title', value);\n      }\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'hashtags', {\n      get: function () {\n        return this.get('hashtags');\n      },\n      set: function (value) {\n        this.set('hashtags', value);\n      }\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'words', {\n      get: function () {\n        return this.get('words');\n      },\n      set: function (value) {\n        this.set('words', value);\n      }\n    });\n\n\n    Object.defineProperty(ParseObject.prototype, 'isApproved', {\n      get: function () {\n        return this.get('isApproved');\n      },\n      set: function (value) {\n        this.set('isApproved', value);\n      }\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'expiresAt', {\n      get: function () {\n        return this.get('expiresAt');\n      },\n      set: function (value) {\n        this.set('expiresAt', value);\n      }\n    });\n\n    return ParseObject;\n\n  });\n\n})();\n\n(function () {\n  'use strict';\n  angular.module('starter').factory('GallerySetting', function ($q, moment) {\n\n    var ParseObject = Parse.Object.extend('GallerySetting', {\n      getStatus: function () {\n        if (moment().toDate() >= this.expiresAt) {\n          return 'Expired';\n        }\n        else if (this.isApproved) {\n          return 'Approved';\n        } else if (this.isApproved === false) {\n          return 'Rejected';\n        } else {\n          return 'Pending';\n        }\n      }\n    }, {\n      create : function (item) {\n        var defer    = $q.defer();\n        var objPlace = new ParseObject();\n\n        objPlace.save(item, {\n          success: defer.resolve,\n          error  : defer.reject\n        });\n\n        return defer.promise;\n      },\n      update : function (item) {\n        var defer = $q.defer();\n        item.save(null, {\n          success: defer.resolve,\n          error  : defer.reject\n        });\n        return defer.promise;\n      },\n      destroy: function (item) {\n        var defer = $q.defer();\n        item.destroy({\n          success: defer.resolve,\n          error  : defer.reject\n        });\n        return defer.promise;\n      },\n      all    : function (params) {\n        var defer = $q.defer();\n        var query = new Parse.Query(this);\n\n        if (params.filter != '') {\n          query.contains('canonical', params.filter);\n        }\n\n        query.descending('createdAt');\n        query.limit(params.limit);\n        query.skip((params.page * params.limit) - params.limit);\n        query.find({\n          success: defer.resolve,\n          error  : defer.reject\n        });\n\n        return defer.promise;\n      },\n      count  : function (params) {\n        var defer = $q.defer();\n        var query = new Parse.Query(this);\n\n        query.count({\n          success: defer.resolve,\n          error  : defer.reject\n        });\n\n        return defer.promise;\n      }\n\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'key', {\n      get: function () {\n        return this.get('key');\n      },\n      set: function (value) {\n        this.set('key', value);\n      }\n    });\n\n    Object.defineProperty(ParseObject.prototype, 'value', {\n      get: function () {\n        return this.get('value');\n      },\n      set: function (value) {\n        this.set('value', value);\n      }\n    });\n\n    return ParseObject;\n\n  });\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('Geolocation', GeolocationFactory);\n\n    function GeolocationFactory($ionicPlatform, $q) {\n        return {\n            getCurrentPosition: getCurrentPosition\n        };\n\n        function getCurrentPosition($cordovaGeolocation) {\n            var defer = $q.defer();\n\n            $ionicPlatform.ready(function () {\n                var options = {\n                    maximumAge        : 3000,\n                    timeout           : 1000,\n                    enableHighAccuracy: true\n                };\n\n                var options = {timeout: 10000, enableHighAccuracy: true};\n\n                if (navigator.geolocation) {\n                    navigator.geolocation.getCurrentPosition(\n                        function(position) {\n                            // Get current cordinates.\n                            console.log(position);\n                            defer.resolve(position);\n                        },\n                        function(error) {\n                            defer.reject(error);\n                        },\n                        {timeout: 30000, enableHighAccuracy: true, maximumAge: 75000}\n                    );\n                }\n                \n                //$cordovaGeolocation.getCurrentPosition(options).then(defer.resolve).catch(defer.reject);\n\n                //navigator.geolocation.getCurrentPosition(\n                //    defer.resolve,\n                //    defer.reject,\n                //    options);\n            });\n\n            return defer.promise;\n        }\n    }\n\n})();\n(function () {\n  'use strict';\n  angular.module('starter').factory('GoogleAnalytics', GoogleAnalyticsFactory);\n\n  function GoogleAnalyticsFactory($cordovaGoogleAnalytics) {\n    var TAG      = 'AnalyticsService';\n    var canTrack = false;\n    return {\n      init          : init,\n      trackView     : trackView,\n      trackEvent    : trackEvent,\n      trackException: trackException\n    };\n\n    function init(trackingId) {\n      if (trackingId !== null && trackingId !== '' && window.cordova) {\n        $cordovaGoogleAnalytics.debugMode();\n        $cordovaGoogleAnalytics.startTrackerWithId(trackingId);\n        canTrack = true;\n      } else {\n        console.warn('[' + TAG + ']: Invalid Tracker ID or not using emulator');\n      }\n    }\n\n    function trackEvent(category, action, label) {\n      if (canTrack) {\n        $cordovaGoogleAnalytics.trackEvent(category, action, label);\n      }\n    }\n\n    function trackView(viewName) {\n      if (canTrack) {\n        $cordovaGoogleAnalytics.trackView(viewName);\n      }\n    }\n\n    function trackException(description, isFatal) {\n      if (canTrack) {\n        $cordovaGoogleAnalytics.trackException(description, isFatal)\n      }\n    }\n  }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('Install', InstallFactory);\n\n    function InstallFactory(ParseCloud) {\n        return {\n            start : start,\n            status: status,\n        };\n\n        function start(data) {\n            return ParseCloud.run('install', data);\n        }\n\n        function status(data) {\n            return ParseCloud.run('status', data);\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('OneSignal', OneSignalFactory);\n\n    function OneSignalFactory($q) {\n\n        return {\n            init: init\n        };\n\n        function init(id, google) {\n            var defer = $q.defer();\n\n            if (window.cordova.OneSignal) {\n                // Enable to debug issues.\n                window.plugins.OneSignal.setLogLevel({\n                    logLevel   : 4,\n                    visualLevel: 4\n                });\n\n                // Update with your OneSignal AppId and googleProjectNumber before running.\n                window.plugins.OneSignal.init(id, {googleProjectNumber: google}, function (jsonData) {\n                     alert(\"Notification received:\\n\" + JSON.stringify(jsonData));\n\n                });\n\n                window.plugins.OneSignal.enableInAppAlertNotification(true);\n            } else {\n                defer.reject('OneSignal plugin istalled');\n            }\n            return defer.promise;\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('ParseCloud', ParseCloudFactory);\n\n    function ParseCloudFactory($q) {\n        return {\n            run: run\n        };\n\n        function run(action, data) {\n            var defer = $q.defer();\n            Parse.Cloud.run(action, data, {\n                success: defer.resolve,\n                error  : defer.reject\n            });\n            return defer.promise;\n        }\n    }\n\n})();\n\n(function () {\n  'use strict';\n  angular.module('starter').factory('ParseFile', function ($q) {\n    return {\n      upload: upload\n    };\n\n    function upload(file, ext) {\n      var defer = $q.defer();\n      var filename = 'file.jpg';\n\n      if (ext) {\n        filename.replace('.jpg', ext);\n      }\n      \n      new Parse.File(filename, file)\n        .save({\n          success: defer.resolve,\n          error  : defer.reject\n        });\n      return defer.promise;\n    }\n  });\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('Share', PhotogramShareFactory);\n\n    function PhotogramShareFactory(AppConfig, $q, $translate, $window) {\n\n        var options = {\n            title  : $translate.instant('Join me from ') + AppConfig.app.name + '!',\n            subject: $translate.instant(\"I'm at \") + AppConfig.app.name + '!. ' + (\n                'Install the application and follow me!') + ' ' + AppConfig.app.url,\n            image  : AppConfig.app.image,\n            link   : AppConfig.app.url\n        };\n\n        return {\n            open: open\n        };\n\n        function open(image, title) {\n            var defer = $q.defer();\n\n            if (image) {\n                options.image = image;\n            }\n\n            if (title) {\n                options.title = title;\n            }\n\n            $window.plugins.socialsharing.shareWithOptions(options, defer.success, defer.reject);\n\n            return defer.promise;\n        }\n\n    }\n})();\n\n(function () {\n  'use strict';\n\n  angular.module('starter').factory('Toast', ToastFactory);\n\n  function ToastFactory($cordovaToast, $ionicPopup) {\n\n    return {\n      alert  : alert,\n      confirm: confirm\n    };\n\n    function alert(params) {\n      if (window.cordova) {\n        $cordovaToast.show(params.text, 'short', 'bottom');\n      } else {\n        $ionicPopup.alert({\n          title   : params.title,\n          template: params.text,\n          okType  : 'button button-clear button-assertive',\n        });\n      }\n    }\n\n    function confirm(title, msg) {\n      return $ionicPopup.confirm({\n        title   : title,\n        template: msg\n      });\n    }\n  }\n\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').factory('User', UserFactory);\n\n    function UserFactory($q, $cordovaDevice, ParseCloud) {\n\n        var User = Parse.User.extend({}, {\n            profile               : function (username) {\n                return ParseCloud.run('profile', {username: username})\n            },\n            list                  : function (params) {\n                return ParseCloud.run('listUsers',params)\n            },\n            getFollowers          : function (username) {\n                return ParseCloud.run('getFollowers', {username: username})\n            },\n            getLikers             : function (galleryId) {\n                return ParseCloud.run('getLikers', {galleryId: galleryId})\n            },\n            getFollowing          : function (username) {\n                return ParseCloud.run('getFollowing', {username: username})\n            },\n            signIn                : function (obj) {\n                var defer = $q.defer();\n\n                Parse.User.logIn(obj.username, obj.password, {\n                    success: function (currentUser) {\n\n                        // device\n                        var device;\n                        if (window.cordova) {\n                            device = {\n                                device  : $cordovaDevice.getDevice(),\n                                cordova : $cordovaDevice.getCordova(),\n                                model   : $cordovaDevice.getModel(),\n                                platform: $cordovaDevice.getPlatform(),\n                                uuid    : $cordovaDevice.getUUID(),\n                                version : $cordovaDevice.getVersion()\n                            };\n                        } else {\n                            device = {\n                                device  : {device: window.navigator.userAgent.match(/(?:Chrom(?:e|ium)|Firefox)\\/([0-9]+)\\./)[0]},\n                                cordova : '',\n                                model   : window.navigator.userAgent.match(/(?:Chrom(?:e|ium)|Firefox)\\/([0-9]+)\\./)[0],\n                                platform: window.navigator.platform,\n                                uuid    : '',\n                                version : window.navigator.userAgent.match(/(?:Chrom(?:e|ium)|Firefox)\\/([0-9]+)\\./)[1]\n                            };\n                        }\n\n                        console.log(currentUser);\n                        console.log(device);\n\n                        User.update(device).then(function () {\n                            defer.resolve(currentUser);\n                        }).catch(defer.reject)\n\n                        console.log('updateUser', device);\n                        //user.save(defer.resolve, defer.reject);\n                    },\n                    error  : defer.reject\n                });\n\n                return defer.promise;\n            },\n            signUp                : function (data) {\n                var defer = $q.defer();\n                var user  = new Parse.User()\n                    .set({'name': data.name})\n                    .set({'username': data.username})\n                    .set({'email': data.email})\n                    .set({'password': data.password})\n                    .set({'roleName': 'User'});\n\n                var acl = new Parse.ACL();\n                acl.setPublicReadAccess(false);\n                acl.setPublicWriteAccess(false);\n                user.setACL(acl);\n                user.save(null, {\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n\n                return defer.promise;\n            },\n            signInViaFacebook     : function (authData) {\n                var defer      = $q.defer();\n                var expiration = new Date();\n                expiration.setSeconds(expiration.getSeconds() + authData.authResponse.expiresIn);\n                expiration = expiration.toISOString();\n\n                var facebookAuthData = {\n                    'id'             : authData.authResponse.userID,\n                    'access_token'   : authData.authResponse.accessToken,\n                    'expiration_date': expiration\n                };\n                Parse.FacebookUtils.logIn(facebookAuthData, {\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            logOut                : function () {\n                var defer = $q.defer();\n                Parse.User.logOut().then(defer.resolve, defer.reject);\n                return defer.promise;\n            },\n            findByEmail           : function (email) {\n                return ParseCloud.run('findUserByEmail', {email: email});\n            },\n            updateWithFacebookData: function (data) {\n                var defer = $q.defer();\n                ParseCloud.run('saveFacebookPicture', {}).then(function () {\n                    var user = Parse.User.current();\n                    user.set({'email': data.email});\n                    user.set({'username': data.email});\n                    user.set({'name': data.name});\n                    user.setACL(new Parse.ACL(user));\n                    user.save(null, {\n                        success: function () {\n                            user.fetch().then(function (userFetched) {\n                                defer.resolve(userFetched);\n                            }, function (error) {\n                                defer.reject(error);\n                            });\n                        }\n                    });\n                }).catch(defer.reject);\n                return defer.promise;\n            },\n            getPublicData         : function (user) {\n                console.log(user);\n                var defer = $q.defer();\n                new Parse.Query('UserData').equalTo('user', user).first().then(function (userData) {\n                    if (userData) {\n                        defer.resolve(userData);\n                    } else {\n                        defer.reject(Parse.Promise.error({\n                            code   : 1,\n                            message: 'User Data not found'\n                        }));\n                    }\n                }, defer.reject);\n                return defer.promise;\n            },\n            recoverPassword       : function (email) {\n                var defer = $q.defer();\n                Parse.User.requestPasswordReset(email, {\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            destroy               : function () {\n                var defer = $q.defer();\n                Parse.User.current().destroy().then(defer.resolve, defer.reject);\n                return defer.promise;\n            },\n            setPhoto              : function (parseFile) {\n                var defer = $q.defer();\n                var user  = Parse.User.current();\n                user.set({'photo': parseFile});\n                user.save(null, {\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            follow                : function (userId) {\n                return ParseCloud.run('followUser', {userId: userId});\n            },\n            all                   : function (params) {\n                return ParseCloud.run('getUsers', params);\n            },\n            validateUsername      : function (input) {\n                return ParseCloud.run('validateUsername', {username: input});\n            },\n            validateEmail         : function (input) {\n                return ParseCloud.run('validateEmail', {email: input});\n            },\n            findUsername          : function (username) {\n                var defer = $q.defer();\n                new Parse.Query(this).equalTo('username', username).first({\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            update                : function (params) {\n                var defer = $q.defer();\n                var user  = Parse.User.current();\n                angular.forEach(params, function (value, key) {\n                    user.set(key, value);\n                });\n                user.save({\n                    success: defer.resolve,\n                    error  : defer.reject\n                });\n                return defer.promise;\n            },\n            delete                : function (data) {\n                return ParseCloud.run('destroyUser', data);\n            },\n            fetch                 : function () {\n                var defer = $q.defer();\n                if (Parse.User.current()) {\n                    Parse.User.current().fetch().then(defer.resolve, defer.reject);\n                } else {\n                    defer.reject();\n                }\n                return defer.promise;\n            }\n\n        });\n\n        Object.defineProperty(User.prototype, 'name', {\n            get: function () {\n                return this.get('name');\n            },\n            set: function (val) {\n                this.set('name', val);\n            }\n        });\n\n        Object.defineProperty(User.prototype, 'username', {\n            get: function () {\n                return this.get('username');\n            },\n            set: function (val) {\n                this.set('username', val);\n            }\n        });\n\n        Object.defineProperty(User.prototype, 'status', {\n            get: function () {\n                return this.get('status');\n            },\n            set: function (val) {\n                this.set('status', val);\n            }\n        });\n\n        Object.defineProperty(User.prototype, 'gender', {\n            get: function () {\n                return this.get('gender');\n            },\n            set: function (val) {\n                this.set('gender', val);\n            }\n        });\n\n        Object.defineProperty(User.prototype, 'email', {\n            get: function () {\n                return this.get('email');\n            },\n            set: function (val) {\n                this.set('email', val);\n            }\n        });\n\n        Object.defineProperty(User.prototype, 'photo', {\n            get: function () {\n                return this.get('photo');\n            },\n            set: function (val) {\n                this.set('photo', val);\n            }\n        });\n\n        Object.defineProperty(User.prototype, 'photoThumb', {\n            get: function () {\n                return this.get('photoThumb');\n            },\n            set: function (val) {\n                this.set('photoThumb', val);\n            }\n        });\n\n        Object.defineProperty(User.prototype, 'roleName', {\n            get: function () {\n                return this.get('roleName');\n            },\n            set: function (val) {\n                this.set('roleName', val);\n            }\n        });\n\n        return User;\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    /**\n     * @ngdoc directive\n     * @name modalLanguage\n     *\n     * @description\n     * _Please update the description and restriction._\n     *\n     * @restrict A\n     * */\n\n    var path = 'app/component/ion-language';\n\n    angular\n        .module('ion-language')\n        .directive('ionLanguage', ionLanguageDirective);\n\n    function ionLanguageDirective(AppConfig, $translate, $timeout, Loading, $ionicModal) {\n        return {\n            restrict: 'E',\n            link: modalLanguageLink,\n            templateUrl: path + '/ion-language.html'\n        };\n\n        function modalLanguageLink(scope, elem, attr) {\n\n\n            scope.languages = AppConfig.locales;\n            scope.language  = scope.languages.filter(function (item) {\n                return item.code === $translate.use()\n            })[0];\n\n            console.log(scope.language);\n\n            elem.bind('click', openModal);\n\n            function openModal() {\n\n                window.StatusBar.styleDefault();\n\n                scope.closeModal = function () {\n                    scope.modal.hide();\n                    // scope.modal.remove();\n                    window.StatusBar.styleLightContent();\n                };\n\n\n                scope.searchValue = '';\n\n                scope.selectLanguage = function (language) {\n                    console.log(language);\n                    $translate.use(language.code);\n                    moment.locale(language.code);\n                    scope.language = language;\n                    Loading.start();\n                    scope.closeModal();\n                    $timeout(function () {\n                        Loading.end();\n                    }, 1000);\n                };\n\n                $ionicModal\n                    .fromTemplateUrl(path + '/modal-language.html', {\n                        scope: scope,\n                        focusFirstInput: true\n                    })\n                    .then(function (modal) {\n                        scope.modal = modal;\n                        scope.modal.show();\n\n                    });\n            }\n        }\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n\n    angular\n        .module('ion-location')\n        .factory('GeoService', GeoServiceFactory);\n\n    function GeoServiceFactory($http, $window, $cordovaGeolocation, $ionicPopup, $timeout, $q) {\n\n        /**\n         'street_address', //indicates a precise street address.\n         'route', //indicates a named route (such as \"US 101\").\n         'intersection', //indicates a major intersection, usually of two major roads.\n         'political', //indicates a political entity. Usually, this type indicates a polygon of some civil administration.\n         'country', //indicates the national political entity, and is typically the highest order type returned by the Geocoder.\n         'administrative_area_level_1', //indicates a first-order civil entity below the country level. Within the United States, these administrative levels are states. Not all nations exhibit these administrative levels.\n         'administrative_area_level_2', //indicates a second-order civil entity below the country level. Within the United States, these administrative levels are counties. Not all nations exhibit these administrative levels.\n         'administrative_area_level_3', //indicates a third-order civil entity below the country level. This type indicates a minor civil division. Not all nations exhibit these administrative levels.\n         'colloquial_area', //indicates a commonly-used alternative name for the entity.\n         'locality', //indicates an incorporated city or town political entity.\n         'sublocality', //indicates an first-order civil entity below a locality\n         'neighborhood', //indicates a named neighborhood\n         'premise', //indicates a named location, usually a building or collection of buildings with a common name\n         'subpremise', //indicates a first-order entity below a named location, usually a singular building within a collection of buildings with a common name\n         'postal_code', //indicates a postal code as used to address postal mail within the country.\n         'natural_feature', //indicates a prominent natural feature.\n         'airport', //indicates an airport.\n         'park', //indicates a named park.\n         'point_of_interest', //indicates a named point of interest. Typically, these \"POI\"s are prominent local entities that don't easily fit in another category such as \"Empire State Building\" or \"Statue of Liberty.\"\n\n         //In addition to the above, address components may exhibit the following types:\n\n         'post_box', //indicates a specific postal box.\n         'street_number', //indicates the precise street number.\n         'floor indicates', //the floor of a building address.\n         'room indicates'; //the room of a building address.'\n         */\n        var options             = {\n            types: ['geocode']\n        };\n        var autocompleteService = new $window.google.maps.places.AutocompleteService();\n        var detailsService      = new $window.google.maps.places.PlacesService($window.document.createElement('input'),\n            options);\n        var componentForm       = {\n            street_number              : 'long_name',\n            //number\n            route                      : 'long_name',\n            //street\n            locality                   : 'long_name',\n            // district\n            sublocality                : 'long_name',\n            // district\n            neighborhood               : 'long_name',\n            //state\n            political                  : 'long_name',\n            //state\n            administrative_area_level_1: 'long_name',\n            //state\n            country                    : 'long_name',\n            //country\n            postal_code                : 'long_name' //zipcode\n        };\n        var componentFormName   = {\n            street_number              : 'number',\n            //number\n            route                      : 'street',\n            //street\n            locality                   : 'city',\n            // district\n            administrative_area_level_1: 'state',\n            //state\n            country                    : 'country',\n            //country\n            postal_code                : 'zipcode',\n            //zipcode\n            neighborhood               : 'district' //zipcode\n        };\n\n        var data = {\n            coords: {},\n            src   : ''\n        };\n\n\n        return {\n            src          : src,\n            getDetails   : getDetails,\n            searchAddress: searchAddress,\n            parseAddress : parseAddress,\n            findMe       : findMe\n        };\n\n        function getLocation() {\n            // Pega a Localização da Pessoa\n            var defer = $q.defer();\n\n            if (data.location) {\n                $timeout(function () {\n                    defer.resolve(data.location);\n                }, 1000);\n            } else {\n                var posOptions = {\n                    timeout           : 10000,\n                    enableHighAccuracy: false\n                };\n                $cordovaGeolocation.getCurrentPosition(posOptions).then(function (position) {\n                    // console.log('Fez a requisição', position);\n                    data.location = {\n                        latitude : position.coords.latitude,\n                        longitude: position.coords.longitude\n                    };\n                    defer.resolve(data.location);\n                }, function (err) {\n                    // error\n                    // console.log('Error na geolocalização', err);\n                    $ionicPopup.alert({\n                        title   : 'Geo Error',\n                        template: err.message\n                    });\n                    defer.reject(err);\n                });\n            }\n\n\n            return defer.promise;\n        }\n\n\n        function findMe() {\n            var defer = $q.defer();\n\n            getLocation().then(function (pos) {\n                console.log(pos);\n                getGoogleAddress(pos.latitude, pos.longitude).success(function (resp) {\n                    resp.geolocation = pos;\n                    console.log(resp);\n                    defer.resolve(resp);\n                }).error(logErr);\n            });\n            return defer.promise;\n        }\n\n\n        function logErr(error) {\n            console.log(error);\n        }\n\n        function getGoogleAddress(lat, lng) {\n            return $http.get('http://maps.google.com/maps/api/geocode/json?latlng=' + lat + ',' + lng + '&sensor=true')\n                        .success(function (data) {\n                            data.address_normal = data.results[0].formatted_address;\n                            data.address        = address(data.results[0].address_components);\n                            data.src            = imagem(lat, lng, 18, 500, 300);\n                        });\n        }\n\n        function address(data) {\n            if (!data) {\n                return false;\n            } else {\n                return {\n                    numero  : data[0].short_name,\n                    rua     : data[1].long_name,\n                    bairro  : data[2].short_name,\n                    cidade  : data[3].short_name,\n                    estado  : data[5].long_name,\n                    uf      : data[5].short_name,\n                    pais    : data[6].long_name,\n                    paisCode: data[6].short_name,\n                    cep     : data[7].short_name\n                };\n            }\n\n        }\n\n        function imagem(lat, lng, zoom, w, h) {\n            return 'http://maps.google.com/maps/api/staticmap?center=' + lat + ',' + lng + '&zoom=' + zoom + '&size=' +\n                w + 'x' + h + '&maptype=roadmap&sensor=true';\n        }\n\n        function parseAddress(place) {\n            var defer = $q.defer();\n            console.log('parseAddress', place);\n            if(!place) {\n                defer.reject('not place')\n            }\n            var address = {\n                resume: '',\n                geo   : {\n                    latitude : place.geometry.location.lat(),\n                    longitude: place.geometry.location.lng()\n                }\n            };\n            var image   = src(address.geo.latitude, address.geo.longitude, 16, 900, 200);\n\n            for (var i = 0; i < place.address_components.length; i++) {\n                var addressType = place.address_components[i].types[0];\n                if (componentForm[addressType]) {\n                    var val                                 = place.address_components[i][componentForm[addressType]];\n                    address[componentFormName[addressType]] = val;\n                }\n            }\n            address.name   = place.name;\n            address.street = address.street + ', ' + address.number;\n            address.image  = image;\n            address.resume = address.street + ' - ' + address.city + ', ' + address.state + ', ' + address.country;\n            defer.resolve(address);\n\n            return defer.promise;\n        }\n\n        function searchAddress(input) {\n            var deferred = $q.defer();\n            autocompleteService.getQueryPredictions({\n                input: input\n            }, function (result) {\n                deferred.resolve(result);\n            });\n            return deferred.promise;\n        }\n\n        function getDetails(placeId) {\n            var deferred = $q.defer();\n            detailsService.getDetails({\n                placeId: placeId\n            }, function (result) {\n                deferred.resolve(result);\n            });\n            return deferred.promise;\n        }\n\n        function src(lat, lng, zoom, w, h) {\n            console.log('src latitude', lat, lng, zoom, w, h);\n\n            var link = 'http://maps.googleapis.com/maps/api/staticmap?center=' + lat + ',' + lng + '&zoom=' + zoom +\n                '&scale=1&size=' + w + 'x' + h +\n                '&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff2600%7Clabel:0%7C' + lat +\n                ',' + lng + '&sensor=true';\n            console.log(link);\n            return link;\n        }\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('ion-location').directive('ionLocation', ionLocationDirective);\n\n    function ionLocationDirective($ionicModal, GeoService) {\n        return {\n            restrict: 'A',\n            scope   : {\n                location: '=ngModel'\n            },\n            link    : ionLocationLink\n        };\n\n        function ionLocationLink($scope, element) {\n\n\n            element.bind('click', function () {\n                function init() {\n                    $scope.search             = {};\n                    $scope.search.suggestions = [];\n                    $scope.search.query       = '';\n                }\n\n\n                function selectPlace(place_id) {\n                    GeoService.getDetails(place_id).then(function (location) {\n                        GeoService.parseAddress(location).then(function (address) {\n                            console.log(address);\n                            $scope.location = address;\n                            $scope.closeModalLocation();\n                        })\n                    });\n                }\n\n                init();\n\n                $scope.findMe = function () {\n                    $scope.loading = true;\n                    GeoService.findMe().then(function (location) {\n                        GeoService.searchAddress(location.address_normal).then(function (result) {\n                            console.log(result);\n                            $scope.search.suggestions = result;\n                            $scope.loading            = false;\n                        });\n                    });\n                };\n\n                $scope.findMe();\n\n                $scope.choosePlace = function (place) {\n                    selectPlace(place.place_id);\n                }\n\n                $scope.modalLocation = $ionicModal.fromTemplate('<ion-modal-view>' +\n                    '<ion-header-bar class=\"bar bar-light item-input-inset\">' +\n                    '<ion-spinner ng-if=\"loading\"></ion-spinner>' +\n                    '<button class=\"button button-clear button-icon ion-navigate\" ng-click=\"findMe()\" ng-hide=\"loading\"></button>' +\n                    '<label class=\"item-input-wrapper\">' +\n                    '<input type=\"search\" ng-model=\"search.query\" ng-model-options=\"{ debounce: 1500 }\" placeholder=\"{{ \\'searchText\\' | translate }}\"></label>' +\n                    '<button class=\"button button-clear\" ng-click=\"closeModalLocation()\" translate=\"cancel\"></button>' +\n                    '</ion-header-bar>' +\n                    '<ion-content padding=\"false\">' +\n                    '<ion-list>' +\n                    '<div class=\"center padding\" ng-if=\"loading1\"><ion-spinner ></ion-spinner></div>' +\n                    '<ion-item ng-repeat=\"suggestion in search.suggestions\" ng-click=\"choosePlace(suggestion)\" ng-bind=\"suggestion.description\"></ion-item>' +\n                    '<ion-item class=\"item-divider\"><img src=\"https://developers.google.com/maps/documentation/places/images/powered-by-google-on-white.png\"alt=\"\"/></ion-item>' +\n                    '</ion-list>' +\n                    '</ion-content>' +\n                    '</ion-modal-view>', {\n                        scope          : $scope,\n                        focusFirstInput: true\n                    }\n                );\n\n                $scope.modalLocation.show();\n\n                $scope.closeModalLocation = function () {\n                    $scope.modalLocation.hide();\n                    $scope.modalLocation.remove();\n                };\n\n                $scope.$watch('search.query', function (newValue) {\n                    if (newValue) {\n                        $scope.loading1           = true;\n                        $scope.search.suggestions = [];\n                        GeoService.searchAddress(newValue).then(function (result) {\n                            console.log(result);\n                            $scope.search.suggestions = result;\n                            $scope.loading1           = false;\n                        });\n                    }\n                });\n\n\n            });\n\n        }\n    }\n})();\n\n(function () {\n\n    angular.module('app.main').factory('FeedbackModal', FeedbackModalFactory);\n\n    function FeedbackModalFactory($q, AppConfig, GalleryFeedback, $rootScope, GalleryFeedbackForm, $ionicModal, Toast) {\n        var path = AppConfig.path;\n\n        return {\n            modal: modal\n        };\n        function modal(gallery) {\n            var $scope            = $rootScope.$new();\n            $scope.formFields     = GalleryFeedbackForm.form;\n            $scope.submitFeedback = submitFeedback;\n            $scope.closeModal     = closeModal;\n            $scope.form           = {\n                photogramId: gallery.id,\n                subject    : 'complaint'\n            };\n\n            function submitFeedback() {\n                var dataForm = angular.copy($scope.form);\n                GalleryFeedback.create(dataForm).then(function (resp) {\n                    closeModal();\n                });\n            }\n\n\n            function closeModal() {\n                $scope.modal.hide();\n                $scope.modal.remove();\n                delete $scope.modal;\n            }\n\n            $ionicModal\n                .fromTemplateUrl('app/main/feedback/feedback-modal.html', {\n                    scope          : $scope,\n                    focusFirstInput: true\n                })\n                .then(function (modal) {\n                    $scope.modal = modal;\n                    $scope.modal.show();\n                });\n        }\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n    angular\n        .module('app.main')\n        .factory('GalleryFeedbackForm', GalleryFeedbackFormFactory);\n\n    function GalleryFeedbackFormFactory($translate) {\n\n        var form = [{\n            key: 'title',\n            type: 'input',\n            templateOptions: {\n                type: 'text',\n                placeholder: $translate.instant('FEEDBACK.TITLE'),\n                required: true\n            }\n        }, {\n            key: 'subject',\n            type: 'select',\n            templateOptions: {\n                label: $translate.instant('FEEDBACK.SUBJECT'),\n                options: [{\n                    'label': $translate.instant('FEEDBACK.COMPLAINT'),\n                    'id': 'complaint',\n                }, {\n                    'label': $translate.instant('FEEDBACK.BUG'),\n                    'id': 'bug',\n                }, {\n                    'label': $translate.instant('FEEDBACK.SUGGESTION'),\n                    'id': 'suggestion',\n                }],\n                valueProp: 'id',\n                labelProp: 'label',\n                icon: 'icon-list',\n                iconPlaceholder: true\n            }\n        }, {\n            key: 'status',\n            type: 'textarea',\n            templateOptions: {\n                type: 'text',\n                placeholder: $translate.instant('FEEDBACK.MESSAGE'),\n                icon: 'ion-quote',\n                required: true,\n                iconPlaceholder: true\n            }\n        }];\n\n        return {\n            form: form\n        };\n    }\n\n\n})();\n\n(function () {\n  'use strict';\n  \n  angular.module('app.main').directive('feedback', feedbackDirective);\n\n  function feedbackDirective($ionicModal, AppConfig, PhotogramFeedback, PhotogramFeedbackForm, $state) {\n\n    var path = AppConfig.path;\n\n    return {\n      restrict: 'A',\n      scope: {\n        photogram: '@'\n      },\n      template: '',\n      link: function (scope, elem, attr) {\n\n        scope.link = link;\n        scope.submitFeedback = submitFeedback;\n        scope.closeModal = closeModal;\n        elem.bind('click', openModal);\n\n        function init() {\n          scope.form = {\n            photogramId: scope.photogram\n          };\n          scope.formFields = PhotogramFeedbackForm.form;\n        }\n\n        function openModal() {\n\n          init();\n          $ionicModal.fromTemplateUrl('app/main/feedback/feedback-modal.html', {\n              scope: scope,\n              focusFirstInput: true\n            })\n            .then(function (modal) {\n              scope.modal = modal;\n              scope.modal.show();\n            });\n        }\n\n        function link(sref) {\n          $state.go(sref)\n          scope.closeModal();\n        }\n\n        function submitFeedback() {\n          var dataForm = angular.copy(scope.form);\n          PhotogramFeedback\n            .submit(dataForm)\n            .then(function (resp) {\n              console.log(resp);\n              init();\n              scope.closeModal();\n            });\n        }\n\n\n        function closeModal() {\n          scope.modal.hide();\n          scope.modal.remove();\n        }\n\n      }\n    };\n  }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('starter').controller('GalleryComment', GalleryCommentController);\n\n    function GalleryCommentController($scope, $stateParams, $q, $ionicScrollDelegate, $ionicHistory, Loading, $ionicPopup, User, Dialog, $timeout, Gallery, GalleryComment, GalleryForm) {\n\n        $scope.currentUser = Parse.User.current();\n        $scope.loading     = true;\n        $scope.formFields  = GalleryForm.formComment;\n\n        function init() {\n            $scope.nocomments = false;\n            Gallery.get($stateParams.galleryId).then(function (gallery) {\n                $scope.form = {\n                    gallery: gallery,\n                    text   : ''\n                };\n            });\n        }\n\n        $scope.backButton = function () {\n            $ionicHistory.goBack();\n        };\n\n        getComments();\n        init();\n\n        //Mentios\n        // shows the use of dynamic values in mentio-id and mentio-for to link elements\n        $scope.myIndexValue = \"5\";\n\n        $scope.searchPeople = function (term) {\n            var peopleList = [];\n            return User.getFollowing().then(function (response) {\n                _.each(response, function (item) {\n                    item.imageUrl = item.photo ? item.photo._url : 'img/user.png';\n                    item.bio      = item.status;\n\n                    if (item.name) {\n                        if (item.name.toUpperCase().indexOf(term.toUpperCase()) >= 0) {\n                            peopleList.push(item);\n                        }\n                    } else {\n                        item.name = 'Not name';\n                        peopleList.push(item);\n                    }\n                });\n                $scope.people = peopleList;\n                console.log(peopleList);\n                return $q.when(peopleList);\n            });\n        };\n\n        $scope.getPeopleTextRaw = function (item) {\n            return '@' + item.username;\n        };\n\n\n        $scope.deleteComment = function (item, index) {\n            console.log(item);\n            Dialog.confirm(('Delete comment'), ('You are sure?')).then(function (resp) {\n                if (resp) {\n                    GalleryComment.get(item.id).then(function (comment) {\n                        GalleryComment.destroy(comment).then(function (resp) {\n                            $scope.comments.splice(index, 1);\n                        });\n                    })\n                }\n            });\n        }\n\n        $scope.editComment = function (obj, index) {\n            console.log(obj);\n            // An elaborate, custom popup\n            $scope.formEdit = {\n                id  : obj.id,\n                text: obj.text\n            };\n\n            $ionicPopup\n                .show({\n                    template: '<input type=\"text\" ng-model=\"formEdit.text\">',\n                    title   : ('Edit comment'),\n                    //subTitle: 'Please use normal things',\n                    scope   : $scope,\n                    buttons : [{\n                        text: ('Cancel')\n                    }, {\n                        text : '<b>OK</b>',\n                        type : 'button-positive',\n                        onTap: function (e) {\n                            console.log($scope.formEdit);\n                            if (!$scope.formEdit.text) {\n                                //don't allow the user to close unless he enters wifi password\n                                e.preventDefault();\n                            } else {\n                                return $scope.formEdit;\n                            }\n                        }\n                    }]\n                })\n                .then(function (resp) {\n                    console.log(resp);\n                    if (resp) {\n                        GalleryComment.get(obj.id).then(function (comment) {\n                            comment.text                = resp.text;\n                            $scope.comments[index].text = resp.text;\n                            comment.save();\n                        });\n                    }\n                });\n        }\n\n        function getComments() {\n            $scope.loading = true;\n            Gallery.comments({galleryId: $stateParams.galleryId}).then(function (resp) {\n                $scope.comments = [];\n\n                resp.map(function (comment) {\n                    console.log(comment);\n                    comment.canEdit = (comment.user.obj.id === $scope.currentUser.id) ? true : false;\n                    $scope.comments.push(comment);\n                });\n\n                $scope.loading = false;\n                $ionicScrollDelegate.scrollBottom();\n            });\n        }\n\n        $scope.submitComment = function (rForm, form) {\n            if (rForm.$valid) {\n                var dataForm   = angular.copy(form);\n                $scope.loading = true;\n                GalleryComment.create(dataForm).then(function (resp) {\n                    getComments();\n                    $scope.form.text = '';\n                });\n            }\n        }\n\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app.main').controller('LoadingCtrl', LoadingController);\n\n    function LoadingController($scope, $rootScope, $ionicPlatform, $cordovaSplashscreen, AppConfig, $state) {\n        var user  = $rootScope.currentUser;\n        var intro = window.localStorage['walkthrough'];\n\n        if (intro !== 'true') {\n            $state.go('walkthrough', {clear: true});\n        } else {\n            if (user) {\n                console.log(user);\n                if (user.name) {\n                    $state.go(AppConfig.routes.home, {\n                        clear: true\n                    });\n                } else {\n                    $state.go('user.avatar', {\n                        clear: true\n                    });\n                }\n            } else {\n                $state.go(AppConfig.routes.login, {\n                    clear: true\n                });\n            }\n        }\n\n        $scope.$on('$ionicView.loaded', function () {\n            $ionicPlatform.ready(function () {\n                if (navigator && navigator.splashscreen) {\n                    $cordovaSplashscreen.hide();\n                }\n            });\n        });\n\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app.main').controller('ProfileCtrl', ProfileController);\n\n    function ProfileController(User, $state, $stateParams) {\n        var vm       = this;\n        vm.changeTab = changeTab;\n\n        vm.loading = true;\n        User.profile($stateParams.username).then(function (data) {\n            console.log(data);\n            console.log(Parse.User.current());\n            vm.isMe    = Parse.User.current().id === data.id ? true : false;\n            vm.user    = data;\n            vm.loading = false;\n        });\n\n        vm.openFollowers = function () {\n            console.log($state, $stateParams);\n            switch ($state.current.name) {\n                case 'tab.homeProfile':\n                    $state.go('tab.homeProfileFollowers', {username: $stateParams.username});\n                    break;\n                case 'tab.activityProfile':\n                    $state.go('tab.activityProfileFollowers', {username: $stateParams.username});\n                    break;\n            }\n        };\n\n        vm.openFollowing = function () {\n            console.log($state, $stateParams);\n            switch ($state.current.name) {\n                case 'tab.homeProfile':\n                    $state.go('tab.homeProfileFollowing', {username: $stateParams.username});\n                    break;\n                case 'tab.activityProfile':\n                    $state.go('tab.activityProfileFollowing', {username: $stateParams.username});\n                    break;\n            }\n        };\n\n        vm.follow = function () {\n\n            vm.loadingFollow = true;\n\n\n            User.follow(vm.user.userObj.id).then(function (resp) {\n                console.log('Follow result', resp);\n                vm.user.isFollow = (resp === 'follow') ? true : false;\n                if (resp == 'follow') {\n                    vm.user.followersTotal += 1;\n                }\n                if (resp == 'unfollow') {\n                    vm.user.followersTotal -= 1;\n                }\n                vm.loadingFollow = false;\n            });\n\n\n        }\n\n        init();\n        changeTab('grid');\n\n        function changeTab(tab) {\n            if (tab === 'list') {\n                vm.tab = {\n                    list: true,\n                    grid: false\n                };\n            } else {\n                vm.tab = {\n                    list: false,\n                    grid: true\n                };\n            }\n        }\n\n        function init() {\n            vm.data  = {\n                total    : false,\n                galleries: []\n            };\n            vm.page  = 0;\n            vm.empty = false;\n            vm.more  = false;\n        }\n\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app.main').controller('MainTabCtrl', MainTabController);\n\n    function MainTabController($localStorage, $scope, PhotoService, User, $cordovaSplashscreen, $ionicPlatform, ActionSheet, $q, Gallery, PhotoFilter, ParseFile, $ionicModal, Loading, Toast) {\n        var vm = this;\n        var tempImage;\n\n        $scope.storage = $localStorage;\n\n        $scope.$on('$ionicView.loaded', function () {\n            $ionicPlatform.ready(function () {\n                if (navigator && navigator.splashscreen) {\n                    $cordovaSplashscreen.hide();\n                    window.StatusBar.styleDefault();\n                }\n            });\n        });\n\n        vm.postPhoto = function () {\n            //ActionSheet.image().then(function (image) {\n            //    tempImage = image;\n            //    //return PhotoFilter.load(image);\n            //    return PhotoService.crop(image);\n            //    //return image;\n            //})\n            PhotoService.open().then(modalPost).then(function (form) {\n                //console.log('Cadastra na Galeria', form);\n                Loading.start();\n                ParseFile.upload({base64: form.image}).then(function (imageUploaded) {\n                    form.image = imageUploaded;\n                    Gallery.create(form).then(function (item) {\n                        $scope.$emit('photoInclude', item);\n                        Loading.end();\n                    });\n                });\n            });\n\n\n            function modalPost(image) {\n                var defer    = $q.defer();\n                $scope.image = image;\n                $scope.form  = {\n                    title: ''\n                };\n\n                $scope.editFilter = function () {\n                    PhotoFilter.load(tempImage).then(function (image) {\n                        $scope.image = image;\n                    });\n                };\n\n                //Mentios\n                // shows the use of dynamic values in mentio-id and mentio-for to link elements\n                $scope.searchPeople = function (term) {\n                    var peopleList = [];\n                    return User.getFollowers().then(function (response) {\n                        _.each(response, function (item) {\n                            item.imageUrl = item.photo ? item.photo._url : 'img/user.png';\n                            item.bio      = item.status;\n                            if (item.name.toUpperCase().indexOf(term.toUpperCase()) >= 0) {\n                                peopleList.push(item);\n                            }\n                        });\n                        $scope.people = peopleList;\n                        //console.log(peopleList);\n                        return $q.when(peopleList);\n                    });\n                };\n\n                $scope.getPeopleTextRaw = function (item) {\n                    return '@' + item.username;\n                };\n\n                $ionicModal.fromTemplateUrl('app/main/share/share-modal.html', {\n                    scope          : $scope,\n                    focusFirstInput: true\n                }).then(function (modal) {\n                    $scope.modalFilter = modal;\n                    $scope.modalFilter.show();\n                });\n\n\n                $scope.form.address = {};\n                $scope.closeAddress = function () {\n                    $scope.form.address = {};\n                };\n\n                $scope.close = function () {\n                    $scope.modalFilter.hide();\n                };\n\n                // Cleanup the modal when we're done with it!\n                $scope.$on('$destroy', function () {\n                    $scope.modal.remove();\n                });\n\n                $scope.submit = function () {\n                    var form   = angular.copy($scope.form);\n                    form.image = $scope.image;\n                    tempImage  = '';\n                    $scope.close();\n                    defer.resolve(form);\n                };\n\n                return defer.promise;\n            }\n        };\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app.main').controller('AccountCtrl', AccountController);\n\n    function AccountController(User, $state, $rootScope) {\n        var vm       = this;\n        vm.changeTab = changeTab;\n\n        vm.user  = $rootScope.currentUser;\n        vm.photo = $rootScope.currentUser.attributes.photo;\n\n        vm.loading = true;\n        User.getPublicData(Parse.User.current()).then(function (user) {\n            console.log('Profile', user.attributes);\n            vm.user    = user;\n            vm.loading = false;\n        });\n\n        vm.openFollowers = function () {\n            $state.go('tab.accountFollowers', {username: $rootScope.currentUser.attributes.username});\n        };\n\n        vm.openFollowing = function () {\n            $state.go('tab.accountFollowing', {username: $rootScope.currentUser.attributes.username});\n        };\n\n        init();\n        changeTab('grid');\n\n        function changeTab(tab) {\n            if (tab === 'list') {\n                vm.tab = {\n                    list: true,\n                    grid: false\n                };\n            } else {\n                vm.tab = {\n                    list: false,\n                    grid: true\n                };\n            }\n        }\n\n        function init() {\n            vm.data  = {\n                total    : false,\n                galleries: []\n            };\n            vm.page  = 0;\n            vm.empty = false;\n            vm.more  = false;\n            getFollower();\n        }\n\n        function getFollower() {\n            vm.loadingFollowers = true;\n            vm.loadingFollowing = true;\n            vm.loadingPhotos    = true;\n        }\n\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('app.main').controller('ActivityCtrl', ActivityController);\n\n    function ActivityController($scope, $state, GalleryActivity) {\n        var vm          = this;\n        vm.params       = {};\n        vm.params.page  = 1;\n        vm.params.limit = 30;\n        vm.data         = [];\n\n        vm.openProfile = function (username) {\n            $state.go('tab.activityProfile', {username: username})\n        };\n\n        $scope.loading = true;\n\n        loadFeed();\n\n        var isLoadingViewShown   = false;\n        var isGalleriesViewShown = false;\n        var isErrorViewShown     = false;\n        var isEmptyViewShown     = false;\n\n        var isMoreData = false;\n\n        function showLoading() {\n            isLoadingViewShown   = true;\n            isGalleriesViewShown = false;\n            isErrorViewShown     = false;\n            isEmptyViewShown     = false;\n        }\n\n        function showGalleries() {\n            isGalleriesViewShown = true;\n            isLoadingViewShown   = false;\n            isErrorViewShown     = false;\n            isEmptyViewShown     = false;\n        }\n\n        function showErrorView() {\n            isErrorViewShown     = true;\n            isGalleriesViewShown = false;\n            isLoadingViewShown   = false;\n            isEmptyViewShown     = false;\n        }\n\n        function showEmptyView() {\n            isEmptyViewShown     = true;\n            isErrorViewShown     = false;\n            isGalleriesViewShown = false;\n            isLoadingViewShown   = false;\n        }\n\n\n        function ensureMoreData(length) {\n            isMoreData = false;\n            if (length > 0) {\n                isMoreData = true;\n            }\n        }\n\n        function setGalleries(data) {\n            for (var i = 0; i < data.length; i++) {\n                vm.data.push(data[i]);\n            }\n        }\n\n        function setCurrentPage(page) {\n            vm.params.page = page;\n        }\n\n        function loadFeed() {\n\n            GalleryActivity.feed(vm.params).then(function (data) {\n                ensureMoreData(data.length);\n                setCurrentPage(vm.params.page + 1);\n                setGalleries(data);\n\n                if (vm.data.length === 0) {\n                    showEmptyView();\n                } else {\n                    showGalleries();\n                }\n\n                $scope.$broadcast('scroll.infiniteScrollComplete');\n                $scope.$broadcast('scroll.refreshComplete');\n                $scope.loading = false;\n\n            }).catch(function () {\n                if (vm.data.length === 0) {\n                    showErrorView();\n                }\n                isMoreData = false;\n                $scope.$broadcast('scroll.refreshComplete');\n            });\n        }\n\n        vm.onLoadMore = function () {\n            loadFeed();\n        };\n\n        vm.moreDataCanBeLoaded = function () {\n            return isMoreData;\n        };\n\n        vm.showLoadingView = function () {\n            return isLoadingViewShown;\n        };\n\n        vm.showGalleries = function () {\n            return isGalleriesViewShown;\n        };\n\n        vm.showErrorView = function () {\n            return isErrorViewShown;\n        };\n\n        vm.showEmptyView = function () {\n            return isEmptyViewShown;\n        };\n\n        vm.onReload = function () {\n            vm.params.page = 0;\n            vm.data        = [];\n            showLoading();\n            loadFeed();\n            $scope.$broadcast('scroll.refreshComplete');\n        };\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app.main').controller('HomeCtrl', HomeController);\n\n    function HomeController($state) {\n        var vm = this;\n\n        vm.openProfile = function (username) {\n            $state.go('tab.homeProfile', {username: username})\n        };\n\n        vm.openLikers = function (galleryId) {\n            $state.go('tab.homeGalleryLikers', {galleryId: galleryId})\n        };\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('app.main')\n        .controller('SearchCtrl', SearchCtrl);\n\n    function SearchCtrl($scope, $filter, $ionicLoading, $state) {\n\n\n        $scope.onSearch = function () {\n\n            if ($scope.params.search !== '') {\n                $scope.params.page   = 0;\n                $scope.places        = [];\n                $scope.params.search = $filter('lowercase')($scope.params.search);\n            }\n        };\n\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('app.main').controller('SearchMapCtrl', SearchMapController);\n\n    function SearchMapController($scope, $state, $localStorage, Toast, Gallery, Geolocation, Dialog) {\n\n        var markers      = [];\n        var latlngbounds = new google.maps.LatLngBounds();\n        $scope.maxRating = 5;\n        $scope.storage   = $localStorage;\n        $scope.galleries = [];\n        $scope.params    = {\n            location: null,\n            distance: 100.00,\n            page    : 1,\n            limit   : 10\n        };\n        $scope.loading   = true;\n        $scope.map\n\n        function init() {\n            $scope.galleries = [];\n            removeGallerys();\n            removeMarkers();\n\n            var position   = {\n                latitude : -18.8800397,\n                longitude: -47.05878999999999\n            };\n            var mapOptions = {\n                center   : setPosition(position),\n                zoom     : 15,\n                mapTypeId: google.maps.MapTypeId.ROADMAP\n            };\n\n            $scope.map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);\n        }\n\n        $scope.$on('$ionicView.enter', function (scopes, states) {\n            if(!$scope.map) {\n                init();\n                myPosition();\n            }\n        });\n\n\n        function myPosition() {\n            Geolocation.getCurrentPosition().then(function (position) {\n\n                console.log(position);\n\n                $scope.params.location = {\n                    latitude : position.coords.latitude,\n                    longitude: position.coords.longitude\n                };\n\n                var marker = {\n                    position: setPosition($scope.params.location),\n                    title   : 'I am here',\n                    id      : 0\n                }\n\n                addMarker(marker);\n\n                // Set center locale\n                $scope.map.setCenter(setPosition($scope.params.location));\n\n                loadGallerys();\n            }, function (error) {\n                $scope.params.location = null;\n\n                var errorMessage;\n                if (error.code === 1 || error.code === 3) {\n                    errorMessage = 'errorGpsDisabledText';\n                } else {\n                    errorMessage = 'errorLocationMissingText';\n                }\n                Dialog.alert(errorMessage);\n\n            });\n        }\n\n        function setPosition(location) {\n            if (location) {\n                return new google.maps.LatLng(location.latitude, location.longitude);\n            }\n        }\n\n        function addMarker(item) {\n\n\n            var markerOption = {\n                id       : item.id,\n                map      : $scope.map,\n                position : item.position,\n                title    : item.title,\n                animation: google.maps.Animation.DROP\n            };\n\n            if (item.icon) {\n                var size          = 40;\n                markerOption.icon = {\n                    url       : item.icon,\n                    size      : new google.maps.Size(size, size),\n                    scaledSize: new google.maps.Size(size, size),\n                    origin    : new google.maps.Point(0, 0),\n                    anchor    : new google.maps.Point(size / 4, size / 4),\n                };\n            }\n\n            // VariÃ¡vel que define as opÃ§Ãµes do marcador\n            var marker = new google.maps.Marker(markerOption);\n\n            // Procedimento que mostra a Info Window atravÃ©s de um click no marcador\n            google.maps.event.addListener(marker, 'click', function () {\n                // Open Profile\n                if(item.username) {\n                    $state.go('tab.mapProfile', {username: item.username})\n                }\n\n            });\n\n            markers.push(marker);\n\n            new MarkerClusterer($scope.map, markers, {\n                imagePath: '../img/m'\n            });\n\n            latlngbounds.extend(item.position);\n            $scope.map.fitBounds(latlngbounds);\n        }\n\n        function setGallerys(galleries) {\n            $scope.galleries = galleries;\n            galleries.map(function (item) {\n\n                if (item.location) {\n                    var marker = {\n                        map     : $scope.map,\n                        id      : item.id,\n                        position: setPosition(item.location),\n                        title   : item.title,\n                        image   : item.image.url(),\n                        icon    : item.imageThumb.url(),\n                        username: item.attributes.user.attributes.username\n                    };\n\n                    addMarker(marker)\n                }\n            });\n\n\n        }\n\n        function loadGallerys() {\n            $scope.loading = true;\n            Gallery.all($scope.params).then(function (galleries) {\n\n                if (galleries.length > 0) {\n                    setGallerys(galleries);\n                } else {\n                    Dialog.alert('galleriesNotFoundText');\n                }\n\n                $scope.loading = false;\n\n            }, function () {\n                Toast.show('errorText');\n            });\n        }\n\n        function removeGallerys() {\n            $scope.galleries = [];\n        }\n\n        function removeMarkers() {\n            markers.map(function (item) {\n                item.setMap(null);\n            });\n            markers = [];\n        };\n\n        $scope.onSearchHere = function () {\n            $scope.params.location.latitude  = $scope.map.getCenter().lat();\n            $scope.params.location.longitude = $scope.map.getCenter().lng();\n            removeGallerys();\n            removeMarkers();\n            loadGallerys();\n        }\n\n        $scope.onGalleryClicked = function (item) {\n            console.log(item);\n        };\n    }\n\n})();\n(function () {\n    'use strict';\n    /**\n     * @ngdoc controller\n     * @name UserAvatarCtrl\n     *\n     * @description\n     * _Please update the description and dependencies._\n     *\n     * @requires $scope\n     * */\n    angular\n        .module('app.main')\n        .controller('UserAvatarCtrl', UserAvatarController);\n\n    function UserAvatarController(User, Auth, AppConfig, $rootScope, $state, Toast, UserForm) {\n        var vm          = this;\n        vm.submitAvatar = submitAvatar;\n        init();\n\n        vm.photo = Parse.User.current().attributes.photo;\n\n        function init() {\n            var user      = Auth.getLoggedUser();\n            vm.form       = {\n                name    : user.name,\n                email   : user.email,\n                status  : user.status,\n                gender  : user.gender,\n                img     : user.img,\n                username: user.username\n            };\n            vm.formFields = UserForm.profile;\n            console.log(vm.form);\n            console.log(vm.formFields);\n        }\n\n        function submitAvatar() {\n            console.log(vm.rForm);\n\n            if (vm.rForm.$valid) {\n                var dataForm = angular.copy(vm.form);\n                console.log(dataForm);\n\n                User.update(dataForm).then(function (resp) {\n                    console.log(resp);\n                    $rootScope.currentUser = Parse.User.current();\n                    $state.go(AppConfig.routes.home, {\n                        clear: true\n                    });\n                });\n            } else {\n                Toast.alert({\n                    title: ('Invalid form'),\n                    text : ('Fill out the fields in red')\n                });\n            }\n\n        }\n\n    }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app.main').directive('userAvatar', userAvatarDirective);\n\n    function userAvatarDirective(ActionSheet, $rootScope, ParseFile, User) {\n        return {\n            restrict: 'A',\n            scope   : {\n                ngModel: '='\n            },\n            link    : function ($scope, elem) {\n\n                elem.bind('click', openModal);\n\n                function openModal() {\n                    var tempImage;\n                    var user        = $scope.ngModel;\n                    var currentUser = $rootScope.currentUser;\n\n                    console.log(user);\n                    console.log(currentUser);\n\n                    if (user.id != currentUser.id) {\n                        return false;\n                    }\n\n                    ActionSheet.image().then(function (image) {\n                        tempImage = image;\n                        //return PhotoFilter.load(image);\n                        return image;\n                    }).then(function (form) {\n                        $scope.loading = true;\n                        ParseFile.upload({base64: form}).then(function (imageUploaded) {\n                            User.setPhoto(imageUploaded).then(function (user) {\n                                console.log(user);\n                                $scope.ngModel = user.attributes.photo;\n                                console.log(user.attributes.photo);\n                                $scope.loading = false;\n                            });\n                        });\n                    });\n                }\n\n            }\n        };\n    }\n\n})();\n\n(function () {\n    'use strict';\n    angular.module('starter').controller('UserFollowerCtrl', UserFollowerController);\n\n    function UserFollowerController(User, $scope, $stateParams, $state) {\n        var vm     = this;\n        vm.loading = true;\n        User.getFollowers($stateParams.username).then(function (data) {\n            console.log(data);\n            vm.users   = data;\n            vm.loading = false;\n        });\n\n        $scope.clearSearch = function () {\n            $scope.searchValue = '';\n        }\n\n        vm.openProfile = function (user) {\n            console.log('user', user);\n            $state.go('tab.homeProfile', {username: user.username})\n        };\n\n\n        vm.follow = function (user) {\n\n            vm.loadingFollow = true;\n            User.follow(user.userObj.id).then(function (resp) {\n                console.log('Follow result', resp);\n                user.isFollow = (resp === 'follow') ? true : false;\n                if (resp == 'follow') {\n                    user.followersTotal += 1;\n                }\n                if (resp == 'unfollow') {\n                    user.followersTotal -= 1;\n                }\n                vm.loadingFollow = false;\n            });\n\n\n        }\n    }\n\n})();\n(function () {\n    'use strict';\n    angular.module('starter').controller('UserFollowingCtrl', UserFollowingController);\n\n    function UserFollowingController(User, $scope, $stateParams, $state) {\n        var vm     = this;\n        vm.loading = true;\n        User.getFollowing($stateParams.username).then(function (data) {\n            console.log(data);\n            vm.users   = data;\n            vm.loading = false;\n        });\n\n        $scope.clearSearch = function () {\n            $scope.searchValue = '';\n        }\n\n        vm.openProfile = function (user) {\n            console.log('user', user);\n            $state.go('tab.homeProfile', {username: user.username})\n        };\n\n\n        vm.follow = function (user) {\n\n            vm.loadingFollow = true;\n            User.follow(user.userObj.id).then(function (resp) {\n                console.log('Follow result', resp);\n                user.isFollow = (resp === 'follow') ? true : false;\n                if (resp == 'follow') {\n                    user.followersTotal += 1;\n                }\n                if (resp == 'unfollow') {\n                    user.followersTotal -= 1;\n                }\n                vm.loadingFollow = false;\n            });\n\n\n        }\n    }\n\n})();\n(function () {\n    'use strict';\n    angular.module('starter').controller('UserIntroCtrl', UserIntroController);\n\n    function UserIntroController($scope, $ionicPlatform, $cordovaSplashscreen) {\n        var vm = this;\n        $scope.$on('$ionicView.loaded', function () {\n            $ionicPlatform.ready(function () {\n                if (navigator && navigator.splashscreen) {\n                    $cordovaSplashscreen.hide();\n                    window.StatusBar.styleLightContent();\n                }\n            });\n        });\n    }\n\n})();\n(function () {\n    'use strict';\n    angular.module('starter').controller('UserLikersCtrl', UserLikerController);\n\n    function UserLikerController(User, $scope, $stateParams, $state) {\n        var vm     = this;\n        vm.loading = true;\n\n        User.getLikers($stateParams.galleryId).then(function (data) {\n            console.log(data);\n            vm.users   = data;\n            vm.loading = false;\n        });\n\n        $scope.clearSearch = function () {\n            $scope.searchValue = '';\n        }\n\n        vm.openProfile = function (user) {\n            console.log('user', user);\n            $state.go('tab.homeProfile', {username: user.username})\n        };\n\n\n        vm.follow = function (user) {\n\n            vm.loadingFollow = true;\n            User.follow(user.userObj.id).then(function (resp) {\n                console.log('Follow result', resp);\n                user.isFollow = (resp === 'follow') ? true : false;\n                if (resp == 'follow') {\n                    user.followersTotal += 1;\n                }\n                if (resp == 'unfollow') {\n                    user.followersTotal -= 1;\n                }\n                vm.loadingFollow = false;\n            });\n\n\n        }\n    }\n\n})();\n(function () {\n    'use strict';\n    angular.module('starter').controller('UserListCtrl', UserListController);\n\n    function UserListController(User, $scope, $state) {\n        var vm          = this;\n        vm.params       = {};\n        vm.params.page  = 1;\n        vm.params.limit = 30;\n        vm.data         = [];\n\n        vm.loading = true;\n\n        loadFeed();\n\n        var isLoadingViewShown   = false;\n        var isGalleriesViewShown = false;\n        var isErrorViewShown     = false;\n        var isEmptyViewShown     = false;\n\n        var isMoreData = false;\n\n        function showLoading() {\n            isLoadingViewShown   = true;\n            isGalleriesViewShown = false;\n            isErrorViewShown     = false;\n            isEmptyViewShown     = false;\n        }\n\n        function showGalleries() {\n            isGalleriesViewShown = true;\n            isLoadingViewShown   = false;\n            isErrorViewShown     = false;\n            isEmptyViewShown     = false;\n        }\n\n        function showErrorView() {\n            isErrorViewShown     = true;\n            isGalleriesViewShown = false;\n            isLoadingViewShown   = false;\n            isEmptyViewShown     = false;\n        }\n\n        function showEmptyView() {\n            isEmptyViewShown     = true;\n            isErrorViewShown     = false;\n            isGalleriesViewShown = false;\n            isLoadingViewShown   = false;\n        }\n\n\n        function ensureMoreData(length) {\n            isMoreData = false;\n            if (length > 0) {\n                isMoreData = true;\n            }\n        }\n\n        function setGalleries(data) {\n            for (var i = 0; i < data.length; i++) {\n                vm.data.push(data[i]);\n            }\n        }\n\n        function setCurrentPage(page) {\n            vm.params.page = page;\n        }\n\n        function loadFeed() {\n\n            User.list(vm.params).then(function (data) {\n                ensureMoreData(data.length);\n                setCurrentPage(vm.params.page + 1);\n                setGalleries(data);\n\n                if (vm.data.length === 0) {\n                    showEmptyView();\n                } else {\n                    showGalleries();\n                }\n\n                $scope.$broadcast('scroll.infiniteScrollComplete');\n                $scope.$broadcast('scroll.refreshComplete');\n                vm.loading = false;\n\n            }).catch(function () {\n                if (vm.data.length === 0) {\n                    showErrorView();\n                }\n                isMoreData = false;\n                $scope.$broadcast('scroll.refreshComplete');\n            });\n        }\n\n        vm.onLoadMore = function () {\n            loadFeed();\n        };\n\n        vm.moreDataCanBeLoaded = function () {\n            return isMoreData;\n        };\n\n        vm.showLoadingView = function () {\n            return isLoadingViewShown;\n        };\n\n        vm.showGalleries = function () {\n            return isGalleriesViewShown;\n        };\n\n        vm.showErrorView = function () {\n            return isErrorViewShown;\n        };\n\n        vm.showEmptyView = function () {\n            return isEmptyViewShown;\n        };\n\n        vm.onReload = function () {\n            vm.params.page = 0;\n            vm.data        = [];\n            showLoading();\n            loadFeed();\n            $scope.$broadcast('scroll.refreshComplete');\n        };\n\n        vm.openProfile = function (user) {\n            console.log('user', user);\n            $state.go('tab.homeProfile', {username: user.username})\n        };\n\n\n        vm.follow = function (user) {\n\n            user.loading = true;\n            User.follow(user.userObj.id).then(function (resp) {\n                console.log('Follow result', resp);\n                user.isFollow = (resp === 'follow') ? true : false;\n                if (resp == 'follow') {\n                    user.followersTotal += 1;\n                }\n                if (resp == 'unfollow') {\n                    user.followersTotal -= 1;\n                }\n                user.loading = false;\n            });\n\n\n        }\n    }\n\n})();\n(function () {\n    'use strict';\n\n    angular.module('app.main').controller('UserMergeCtrl', UserMergeController);\n\n    function UserMergeController(Auth, $rootScope, AppConfig, Facebook, $state, Toast, UserForm) {\n        var vm        = this;\n        vm.formFields = UserForm.register;\n\n        init();\n        function init() {\n            if ($rootScope.tempUser) {\n                vm.form = {\n                    email   : $rootScope.tempUser.attributes.email,\n                    username: $rootScope.tempUser.attributes.username,\n                    password: ''\n                };\n            } else {\n                $state.go('user.intro', {clear: true});\n            }\n        }\n\n        vm.submit = function (rForm, form) {\n\n            console.log(rForm);\n            console.table(form);\n            if (vm.form.password !== '') {\n                console.log(form);\n                Auth.logIn(form).then(function (user) {\n                    console.log(user);\n                    $rootScope.currentUser = user;\n                    if (Auth.getLoggedUser()) {\n                        Facebook.link(Parse.User.current()).then(function (resp) {\n                            console.log(resp);\n                            $state.go(AppConfig.routes.home, {\n                                clear: true\n                            });\n                        }).catch(function (resp) {\n                            console.log(resp);\n                            Toast.alert({\n                                title: 'Ops',\n                                text : resp.message\n                            });\n                        });\n                    }\n\n\n                }).catch(function (resp) {\n                    Toast.alert({\n                        title: 'Ops',\n                        text : resp.message\n                    });\n                });\n            } else {\n                Toast.alert({\n                    title: ('Invalid form'),\n                    text : ('Please enter your email')\n                });\n            }\n\n        };\n\n    }\n\n\n})();\n\n(function () {\n  'use strict';\n\n  /**\n   * @ngdoc directive\n   * @name recoveryPass\n   *\n   * @description\n   * _Please update the description and restriction._\n   *\n   * @restrict E\n   * */\n\n  angular\n    .module('app.main')\n    .directive('recoveryPass', recoveryPassDirective);\n\n  function recoveryPassDirective(User, $ionicPopup, Loading, Toast) {\n    return {\n      restrict: 'A',\n      scope: {\n        login: '@',\n        register: '@',\n      },\n      link: function ($scope, elem) {\n\n        elem.bind('click', openModal);\n\n        function openModal() {\n\n          $scope.form = {\n            recovery: ''\n          };\n\n          $scope.erro = '';\n\n          $scope.text = {\n            button: (''),\n            input: ('Email')\n          };\n\n          $ionicPopup\n            .show({\n              scope: $scope,\n              template: '<div class=\"popup-recovery\"><form name=\"form.recovery\" form-manager><label class=\"item item-input\"><i class=\"icon ion-email placeholder-icon\"></i><input type=\"email\" ng-model=\"email\" id=\"email\" name=\"email\" placeholder=\"{{ text.input }}\" required ng-maxlength=\"80\"></label><span class=\"error-msg\">{{erro}}</span></form></div>',\n              title: ('A new password will be sent to your e-mail address'),\n              buttons: [{\n                text: ('Cancel'),\n                type: 'button-calm'\n              }, {\n                text: ('Send'),\n                type: 'button-positive',\n                onTap: function (e) {\n                  if ($scope.form.recovery.$valid) {\n                    return $scope.form.recovery.email.$viewValue;\n                  } else {\n                    //não permite o usuário fechar até ele digitar o email\n                    e.preventDefault();\n                    $scope.erro = ('Invalid Email');\n                  }\n                }\n              }]\n            })\n            .then(function (res) {\n              if (!angular.isUndefined(res)) {\n                var email = res;\n\n                console.log(res);\n\n                Loading.start();\n\n                User\n                  .forgot(email)\n                  .then(function (resp) {\n                    console.log(resp);\n                    Toast.alert({\n                      login: ('Forgot your password'),\n                      text: ('Access your accout mail')\n                    });\n                    Loading.end();\n                  })\n                  .catch(function (resp) {\n                    Toast.alert({\n                      login: 'Ops',\n                      text: resp\n                    });\n                    Loading.end();\n                  });\n              }\n            });\n\n        }\n      }\n    };\n  }\n\n\n})();\n\n(function () {\n  'use strict';\n  /**\n   * @ngdoc controller\n   * @name UserRecoveryPassCtrl\n   *\n   * @description\n   * _Please update the description and dependencies._\n   *\n   * @requires $scope\n   * */\n  angular\n    .module('app.main')\n    .controller('UserRecoveryPassCtrl', UserRecoveryPassController);\n\n  function UserRecoveryPassController(User, Toast) {\n    var vm = this;\n    vm.form = {};\n    vm.submitForgot = submitForgot;\n\n    function submitForgot() {\n      User\n        .forgot(vm.form)\n        .then(function (resp) {\n          console.log(resp);\n        })\n        .catch(function (resp) {\n          Toast.alert('Ops', resp);\n        });\n    }\n  }\n\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('app.main').controller('WalkthroughCtrl', WalkthroughController);\n\n    function WalkthroughController($ionicSlideBoxDelegate, $scope, $ionicPlatform, $cordovaSplashscreen) {\n        var vm              = this;\n        var currentPlatform = window.ionic.Platform.platform();\n        vm.slideIndex       = 0;\n\n        vm.slideChanged = function (index) {\n            vm.slideIndex = index;\n        };\n        vm.next         = function () {\n            $ionicSlideBoxDelegate.next();\n        };\n        vm.previous     = function () {\n            $ionicSlideBoxDelegate.previous();\n        };\n\n        if (currentPlatform) {\n            vm.device = (currentPlatform === 'android') ? 'android' : 'iphone';\n        } else {\n            vm.device = 'android';\n        }\n\n        vm.slides                          = [{\n            text: 'STEP1',\n            img : 'img/intro1.jpg'\n        }, {\n            text: 'STEP2',\n            img : 'img/intro2.jpg'\n        }, {\n            text: 'STEP3',\n            img : 'img/intro3.jpg'\n        }, {\n            text: 'STEP4',\n            img : 'img/intro4.jpg'\n        }, {\n            text: 'STEP5',\n            img : 'img/intro5.jpg'\n        }\n        ];\n        window.localStorage['walkthrough'] = true;\n\n        $scope.$on('$ionicView.loaded', function () {\n            $ionicPlatform.ready(function () {\n                if (navigator && navigator.splashscreen) {\n                    $cordovaSplashscreen.hide();\n                    window.StatusBar.styleLightContent()\n                }\n            });\n        });\n\n    }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('ion-photo')\n    .directive('caman', camanDirective);\n\n  function camanDirective(CamanJs, $timeout) {\n    return {\n      restrict: 'A',\n      scope: {\n        name: '=',\n        image: '=',\n        filter: '=',\n        loading: '='\n      },\n      template: '<img ng-src=\"{{ image }}\" id=\"{{ name }}\">',\n      link: camanDirectiveLink\n    };\n\n    function camanDirectiveLink($scope) {\n      $scope.loading = true;\n      $timeout(function () {\n        CamanJs\n          .effect($scope.name, $scope.filter)\n          .then(function () {\n            $scope.loading = false;\n          });\n      }, 500);\n    }\n  }\n})();\n(function () {\n  'use strict';\n\n  angular\n    .module('ion-photo')\n    .directive('ionCrop', ionCropDirective);\n\n  function ionCropDirective($jrCrop, $translate, $ionicActionSheet) {\n\n    return {\n      restrict: 'A',\n      scope: {\n        ngModel: '=',\n        option: '=',\n        cropSave: '&'\n      },\n      template: '<div><input type=\"file\" id=\"browseBtn\" image=\"image\" accept=\"image/*\" style=\"display: none\"/></div>',\n      link: ionCropLink\n    };\n\n    function ionCropLink($scope, element) {\n\n      // Triggered on a button click, or some other target\n      $scope.action = action;\n      element.bind('click', getElem);\n      $scope.crop = crop;\n      angular.element(document.getElementById('browseBtn'))\n        .on('change', fileUpload);\n\n\n      function getElem() {\n        document.getElementById('browseBtn')\n          .click();\n      }\n\n      function action() {\n\n        // Show the action sheet\n        $ionicActionSheet.show({\n          buttons: [{\n            text: '<i class=\"icon ion-camera\"></i>' + ('Photo Camera')\n          }, {\n            text: '<i class=\"icon ion-images\"></i> ' + ('Photo Album')\n          }],\n          //destructiveText:  ('Delete'),\n          titleText: ('Change Image'),\n          cancelText: ('Cancel'),\n          cancel: function () {\n            // add cancel code..\n          },\n          buttonClicked: function (index) {\n\n            if (index === 0) {\n              console.log('Photo Camera');\n            }\n            // Photo Album\n            if (index === 1) {\n              document.getElementById('browseBtn')\n                .click();\n            }\n            return true;\n          }\n        });\n\n      }\n\n      function fileUpload(e) {\n\n        var file = e.target.files[0];\n        var reader = new FileReader();\n        reader.readAsDataURL(file);\n\n        reader.onload = function (event) {\n          var image = event.target.result;\n          $scope.crop(image);\n        };\n\n        // Clear input file\n        angular.element(document.getElementById('browseBtn')).val('');\n\n      }\n\n      function crop(image) {\n\n        console.log($scope.option);\n\n        $jrCrop\n          .crop({\n            url: image,\n            width: $scope.option ? $scope.option.width : 200,\n            height: $scope.option ? $scope.option.height : 200,\n            cancelText: ('Cancel'),\n            chooseText: ('Save')\n          })\n          .then(function (canvas) {\n            var image = canvas.toDataURL();\n            //            var name = $scope.option ? $scope.option.name : 'thumb';\n            //            var filename = ($scope.option ? $scope.option.name : '') + '_' + name + window.Number(new window.Date() + '.jpg';\n\n            //var file = base64ToBlob(image.replace('data:image/png;base64,', ''), 'image/jpeg');\n            //            file.name = filename;\n\n            //upload(file);\n\n            console.log(image);\n            $scope.ngModel = image;\n\n\n          });\n\n      }\n    }\n  }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('ion-photo').directive('photoShare', photoShareDirective);\n\n    function photoShareDirective($state, AppConfig, $rootScope, $ionicModal, Loading, PhotogramSetting, PhotoService) {\n        return {\n            restrict: 'A',\n            link: photoShareLink,\n            template: ''\n        };\n\n        function photoShareLink($scope, elem, attr) {\n            var path = AppConfig.path;\n\n            elem.bind('click', open);\n\n            function open() {\n                console.log('Open share');\n                var option = {\n                    crop: PhotogramSetting.get('imageCrop'),\n                    allowEdit: PhotogramSetting.get('imageEdit'),\n                    filter: true,\n                    //filter: PhotogramSetting.get('imageFilter'),\n                    allowRotation: PhotogramSetting.get('imageRotation'),\n                    quality: PhotogramSetting.get('imageQuality'),\n                    correctOrientation: PhotogramSetting.get('imageEdit'),\n                    targetWidth: PhotogramSetting.get('imageWidth'),\n                    targetHeight: PhotogramSetting.get('imageHeight'),\n                    saveToPhotoAlbum: PhotogramSetting.get('imageSaveAlbum')\n                };\n                console.log(option);\n\n                PhotoService\n                    .open(option)\n                    .then(modalPost)\n                    .catch(goHome);\n            }\n\n\n            function goHome() {\n                console.warn('Deu erro');\n                $state.go('photogram.home');\n            }\n\n            function modalPost(image) {\n                $scope.closePost  = closeModalPost;\n                $scope.submitPost = submitPost;\n                $scope.form       = {\n                    title: '',\n                    location: '',\n                    photo: image,\n                    geo: false\n                };\n\n                $ionicModal\n                    .fromTemplateUrl(path + '/module/share/photogram.post.modal.html', {\n                        scope: $scope,\n                        focusFirstInput: true\n                    })\n                    .then(function (modal) {\n                        $scope.form.photo = image;\n                        $scope.modalPost  = modal;\n                        $scope.modalPost.show();\n                    });\n\n                function closeModalPost() {\n                    $scope.modalPost.hide();\n                    $scope.modalPost.remove();\n                    Loading.end();\n                }\n\n                function submitPost(resp) {\n                    var form = angular.copy(resp);\n                    console.log(form);\n                    Loading.start();\n                    Photogram\n                        .post(form)\n                        .then(function () {\n                            closeModalPost();\n                            $rootScope.$emit('filterModal:close');\n                            $rootScope.$emit('PhotogramHome:reload');\n                        });\n                }\n            }\n        }\n\n    }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('ion-photo')\n    .directive('photoFilterCarousel', photoFilterCarouselDirective);\n\n  function photoFilterCarouselDirective(CamanJs, config) {\n    return {\n      restrict: 'E',\n      scope: {\n        image: '=',\n        apply: '='\n      },\n      templateUrl: config.path + '/view/photo.filter.carousel.html',\n      link: function ($scope) {\n        $scope.filters = CamanJs.filters;\n        $scope.applyFilter = $scope.apply;\n      }\n    };\n  }\n\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('ion-photo')\n    .directive('photoFilter', photoFilterDirective);\n\n  function photoFilterDirective(config, CamanJs) {\n    return {\n      restrict: 'E',\n      scope: {\n        image: '='\n      },\n      templateUrl: config.path + '/view/photo.filter.html',\n      link: function ($scope, elem) {\n        $scope.applyFilter = function (elem, effect) {\n          $scope.loading = true;\n          if (effect) {\n            CamanJs\n              .effect(elem, effect, true)\n              .then(function (resp) {\n                $scope.loading = false;\n              });\n          }\n        };\n      }\n    };\n  }\n})();\n\n(function () {\n  'use strict';\n\n\n  angular\n    .module('ion-photo')\n    .factory('CamanJs', CamanJsFactory);\n\n  function CamanJsFactory($q) {\n    var Caman = window.Caman;\n    var filters = [\n      'normal',\n      'vintage',\n      'lomo',\n      'clarity',\n      'sinCity',\n      'sunrise',\n      'crossProcess',\n      'orangePeel',\n      'love',\n      'grungy',\n      'jarques',\n      'pinhole',\n      'oldBoot',\n      'glowingSun',\n      'hazyDays',\n      'herMajesty',\n      'nostalgia',\n      'hemingway',\n      'concentrate'\n    ];\n\n    return {\n      filters: filters,\n      effect: filter,\n      reset: resetEffect\n    };\n\n    function filter(elem, effect, status) {\n      var defer = $q.defer();\n      var image = window.document.getElementById(elem);\n\n      if (image) {\n        Caman(image, function () {\n          if (effect === 'normal') {\n            this.revert();\n            this.render(function () {\n              defer.resolve(effect);\n            });\n          }\n\n          if (effect in this) {\n            this[effect]();\n\n            if (status) {\n              this.revert();\n            }\n            this.render(function () {\n              defer.resolve(effect);\n            });\n          }\n\n        });\n      } else {\n        defer.reject();\n      }\n      return defer.promise;\n    }\n\n    function resetEffect(elem) {\n\n      var defer = $q.defer();\n      var image = window.document.getElementById(elem);\n\n      Caman(image, function () {\n        this.revert();\n        defer.resolve(true);\n      });\n\n      return defer.promise;\n    }\n  }\n})();\n(function () {\n    'use strict';\n    /**\n     * jr-crop - A simple ionic plugin to crop your images.\n     * @version 1.0.0\n     * @link https://github.com/JrSchild/jr-crop\n     * @author Joram Ruitenschild\n     * @license MIT\n     */\n    angular.module('jrCrop', [])\n           .factory('$jrCrop', function ($ionicModal, $rootScope, $q) {\n\n               var template = '<div class=\"jr-crop modal\">' +\n                   '<div class=\"jr-crop-center-container\">' +\n                   '<div class=\"jr-crop-img\" ng-style=\"{width: width + \\'px\\', height: height + \\'px\\'}\"></div>' +\n                   '</div>' +\n                   '<div class=\"jr-crop-center-container\">' +\n                   '<div class=\"jr-crop-select\" style=\"overflow: hidden\" ng-style=\"{width: width + \\'px\\', height: height + \\'px\\'}\"></div>' +\n                   '</div>' +\n                   '<div class=\"bar bar-footer bar-dark jr-crop-footer\">' +\n                   '<button class=\"button button-clear\" ng-click=\"cancel()\">{{cancelText}}</button>' +\n                   '<div class=\"title\">{{title}}</div>' +\n                   '<button class=\"button button-clear\" ng-click=\"crop()\">{{chooseText}}</button>' +\n                   '</div>' +\n                   '</div>';\n\n               var jrCropController = ionic.views.View.inherit({\n\n                   promise  : null,\n                   imgWidth : null,\n                   imgHeight: null,\n\n                   // Elements that hold the cropped version and the full\n                   // overlaying image.\n                   imgSelect: null,\n                   imgFull  : null,\n\n                   // Values exposed by scaling and moving. Needed\n                   // to calculate the result of cropped image\n                   posX  : 0,\n                   posY  : 0,\n                   scale : 1,\n                   rotate: 0,\n\n                   last_scale : 1,\n                   last_posX  : 0,\n                   last_posY  : 0,\n                   last_rotate: 0,\n\n                   initialize: function (options) {\n                       var self = this;\n\n                       self.options = options;\n                       self.promise = $q.defer();\n                       self.loadImage().then(function (elem) {\n                           self.imgWidth  = elem.naturalWidth;\n                           self.imgHeight = elem.naturalHeight;\n\n                           self.options.modal.el.querySelector('.jr-crop-img')\n                               .appendChild(self.imgSelect = elem.cloneNode());\n                           self.options.modal.el.querySelector('.jr-crop-select')\n                               .appendChild(self.imgFull = elem.cloneNode());\n\n                           self.bindHandlers();\n                           self.initImage();\n                       });\n\n                       // options === scope. Expose actions for modal.\n                       self.options.cancel = this.cancel.bind(this);\n                       self.options.crop   = this.crop.bind(this);\n                   },\n\n                   /**\n                    * Init the image in a center position\n                    */\n                   initImage: function () {\n                       if (this.options.height < this.imgHeight || this.options.width < this.imgWidth) {\n                           var imgAspectRatio    = this.imgWidth / this.imgHeight;\n                           var selectAspectRatio = this.options.width / this.options.height;\n\n                           if (selectAspectRatio > imgAspectRatio) {\n                               this.scale = this.last_scale = this.options.width / this.imgWidth;\n                           } else {\n                               this.scale = this.last_scale = this.options.height / this.imgHeight;\n                           }\n                       }\n\n                       var centerX = (this.imgWidth - this.options.width) / 2;\n                       var centerY = (this.imgHeight - this.options.height) / 2;\n\n                       this.posX = this.last_posX = -centerX;\n                       this.posY = this.last_posY = -centerY;\n\n                       this.setImageTransform();\n                   },\n\n                   cancel: function () {\n                       var self = this;\n\n                       self.options.modal.remove().then(function () {\n                           self.promise.reject('canceled');\n                       });\n                   },\n\n                   /**\n                    * This is where the magic happens\n                    */\n                   bindHandlers: function () {\n                       var self                                             = this,\n\n                           min_pos_x                                        = 0, min_pos_y = 0,\n                           max_pos_x                                        = 0, max_pos_y = 0,\n                           transforming_correctX = 0, transforming_correctY = 0,\n\n                           scaleMax                                         = 1, scaleMin,\n                           image_ratio                                      = self.imgWidth / self.imgHeight,\n                           cropper_ratio                                    = self.options.width / self.options.height;\n\n                       if (cropper_ratio < image_ratio) {\n                           scaleMin = self.options.height / self.imgHeight;\n                       } else {\n                           scaleMin = self.options.width / self.imgWidth;\n                       }\n\n                       function setPosWithinBoundaries() {\n                           calcMaxPos();\n                           if (self.posX > min_pos_x) {\n                               self.posX = min_pos_x;\n                           }\n                           if (self.posX < max_pos_x) {\n                               self.posX = max_pos_x;\n                           }\n                           if (self.posY > min_pos_y) {\n                               self.posY = min_pos_y;\n                           }\n                           if (self.posY < max_pos_y) {\n                               self.posY = max_pos_y;\n                           }\n                       }\n\n                       /**\n                        * Calculate the minimum and maximum positions.\n                        * This took some headaches to write, good luck\n                        * figuring this out.\n                        */\n                       function calcMaxPos() {\n                           // Calculate current proportions of the image.\n                           var currWidth  = self.scale * self.imgWidth;\n                           var currHeight = self.scale * self.imgHeight;\n\n                           // Images are scaled from the center\n                           min_pos_x = (currWidth - self.imgWidth) / 2;\n                           min_pos_y = (currHeight - self.imgHeight) / 2;\n                           max_pos_x = -(currWidth - min_pos_x - self.options.width);\n                           max_pos_y = -(currHeight - min_pos_y - self.options.height);\n                       }\n\n                       // Based on: http://stackoverflow.com/questions/18011099/pinch-to-zoom-using-hammer-js\n                       var options = {\n                           prevent_default_directions: ['left', 'right', 'up', 'down']\n                       };\n                       ionic.onGesture('touch transform drag dragstart dragend rotate', function (e) {\n                           switch (e.type) {\n                               case 'touch':\n                                   self.last_scale = self.scale;\n                                   break;\n                               case 'drag':\n                                   self.posX = self.last_posX + e.gesture.deltaX - transforming_correctX;\n                                   self.posY = self.last_posY + e.gesture.deltaY - transforming_correctY;\n                                   setPosWithinBoundaries();\n                                   break;\n                               case 'transform':\n                                   self.scale = Math.max(scaleMin, Math.min(self.last_scale * e.gesture.scale, scaleMax));\n                                   setPosWithinBoundaries();\n                                   break;\n                               case 'dragend':\n                                   self.last_posX = self.posX;\n                                   self.last_posY = self.posY;\n                                   break;\n                               case 'dragstart':\n                                   self.last_scale = self.scale;\n\n                                   // After scaling, hammerjs needs time to reset the deltaX and deltaY values,\n                                   // when the user drags the image before this is done the image will jump.\n                                   // This is an attempt to fix that.\n                                   if (e.gesture.deltaX > 1 || e.gesture.deltaX < -1) {\n                                       transforming_correctX = e.gesture.deltaX;\n                                       transforming_correctY = e.gesture.deltaY;\n                                   } else {\n                                       transforming_correctX = 0;\n                                       transforming_correctY = 0;\n                                   }\n                                   break;\n                               case 'rotate':\n                                   self.rotate = self.last_rotate + e.gesture.rotation;\n                                   break;\n                           }\n\n                           self.setImageTransform();\n\n                       }, self.options.modal.el, options);\n                   },\n\n                   setImageTransform: function () {\n                       var self = this;\n\n                       var transform =\n                               'translate3d(' + self.posX + 'px,' + self.posY + 'px, 0) ' +\n                               'scale3d(' + self.scale + ',' + self.scale + ', 1)' +\n                               'rotate(' + self.rotate + 'deg)';\n\n                       self.imgSelect.style[ionic.CSS.TRANSFORM] = transform;\n                       self.imgFull.style[ionic.CSS.TRANSFORM]   = transform;\n                   },\n\n                   /**\n                    * Calculate the new image from the values calculated by\n                    * user input. Return a canvas-object with the image on it.\n                    *\n                    * Note: It doesn't actually downsize the image, it only returns\n                    * a cropped version. Since there's inconsistenties in image-quality\n                    * when downsizing it's up to the developer to implement this. Preferably\n                    * on the server.\n                    */\n                   crop: function () {\n                       var canvas  = document.createElement('canvas');\n                       var context = canvas.getContext('2d');\n\n                       // Canvas size is original proportions but scaled down.\n                       canvas.width  = this.options.width / this.scale;\n                       canvas.height = this.options.height / this.scale;\n\n                       // The full proportions\n                       var currWidth  = this.imgWidth * this.scale;\n                       var currHeight = this.imgHeight * this.scale;\n\n                       // Because the top/left position doesn't take the scale of the image in\n                       // we need to correct this value.\n                       var correctX = (currWidth - this.imgWidth) / 2;\n                       var correctY = (currHeight - this.imgHeight) / 2;\n\n                       var sourceX = (this.posX - correctX) / this.scale;\n                       var sourceY = (this.posY - correctY) / this.scale;\n\n                       //see http://creativejs.com/2012/01/day-10-drawing-rotated-images-into-canvas/\n                       //move the origin\n                       context.translate(sourceX, sourceY);\n                       //move to center and rotate\n                       context.translate(this.imgWidth / 2, this.imgHeight / 2);\n                       context.rotate(this.rotate * Math.PI / 180);\n\n                       context.drawImage(this.imgFull, this.imgWidth / 2 * -1, this.imgHeight / 2 * -1);\n\n                       this.options.modal.remove();\n                       this.promise.resolve(canvas);\n                   },\n\n                   /**\n                    * Load the image and return the element.\n                    * Return Promise that will fail when unable to load image.\n                    */\n                   loadImage: function () {\n                       var promise = $q.defer();\n\n                       // Load the image and resolve with the DOM node when done.\n                       angular.element('<img />')\n                              .bind('load', function (e) {\n                                  promise.resolve(this);\n                              })\n                              .bind('error', promise.reject)\n                              .prop('src', this.options.url);\n\n                       // Return the promise\n                       return promise.promise;\n                   }\n               });\n\n               return {\n                   defaultOptions: {\n                       width      : 0,\n                       height     : 0,\n                       aspectRatio: 0,\n                       cancelText : 'Cancel',\n                       chooseText : 'Choose'\n                   },\n\n                   crop: function (options) {\n                       options = this.initOptions(options);\n\n                       var scope = $rootScope.$new(true);\n\n                       ionic.extend(scope, options);\n\n                       scope.modal = $ionicModal.fromTemplate(template, {\n                           scope: scope\n                       });\n\n                       // Show modal and initialize cropper.\n                       return scope.modal.show().then(function () {\n                           return (new jrCropController(scope)).promise.promise;\n                       });\n                   },\n\n                   initOptions: function (_options) {\n                       var options;\n\n                       // Apply default values to options.\n                       options = ionic.extend({}, this.defaultOptions);\n                       options = ionic.extend(options, _options);\n\n                       if (options.aspectRatio) {\n\n                           if (!options.width && options.height) {\n                               options.width = 200;\n                           }\n\n                           if (options.width) {\n                               options.height = options.width / options.aspectRatio;\n                           } else if (options.height) {\n                               options.width = options.height * options.aspectRatio;\n                           }\n                       }\n\n                       return options;\n                   }\n               };\n           });\n})();\n(function () {\n    'use strict';\n    angular.module('ion-photo').factory('PhotoFilter', PhotoFilterFactory);\n\n    function PhotoFilterFactory($rootScope, $q, $ionicModal) {\n\n        return {\n            load: modalFilter\n        };\n\n        function modalFilter(image) {\n            var defer    = $q.defer();\n            var template = '<ion-modal-view class=\"modal-capture\"><ion-header-bar class=\"bar-light\"><button class=\"button button-clear button-icon ion-ios-close-empty\" ng-click=\"close()\"></button><div class=\"title text-left\">{{ \\'ION-PHOTO.FILTERS\\' | translate }}</div><button class=\"button button-clear\" ng-click=\"submitCapture()\">{{ \\'ION-PHOTO.NEXT\\' | translate }}</button></ion-header-bar><ion-content scroll=\"false\"><photo-filter image=\"form.photo\"></photo-filter></ion-content></ion-modal-view>';\n            var scope    = $rootScope.$new(true);\n\n            scope.form = {\n                photo: image\n            };\n\n            scope.modal = $ionicModal.fromTemplate(template, {\n                scope: scope\n            });\n\n            scope.modal.show();\n\n\n            scope.submitCapture = function () {\n                var canvas  = window.document.getElementById('image');\n                var dataUrl = canvas.toDataURL();\n                scope.close();\n                defer.resolve(dataUrl);\n            };\n\n            scope.close = function () {\n                scope.modal.hide();\n            };\n\n            // Cleanup the modal when we're done with it!\n            scope.$on('$destroy', function () {\n                scope.modal.remove();\n            });\n\n\n            return defer.promise;\n\n        }\n\n    }\n})();\n\n(function () {\n    'use strict';\n\n    angular.module('ion-photo').factory('PhotoService', PhotoServiceFactory);\n\n    function PhotoServiceFactory($ionicActionSheet, $translate, AppConfig, Share,$cordovaActionSheet, $jrCrop, $rootScope, $ionicModal, $cordovaCamera, $cordovaCapture, $q) {\n\n        // Default Setting\n        var tempImage;\n        var cordova = window.cordova;\n        var setting = {\n            jrCrop            : true,\n            quality           : 90,\n            allowEdit         : false,\n            filter            : true,\n            correctOrientation: true,\n            targetWidth       : 300,\n            targetHeight      : 300,\n            saveToPhotoAlbum  : false,\n            allowRotation     : false,\n            aspectRatio       : 0\n        };\n\n        return {\n            open  : openModal,\n            crop  : cropModal,\n            filter: filterModal,\n            share : shareModal,\n        };\n\n        function openModal(option) {\n            var defer       = $q.defer();\n            var options     = {\n                quality           : 80,\n                aspectRatio       : 0,\n                allowRotation     : false,\n                allowEdit         : true,\n                correctOrientation: true,\n                targetWidth       : 640,\n                targetHeight      : 640,\n                saveToPhotoAlbum  : true,\n                destinationType   : window.cordova ? Camera.DestinationType.DATA_URL : null,\n                encodingType      : window.cordova ? Camera.EncodingType.JPEG : null,\n                popoverOptions    : window.cordova ? CameraPopoverOptions : null,\n            };\n            var buttons     = [{\n                text: '<i class=\"icon ion-ios-camera\"></i>' + $translate.instant('captureLibrary')\n            }, {\n                text: '<i class=\"icon ion-images\"></i>' + $translate.instant('capturePhoto')\n            },\n                // {text: '<i class=\"icon ion-ios-videocam\"></i>' + $translate.instant('ION-PHOTO.VIDEO')}\n            ];\n            var actionSheet = $ionicActionSheet.show({\n                buttons      : buttons,\n                titleText    : $translate.instant('submit'),\n                cancelText   : $translate.instant('cancel'),\n                cancel       : buttonCancel,\n                buttonClicked: buttonClicked\n            });\n\n            function buttonClicked(index) {\n                console.log(index);\n                actionSheet();\n                capture(index, options)\n                    .then(filterModal)\n                    .then(function (resp) {\n                        console.log('Final rest');\n                        defer.resolve(resp);\n                    })\n                    .catch(buttonCancel);\n            }\n\n\n            function buttonCancel(resp) {\n                actionSheet(resp);\n            }\n\n            return defer.promise;\n        }\n\n        function cropModal(image) {\n            var defer = $q.defer();\n\n            $jrCrop.crop({\n                url          : image,\n                aspectRatio  : setting.aspectRatio ? setting.aspectRatio : false,\n                allowRotation: setting.allowRotation ? setting.allowRotation : false,\n                width        : setting.width ? setting.width : setting.targetWidth,\n                height       : setting.height ? setting.height : setting.targetHeight,\n                cancelText   : $translate.instant('cancel'),\n                chooseText   : $translate.instant('submit')\n            }).then(function (canvas) {\n                defer.resolve(canvas.toDataURL());\n            }).catch(defer.reject);\n\n            return defer.promise;\n        }\n\n        function shareModal(image) {\n            var template =\n                    '<ion-modal-view class=\"modal-share\"> <ion-header-bar class=\"bar-dark\"> <div class=\"title\">{{ \\'submit\\' | translate }}</div> <button class=\"button button-positive\" ng-click=\"modal.hide()\"> <i class=\"icon ion-arrow-right-b\"></i> </button> </ion-header-bar> <ion-content ng-cloak> <div id=\"image\"> <img ng-src=\"{{form.photo}}\"> <div class=\"title\">{{ form.title }}</div></div> <ul class=\"list\"> <li class=\"padding\"> <button ng-repeat=\"social in sociais\" ng-click=\"share(form, social)\"class=\"button button-block button-{{ social }}\"><i class=\"icon ion-social-{{ social }}\"></i>{{ social | uppercase }} </button> </li> </ul> </ion-content> </ion-modal-view>';\n\n            if (image === undefined) return false;\n            var scope   = $rootScope.$new(true);\n            var socials = [\n                'facebook',\n                'instagram',\n                'whatsapp',\n                'twitter'\n            ];\n            //image = image.attributes;\n\n            scope.sociais = socials;\n            scope.share   = shareSocial;\n            scope.form    = {\n                title: '',\n                photo: image\n            };\n\n            scope.modal = $ionicModal.fromTemplate(template, {\n                scope: scope\n            });\n            scope.modal.show();\n\n\n            function shareSocial(social, form) {\n                console.log('share', social, form);\n                Share.share(social, {\n                    text : form.title,\n                    image: form.photo,\n                    link : AppConfig.app.url\n                });\n            }\n\n\n        }\n\n        function filterModal(image) {\n            var defer = $q.defer();\n\n            function openFilter(image) {\n                var templateFilter = '<ion-modal-view class=\"modal-capture\"><ion-header-bar class=\"bar-light\"><button class=\"button button-clear button-icon ion-ios-arrow-thin-left\" ng-click=\"cropImage()\"></button><div class=\"title\">{{ \\'ION-PHOTO.FILTERS\\' | translate }}</div><button class=\"button button-icon \" ng-click=\"submitFilter()\"><i class=\"icon ion-ios-arrow-thin-right\"></i></button></ion-header-bar><ion-content><photo-filter image=\"form.photo\"></photo-filter></ion-content></ion-modal-view>';\n                var scope          = $rootScope.$new(true);\n                scope.closeFilter  = closeFilter;\n                scope.submitFilter = submitFilter;\n                tempImage          = image;\n                scope.form         = {\n                    photo: image\n                };\n\n                scope.modalFilter = $ionicModal.fromTemplate(templateFilter, {\n                    scope: scope\n                });\n\n                scope.cropImage = function () {\n                    scope.modalFilter.remove();\n                    cropModal(tempImage)\n                        .then(openFilter);\n                };\n\n                scope.modalFilter.show();\n\n                function closeFilter() {\n                    defer.reject();\n                    scope.modalFilter.hide();\n                }\n\n                function submitFilter() {\n                    var canvas  = window.document.getElementById('image');\n                    var dataUrl = canvas.toDataURL();\n                    scope.modalFilter.remove();\n                    defer.resolve(dataUrl);\n                }\n\n            }\n\n            openFilter(image);\n\n            return defer.promise;\n        }\n\n\n        function capture(type, options) {\n            var defer = $q.defer();\n\n            // CAMERA\n            if (type === 0) {\n                getPicture(0);\n            }\n\n            // GALLERY\n            if (type === 1) {\n                getPicture(1);\n            }\n\n            // Video\n            if (type === 2) {\n                getVideo();\n            }\n\n            function getPicture(method) {\n                if (method === 0 && cordova) options.sourceType = Camera.PictureSourceType.CAMERA;\n                if (method === 1 && cordova) options.sourceType = Camera.PictureSourceType.PHOTOLIBRARY;\n\n                if (cordova) {\n                    $cordovaCamera.getPicture(options).then(defer.resolve, defer.reject);\n                } else {\n                    var fileInput = angular.element('<input type=\"file\" accept=\"image/x-png, image/gif, image/jpeg\" max-size=\"2048\" />');\n                    fileInput[0].click();\n                    fileInput.on('change', function (evt) {\n                        tempImage     = evt.currentTarget.files[0];\n                        var reader    = new FileReader();\n                        reader.onload = function (evt) {\n                            defer.resolve(evt.target.result);\n                        };\n                        reader.readAsDataURL(tempImage);\n                    });\n                }\n            }\n\n            function getVideo() {\n                $cordovaCapture.captureVideo({\n                    limit   : 1,\n                    duration: 5\n                }).then(function (mediaFiles) {\n                    tempImage = mediaFiles[0].fullPath;\n                    defer.resolve(tempImage);\n                }, defer.reject);\n            }\n\n\n            return defer.promise;\n        }\n\n        function show(params) {\n\n            var defer = $q.defer();\n\n            if (window.cordova) {\n\n                var options = {\n                    title                    : params.title,\n                    buttonLabels             : _.map(params.options, function (item) {return item.text}),\n                    addCancelButtonWithLabel : params.cancelText,\n                    androidEnableCancelButton: true,\n                    androidTheme             : window.plugins.actionsheet.ANDROID_THEMES.THEME_HOLO_LIGHT\n                };\n\n                $cordovaActionSheet.show(options).then(function (btnIndex) {\n                    if (btnIndex !== 3) {\n                        defer.resolve(btnIndex);\n                    }\n                    defer.reject('cancel');\n                });\n\n            } else {\n                var actionSheet = $ionicActionSheet.show({\n                    buttons      : params.options,\n                    titleText    : params.title,\n                    cancelText   : params.cancelText,\n                    cancel       : function () {\n                        actionSheet();\n                    },\n                    buttonClicked: function (btnIndex) {\n                        actionSheet();\n                        if (btnIndex !== 3) {\n                            defer.resolve(btnIndex);\n                        }\n                        defer.reject('cancel');\n                    }\n                });\n\n            }\n            return defer.promise;\n        }\n\n\n\n    }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('ion-photo')\n    .factory('Video', VideoFactory);\n\n  function VideoFactory($window, $q) {\n    var deferred = $q.defer();\n    //https://devdactic.com/capture-and-store-videos-ionic/\n    // Resolve the URL to the local file\n    // Start the copy process\n    function createFileEntry(fileURI) {\n      $window.resolveLocalFileSystemURL(fileURI, function (entry) {\n        return copyFile(entry);\n      }, fail);\n    }\n\n    // Create a unique name for the videofile\n    // Copy the recorded video to the app dir\n    function copyFile(fileEntry) {\n      var name = fileEntry.fullPath.substr(fileEntry.fullPath.lastIndexOf('/') + 1);\n      var newName = makeid() + name;\n\n      $window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function (fileSystem2) {\n          fileEntry.copyTo(fileSystem2, newName, function (succ) {\n            return onCopySuccess(succ);\n          }, fail);\n        },\n        fail\n      );\n    }\n\n    // Called on successful copy process\n    // Creates a thumbnail from the movie\n    // The name is the moviename but with .png instead of .mov\n    function onCopySuccess(entry) {\n      var name = entry.nativeURL.slice(0, -4);\n      $window.PKVideoThumbnail.createThumbnail(entry.nativeURL, name + '.png', function (prevSucc) {\n        return prevImageSuccess(prevSucc);\n      }, fail);\n    }\n\n    // Called on thumbnail creation success\n    // Generates the currect URL to the local moviefile\n    // Finally resolves the promies and returns the name\n    function prevImageSuccess(succ) {\n      var correctUrl = succ.slice(0, -4);\n      correctUrl += '.MOV';\n      deferred.resolve(correctUrl);\n    }\n\n    // Called when anything fails\n    // Rejects the promise with an Error\n    function fail(error) {\n      console.log('FAIL: ' + error.code);\n      deferred.reject('ERROR');\n    }\n\n    // Function to make a unique filename\n    function makeid() {\n      var text = '';\n      var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n      for (var i = 0; i < 5; i++) {\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n      }\n      return text;\n    }\n\n    // The object and functions returned from the Service\n    return {\n      // This is the initial function we call from our controller\n      // Gets the videoData and calls the first service function\n      // with the local URL of the video and returns the promise\n      saveVideo: function (data) {\n        createFileEntry(data[0].localURL);\n        return promise;\n      }\n    };\n  }\n\n})();\n\n;(function() {\n\"use strict\";\n\nangular.module(\"ionic\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/directive/SigninModalDirective.html\",\"<ion-modal-view id=\\\"user-layout\\\" class=\\\"modal-auth bg-animate\\\" cache-view=\\\"false\\\"><ion-header-bar><h1 class=\\\"title\\\" \\ntranslate=\\\"signin\\\"></h1><a ng-click=\\\"closeModal()\\\" class=\\\"button button-icon icon ion-ios-close-empty\\\"></a>\\n</ion-header-bar><ion-content class=\\\"padding\\\" scroll=\\\"false\\\"><div class=\\\"step2\\\"><formly-form model=\\\"form\\\" \\nfields=\\\"formFields\\\" form=\\\"rForm\\\"><button class=\\\"button button-block button-outline button-light\\\" type=\\\"button\\\" \\nng-disabled=\\\"rForm.$invalid\\\" ng-click=\\\"submitLogin(rForm, form)\\\" translate=\\\"signin\\\"></button></formly-form><span \\nclass=\\\"term\\\">{{::\\'termAccept\\' | translate}} <a href=\\\"http://photogramapp.com\\\">{{::\\'terms\\' | translate}}</a></span>\\n</div></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/directive/SignupModalDirective.html\",\"<ion-modal-view id=\\\"user-layout\\\" class=\\\"modal-auth bg-animate\\\" cache-view=\\\"false\\\"><ion-header-bar><h1 class=\\\"title\\\" \\ntranslate=\\\"register\\\"></h1><a ng-click=\\\"closeModal()\\\" class=\\\"button button-icon icon ion-ios-close-empty\\\"></a>\\n</ion-header-bar><ion-content class=\\\"padding\\\" scroll=\\\"false\\\"><div class=\\\"step2\\\"><form name=\\\"myForm\\\" \\nnovalidate=\\\"novalidate\\\" ng-submit=\\\"submitRegister(myForm, form)\\\"><label class=\\\"item item-input\\\"><i \\nclass=\\\"icon icon-envelope placeholder-icon\\\"></i> <input required=\\\"required\\\" type=\\\"email\\\" name=\\\"email\\\" \\nng-model=\\\"form.email\\\" email-validator ng-model-options=\\\"{debounce: 1000}\\\" placeholder=\\\"user@example.com\\\"></label><div \\nng-if=\\\"myForm.email.$dirty\\\"><div ng-messages=\\\"myForm.email.$error\\\" class=\\\"validation-error\\\"><div ng-message=\\\"required\\\" \\ntranslate=\\\"emailRequired\\\"></div><div ng-message=\\\"email\\\" translate=\\\"emailInUse\\\"></div></div><div \\nng-messages=\\\"myForm.email.$pending\\\" class=\\\"validation-pending\\\"><div ng-message=\\\"email\\\" translate=\\\"checkingEmail\\\"></div>\\n</div></div><label class=\\\"item item-input\\\"><i class=\\\"icon icon-user placeholder-icon\\\"></i> <input required=\\\"required\\\" \\ntype=\\\"text\\\" name=\\\"username\\\" ng-model=\\\"form.username\\\" username-validator ng-minlength=\\\"4\\\" ng-maxlength=\\\"12\\\" \\nng-model-options=\\\"{debounce: 1000}\\\" ng-pattern=\\\"/^[a-zA-Z\\'. -]+$/\\\" placeholder=\\\"Your login\\\"></label><div \\nng-if=\\\"myForm.username.$dirty\\\"><div ng-messages=\\\"myForm.email.$error\\\" class=\\\"validation-error\\\"><div \\nng-message=\\\"required\\\" translate=\\\"usernameRequired\\\"></div><div ng-message=\\\"email\\\" translate=\\\"usernameInUse\\\"></div></div>\\n<div ng-messages=\\\"myForm.email.$pending\\\" class=\\\"validation-pending\\\"><div ng-message=\\\"email\\\" \\ntranslate=\\\"checkingUsername\\\"></div></div></div><label class=\\\"item item-input\\\"><i \\nclass=\\\"icon icon-lock placeholder-icon\\\"></i> <input required type=\\\"password\\\" name=\\\"password\\\" ng-model=\\\"form.password\\\" \\nplaceholder=\\\"Password\\\"></label><button class=\\\"button button-block button-outline button-light\\\" type=\\\"submit\\\" \\ntranslate=\\\"submit\\\"></button></form><span class=\\\"term\\\">{{::\\'termAccept\\' | translate}} <a href=\\\"http://photogramapp.com\\\">\\n{{::\\'terms\\' | translate}}</a></span></div></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/directive/distanceModal.html\",\"<ion-modal-view><ion-header-bar class=\\\"bar-light\\\"><div class=\\\"buttons\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-close-empty\\\" ng-click=\\\"closeDistanceModal()\\\"></button></div><div \\nclass=\\\"title\\\">{{ \\\"chooseDistanceText\\\" | translate }}</div></ion-header-bar><ion-content><ion-list><ion-item \\nclass=\\\"item item-icon-right\\\" ng-repeat=\\\"distance in distances\\\" ng-click=\\\"onDistanceSelected(distance.val)\\\" bindonce><h2\\n bo-bind=\\\"distance.text\\\"></h2><i class=\\\"icon ion-checkmark\\\" ng-show=\\\"params.distance === distance.val\\\"></i></ion-item>\\n</ion-list></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/directive/follow.modal.html\",\"<ion-modal-view class=\\\"modal-profile photogram-profile\\\"><ion-header-bar class=\\\"bar-positive\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-arrow-thin-left\\\" ng-click=\\\"closeModal()\\\"></button><div class=\\\"title\\\">\\nFollow Users</div></ion-header-bar><ion-content><div class=\\\"list\\\"><div class=\\\"item item-avatar item-button-right\\\" \\nng-repeat=\\\"item in data\\\"><img ng-src=\\\"{{ ::item.src }}\\\"><h2>{{ ::item.name }}</h2><p>{{ ::item.status }}</p><button \\nclass=\\\"button\\\" ng-click=\\\"item.follow = !item.follow\\\" ng-class=\\\"item.follow ? \\'button-positive\\' : \\'button-stable\\'\\\"><i \\nclass=\\\"icon\\\" ng-class=\\\"item.follow? \\'ion-thumbsup\\' : \\'ion-plus\\'\\\"></i></button></div></div></ion-content>\\n</ion-modal-view>\");\n$templateCache.put(\"app/directive/likeDirective.html\",\"<ion-modal-view class=\\\"modal-comment\\\"><ion-header-bar class=\\\"bar-dark\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-arrow-thin-left\\\" ng-click=\\\"closeModal()\\\"></button><div class=\\\"title\\\">\\n{{ ::\\'Likes\\' | translate }} ({{ ::likes.length }})</div></ion-header-bar><ion-content><div class=\\\"list step1\\\"><div \\nng-repeat=\\\"item in likes\\\" class=\\\"item item-avatar item-button-right\\\"><img ng-src=\\\"{{ ::item.user.img }}\\\"><h2>\\n{{ ::item.user.name }}</h2><div>{{ ::item.text }}</div><p>{{ ::item.created | amTimeAgo }}</p><button \\nclass=\\\"button button-positive button-outline\\\"><i class=\\\"icon ion-ios-plus-empty\\\"></i> {{ ::\\'Follow\\' }}</button></div>\\n</div></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/directive/photoCommentDirective.html\",\"<ion-modal-view class=\\\"modal-comment\\\"><ion-header-bar class=\\\"bar-light\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-arrow-thin-left\\\" ng-click=\\\"closeModal()\\\"></button><div class=\\\"title\\\">\\n<span translate=\\\"commentPhotoText\\\"></span>({{ comments.length }})</div></ion-header-bar><ion-content><div \\nclass=\\\"padding center\\\" ng-if=\\\"loading\\\"><ion-spinner></ion-spinner></div><ion-list class=\\\"list\\\" \\nng-show=\\\"comments.length\\\" can-swipe=\\\"true\\\"><ion-item ng-repeat=\\\"item in comments | orderBy:createdAt\\\" \\nclass=\\\"item item-avatar\\\"><img ng-src=\\\"{{ ::item.user.photo._url || \\'./img/user.png\\'}}\\\"><div class=\\\"row\\\"><h2>\\n{{ ::item.user.name }}</h2></div><div class=\\\"row\\\"><div class=\\\"text\\\">{{ ::item.text }}</div></div><div class=\\\"row\\\"><p>\\n{{ ::item.createdAt | amTimeAgo }}</p></div><div ng-if=\\\"item.user.id === currentUser.id\\\"><ion-option-button \\nclass=\\\"button-info\\\" ng-click=\\\"editComment(item)\\\" translate=\\\"edit\\\">Edit</ion-option-button><ion-option-button \\nclass=\\\"button-assertive\\\" ng-click=\\\"deleteComment(item)\\\" translate=\\\"remove\\\">Remove</ion-option-button></div></ion-item>\\n</ion-list><div class=\\\"center-ico\\\" ng-if=\\\"nocomments\\\"><i class=\\\"icon ion-ios-chatbubble-outline\\\"></i><h1 \\ntranslate=\\\"noComments\\\"></h1></div></ion-content><form name=\\\"rForm\\\" ng-submit=\\\"submitComment(rForm, form)\\\" novalidate>\\n<ion-footer-bar class=\\\"bar-stable item-input-inset message-footer\\\" keyboard-attach><label class=\\\"item-input-wrapper\\\"><i\\n class=\\\"icon ion-ios-compose-outline placeholder-icon\\\"></i><textarea mentio mentio-trigger-char=\\\"\\'@\\'\\\" \\nmentio-items=\\\"people\\\" mentio-template-url=\\\"app/mentio/people-mentions.html\\\" mentio-search=\\\"searchPeople(term)\\\" \\nmentio-select=\\\"getPeopleTextRaw(item)\\\" mentio-id=\\\"\\'theTextArea\\'\\\" ng-trim=\\\"false\\\" ng-model=\\\"form.text\\\" \\nplaceholder=\\\"Send a comment...\\\" required minlength=\\\"1\\\" maxlength=\\\"1500\\\">\\n                </textarea></label><div \\nclass=\\\"footer-btn-wrap\\\"><button class=\\\"button button-positive button-outline\\\" type=\\\"submit\\\" \\nng-disabled=\\\"!form.text || form.text === \\'\\'\\\">Publish</button></div></ion-footer-bar></form></ion-modal-view>\");\n$templateCache.put(\"app/directive/photoGridDirective.html\",\"<div class=\\\"center padding\\\" ng-if=\\\"showErrorView()\\\"><div class=\\\"error\\\"><i \\nclass=\\\"icon icon-large ion-ios-cloud-download-outline\\\"></i><p>{{ \\\"errorText\\\" | translate }}</p><button \\nclass=\\\"button button-primary\\\" ng-click=\\\"onReload()\\\">{{ \\\"tryAgainText\\\" | translate }}</button></div></div><div \\nclass=\\\"center padding\\\" ng-if=\\\"showEmptyView()\\\"><div class=\\\"error\\\"><i class=\\\"icon icon-large ion-android-alert\\\"></i><p>\\n{{ \\\"galleriesNotFoundText\\\" | translate }}</p></div></div><div class=\\\"center padding\\\" ng-if=\\\"loading\\\"><ion-spinner>\\n</ion-spinner></div><ion-refresher pulling-text=\\\"{{\\'loadingText\\'| translate}}\\\" on-refresh=\\\"onReload()\\\"></ion-refresher>\\n<div class=\\\"row animated fadeIn\\\" ng-if=\\\"$index % 3 === 0\\\" ng-repeat=\\\"image in data\\\"><div \\nclass=\\\"col col-33 item-animate1\\\" ng-if=\\\"$index < data.length\\\"><img ng-if=\\\"profile\\\" profile-modal \\nuser=\\\"data[$index].user.obj\\\" ng-src=\\\"{{ ::data[$index].imageThumb._url}}\\\" width=\\\"100%\\\"> <img ng-if=\\\"!profile\\\" \\nng-src=\\\"{{ ::data[$index].imageThumb._url}}\\\" width=\\\"100%\\\"></div><div class=\\\"col col-33 item-animate1\\\" \\nng-if=\\\"$index + 1 < data.length\\\"><img ng-if=\\\"profile\\\" profile-modal user=\\\"data[$index + 1].user.obj\\\" \\nng-src=\\\"{{ ::data[$index + 1].imageThumb._url}}\\\" width=\\\"100%\\\"> <img ng-if=\\\"!profile\\\" \\nng-src=\\\"{{ ::data[$index + 1].imageThumb._url}}\\\" width=\\\"100%\\\"></div><div class=\\\"col col-33 item-animate1\\\" \\nng-if=\\\"$index + 2 < data.length\\\"><img ng-if=\\\"profile\\\" profile-modal user=\\\"data[$index + 2].user.obj\\\" \\nng-src=\\\"{{ ::data[$index + 2].imageThumb._url}}\\\" width=\\\"100%\\\"> <img ng-if=\\\"!profile\\\" \\nng-src=\\\"{{ ::data[$index + 2].imageThumb._url}}\\\" width=\\\"100%\\\"></div></div><ion-infinite-scroll \\non-infinite=\\\"onLoadMore()\\\" ng-if=\\\"moreDataCanBeLoaded()\\\" spinner distance=\\\"1%\\\"></ion-infinite-scroll>\");\n$templateCache.put(\"app/directive/photoListDirective.html\",\"<div class=\\\"center padding\\\" ng-if=\\\"showErrorView()\\\"><div class=\\\"error\\\"><i \\nclass=\\\"icon icon-large ion-ios-cloud-download-outline\\\"></i><p>{{ \\\"errorText\\\" | translate }}</p><button \\nclass=\\\"button button-primary\\\" ng-click=\\\"onReload()\\\">{{ \\\"tryAgainText\\\" | translate }}</button></div></div><div \\nclass=\\\"center padding\\\" ng-if=\\\"showEmptyView()\\\"><div class=\\\"error\\\"><i class=\\\"icon icon-large ion-android-alert\\\"></i><p>\\n{{ \\\"galleriesNotFoundText\\\" | translate }}</p></div></div><div class=\\\"center padding\\\" ng-if=\\\"loading\\\"><ion-spinner>\\n</ion-spinner></div><ion-refresher pulling-text=\\\"{{\\'loadingText\\'| translate}}\\\" on-refresh=\\\"onReload()\\\"></ion-refresher>\\n<div class=\\\"list card\\\" ng-repeat=\\\"gallery in data | orderBy:createdAt:true\\\" ng-if=\\\"showGalleries()\\\"><div \\nclass=\\\"item item-avatar\\\" ng-click=\\\"load(gallery.user.username)\\\" ion-affix data-affix-within-parent-with-class=\\\"card\\\">\\n<img ng-if=\\\"profile\\\" ng-src=\\\"{{ ::gallery.user.photo._url}}\\\"> <img \\nng-src=\\\"{{ ::gallery.user.photo._url || \\'img/user.png\\'}}\\\"><h2>{{ ::gallery.user.name}}</h2><p>\\n{{ ::gallery.user.status}}</p><span>{{ ::gallery.createdAt | amTimeAgo}}</span></div><div class=\\\"item item-body\\\" \\non-double-tap=\\\"like(gallery.id)\\\" ng-model=\\\"gallery\\\"><div class=\\\"icon ion-ios-heart heart\\\" \\nng-class=\\\"gallery.isLiked ? \\'happy\\' : \\'broken\\' \\\"></div><i class=\\\"icon\\\" ng-if=\\\"like\\\"></i> <img \\nng-src=\\\"{{ gallery.image._url}}\\\" id=\\\"{{ ::gallery.id}}\\\"></div><div class=\\\"item item-buttons\\\"><div class=\\\"row\\\"><div \\nclass=\\\"col col-75\\\"><ion-spinner ng-show=\\\"gallery.progress\\\"></ion-spinner><button photo-like ng-model=\\\"gallery\\\" \\nng-if=\\\"!gallery.progress\\\" ng-class=\\\"gallery.isLiked ? \\'ion-ios-heart\\' : \\'ion-ios-heart-outline\\' \\\" \\nclass=\\\"button-clear button-icon button-heart\\\"></button> <button ng-click=\\\"openComment(gallery.id)\\\" ng-model=\\\"gallery\\\" \\nclass=\\\"button-clear button-icon ion-ios-chatbubble-outline\\\"></button> <button \\nng-click=\\\"share(gallery.image._url, gallery.title)\\\" photogram=\\\"{{ :: gallery.id }}\\\" \\nclass=\\\"button-clear button-icon ion-android-share\\\"></button></div><div class=\\\"col text-right\\\"><button \\nng-click=\\\"action(gallery)\\\" photogram=\\\"{{ :: gallery.id }}\\\" class=\\\"button-clear button-icon ion-android-more-vertical\\\">\\n</button></div></div></div><div class=\\\"padding\\\"><span class=\\\"likes\\\" ng-click=\\\"openLikers(gallery.id)\\\"><i \\nclass=\\\"icon ion-ios-heart\\\"></i> <span ng-if=\\\"!gallery.progress\\\">{{ gallery.likesTotal }}</span> <span \\ntranslate=\\\"likesText\\\"></span></span><div class=\\\"list-comments\\\"><div class=\\\"comment-item\\\"><span profile-modal \\nusername=\\\"gallery.user.username\\\" class=\\\"username\\\">{{ :: gallery.user.name }}</span> <span class=\\\"comment\\\" \\nng-bind-html=\\\"gallery.title | hashtag \\\"></span></div><div class=\\\"comment-item\\\" \\nng-repeat=\\\"item in gallery.comments |limitTo:3 | orderBy:createdAt:true \\\"><span class=\\\"username\\\" profile-modal \\nusername=\\\"gallery.user.username\\\">{{ :: item.user.name }}</span> <span class=\\\"comment\\\" \\nng-bind-html=\\\"item.text | hashtag\\\"></span></div><a class=\\\"comment-item\\\" photo-comment ng-model=\\\"gallery\\\" \\nng-if=\\\"gallery.commentsTotal>3\\\" translate=\\\"seeAllCommentText\\\"></a></div><button \\nclass=\\\"button button-block button-clear button-comment\\\" photo-comment ng-model=\\\"gallery\\\"><span translate=\\\"addComment\\\">\\n</span></button></div></div><ion-infinite-scroll on-infinite=\\\"onLoadMore()\\\" ng-if=\\\"moreDataCanBeLoaded()\\\" spinner \\ndistance=\\\"1%\\\"></ion-infinite-scroll>\");\n$templateCache.put(\"app/directive/profile-edit-modal.html\",\"<ion-modal-view class=\\\"profile-edit\\\"><ion-header-bar class=\\\"bar-light\\\"><button class=\\\"button button-clear\\\" \\nng-click=\\\"closeModal()\\\" translate=\\\"cancel\\\"></button><div class=\\\"title\\\">{{ ::\\'editProfile\\' | translate }}</div><button \\nclass=\\\"button button-clear\\\" ng-click=\\\"submitUpdateProfile(rForm, form)\\\" translate=\\\"submit\\\"></button></ion-header-bar>\\n<ion-content class=\\\"view-avatar\\\"><div class=\\\"step2\\\"><form name=\\\"rForm\\\" novalidate><img class=\\\"avatar\\\" user-avatar \\nng-src=\\\"{{ form.photo._url || \\'img/user.png\\' }}\\\"><label class=\\\"item item-input\\\"><i \\nclass=\\\"icon ion-clipboard placeholder-icon\\\"></i> <input required=\\\"required\\\" type=\\\"text\\\" name=\\\"name\\\" \\nng-model=\\\"form.name\\\" placeholder=\\\"{{\\'name\\' | translate}}\\\"></label><label class=\\\"item item-input\\\"><i \\nclass=\\\"icon ion-pound placeholder-icon\\\"></i> <input required=\\\"required\\\" type=\\\"text\\\" name=\\\"username\\\" \\nng-model=\\\"form.username\\\" ng-minlength=\\\"4\\\" ng-maxlength=\\\"12\\\" ng-pattern=\\\"/^[a-zA-Z\\'. -]+$/\\\" \\nplaceholder=\\\"{{\\'username\\' | translate}}\\\"></label><label class=\\\"item item-input\\\"><i \\nclass=\\\"icon ion-earth placeholder-icon\\\"></i> <input type=\\\"url\\\" name=\\\"website\\\" ng-model=\\\"form.website\\\" \\nplaceholder=\\\"{{\\'site\\' | translate}}\\\"></label><label class=\\\"item item-input\\\"><i \\nclass=\\\"icon ion-information-circled placeholder-icon\\\"></i> <input required=\\\"required\\\" type=\\\"text\\\" name=\\\"status\\\" \\nng-model=\\\"form.status\\\" placeholder=\\\"{{\\'status\\' | translate}}\\\"></label><ion-item class=\\\"item-divider\\\" \\ntranslate=\\\"privateInformation\\\"></ion-item><label class=\\\"item item-input\\\"><i \\nclass=\\\"icon icon-envelope placeholder-icon\\\"></i> <input type=\\\"email\\\" name=\\\"email\\\" ng-model=\\\"form.email\\\" \\ndisabled=\\\"disabled\\\" ng-model-options=\\\"{debounce: 1000}\\\" placeholder=\\\"user@example.com\\\"></label><label \\nclass=\\\"item item-input\\\"><i class=\\\"icon ion-iphone placeholder-icon\\\"></i> <input required=\\\"required\\\" type=\\\"tel\\\" \\nname=\\\"phone\\\" ng-model=\\\"form.phone\\\" placeholder=\\\"{{\\'phone\\' | translate }}\\\"></label></form></div><div \\nclass=\\\"padding step3\\\"><button ng-click=\\\"linkFacebook()\\\" ng-disabled=\\\"form.facebook\\\" \\nclass=\\\"button button-block button-facebook\\\"><i class=\\\"icon ion-social-facebook\\\"></i> <span translate=\\\"facebookLink\\\">\\n</span></button></div></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/directive/profile-modal.html\",\"<ion-modal-view id=\\\"account-view\\\"><ion-header-bar class=\\\"bar-light\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-arrow-thin-left\\\" ng-click=\\\"closeModal()\\\"></button><div class=\\\"title\\\">\\n{{ user.name }}</div></ion-header-bar><ion-content overflow-scroll=\\\"true\\\"><div class=\\\"profile-top\\\"><div class=\\\"row\\\">\\n<div class=\\\"col-25\\\"><img class=\\\"avatar\\\" ng-src=\\\"{{ user.photo._url || \\'img/user.png\\'}}\\\"></div><div \\nclass=\\\"col col-statics\\\"><div class=\\\"row\\\"><div class=\\\"row\\\"><div class=\\\"col\\\"><span class=\\\"text-center\\\">\\n{{ ::user.galleriesTotal || 0}}</span><h3 translate=\\\"postsText\\\"></h3></div><div class=\\\"col\\\"><span class=\\\"text-center\\\">\\n{{ user.followersTotal || 0}}</span><h3 translate=\\\"followersText\\\"></h3></div><div class=\\\"col\\\"><span \\nclass=\\\"text-center\\\">{{ ::user.followingsTotal || 0}}</span><h3 translate=\\\"followingText\\\"></h3></div></div></div><div \\nclass=\\\"row col-edit\\\"><div class=\\\"col\\\"><photogram-loading loading=\\\"loadingFollow\\\"></photogram-loading><button \\nng-class=\\\"{\\'button-unfollow\\': user.isFollow, \\'button-follow\\': !user.isFollow}\\\" ng-click=\\\"follow()\\\" class=\\\"button\\\"><span\\n ng-show=\\\"!user.isFollow\\\" translate>Follow</span> <span ng-show=\\\"user.isFollow\\\" translate>Following</span></button>\\n</div></div></div></div><div class=\\\"padding\\\"><span class=\\\"user-username\\\">{{ user.name }}</span><p class=\\\"user-status\\\">\\n{{ user.status }}</p></div></div><div class=\\\"item bar\\\"><div class=\\\"button-bar\\\"><button \\nclass=\\\"button button-icon icon ion-grid\\\" ng-class=\\\"{active: tab.grid}\\\" ng-click=\\\"changeTab(\\'grid\\')\\\"></button> <button \\nclass=\\\"button button-icon icon ion-drag\\\" ng-class=\\\"{active: tab.list}\\\" ng-click=\\\"changeTab(\\'list\\')\\\"></button> <button \\nclass=\\\"button button-icon icon ion-ios-location\\\"></button></div></div><div class=\\\"item item-divider\\\" \\ntranslate=\\\"recent\\\"></div><div class=\\\"tab\\\" ng-if=\\\"tab.list\\\"></div><div class=\\\"tab\\\" ng-if=\\\"tab.grid\\\"></div></ion-content>\\n</ion-modal-view>\");\n$templateCache.put(\"app/directive/search-directive.html\",\"<label class=\\\"item item-input\\\"><i class=\\\"icon ion-search placeholder-icon\\\"></i> <input type=\\\"search\\\" ng-model=\\\"input\\\" \\nplaceholder=\\\"{{\\'SEARCH.FORM.INPUT\\' | translate }}\\\"> <button class=\\\"button button-icon\\\" ng-if=\\\"input.length\\\" \\nng-click=\\\"clearSearch()\\\"><i class=\\\"icon ion-close\\\"></i></button></label>\");\n$templateCache.put(\"app/directive/settings-modal.html\",\"<ion-modal-view class=\\\"modal-profile\\\"><ion-header-bar class=\\\"bar-light\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-arrow-thin-left\\\" ng-click=\\\"closeModal()\\\"></button><div class=\\\"title\\\" \\ntranslate=\\\"settingTitle\\\"></div></ion-header-bar><ion-content class=\\\"animated fadeIn\\\"><div class=\\\"list\\\"><ion-language>\\n</ion-language><ion-toggle class=\\\"toggle-positive\\\" ng-model=\\\"form.push\\\"><h3><small translate=\\\"notificationText\\\">\\n</small></h3><p ng-if=\\\"form.push\\\" translate=\\\"on\\\"></p><p ng-if=\\\"!form.push\\\" translate=\\\"off\\\"></p></ion-toggle><ion-item \\nclass=\\\"item-icon-right\\\" href=\\\"https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=FAW4JZS7KJM5S\\\"><h3>\\n<small translate=\\\"buy\\\"></small></h3><i class=\\\"icon ion-ios-arrow-right\\\"></i></ion-item><ion-item \\nclass=\\\"item-icon-right\\\" href=\\\"http://photogramapp.com\\\"><h3><small translate=\\\"help\\\"></small></h3><i \\nclass=\\\"icon ion-ios-arrow-right\\\"></i></ion-item><ion-item class=\\\"item-icon-right\\\" href=\\\"http://photogramapp.com\\\"><h3>\\n<small translate=\\\"terms\\\"></small></h3><i class=\\\"icon ion-ios-arrow-right\\\"></i></ion-item><ion-item \\nclass=\\\"item-icon-right\\\" ng-click=\\\"show();\\\"><h3><small translate=\\\"report\\\"></small></h3><i \\nclass=\\\"icon ion-ios-arrow-right\\\"></i></ion-item></div><div class=\\\"padding\\\"><button ng-click=\\\"logout()\\\" \\nclass=\\\"button button-block button-positive\\\" translate=\\\"logout\\\"></button></div></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/mentio/people-mentions.html\",\"<ul class=\\\"list-group user-search\\\"><li mentio-menu-item=\\\"person\\\" ng-repeat=\\\"person in items\\\" class=\\\"list-group-item\\\">\\n<img ng-src=\\\"{{person.imageUrl}}\\\" class=\\\"user-photo\\\"><div class=\\\"description\\\"><span class=\\\"text-primary\\\" \\nng-bind-html=\\\"person.username | mentioHighlight:typedTerm:\\'menu-highlighted\\' | unsafe\\\"></span> <em class=\\\"text-muted\\\" \\nng-bind=\\\"person.status | words:5\\\"></em></div></li></ul>\");\n$templateCache.put(\"app/mentio/photo-mentions.html\",\"<ul class=\\\"list-group product-search demo-scrollable-menu\\\"><li mentio-menu-item=\\\"product\\\" ng-repeat=\\\"product in items\\\" \\nclass=\\\"list-group-item clearfix\\\"><div class=\\\"row\\\"><div class=\\\"col-xs-2 text-center\\\"><img ng-src=\\\"{{product.imageUrl}}\\\" \\nclass=\\\"product-photo\\\"></div><div class=\\\"col-xs-10\\\"><h4 class=\\\"list-group-item-heading\\\">{{product.title | words:5}}</h4>\\n<p class=\\\"list-group-item-text\\\">{{product.description | words:7}}</p></div></div></li></ul>\");\n$templateCache.put(\"app/component/ion-language/ion-language.html\",\"<button class=\\\"button button-block button-clear button-light button-language\\\">{{language.translation | translate}} <i \\nclass=\\\"icon ion-chevron-down\\\"></i></button>\");\n$templateCache.put(\"app/component/ion-language/modal-language.html\",\"<ion-modal-view><ion-header-bar><h1 class=\\\"title\\\" translate=\\\"selectLanguageText\\\"></h1><a ng-click=\\\"closeModal()\\\" \\nclass=\\\"button button-icon icon ion-close\\\"></a></ion-header-bar><div \\nclass=\\\"bar bar-subheader item-input-inset bar-stable\\\"><label class=\\\"item-input-wrapper\\\"><i \\nclass=\\\"icon ion-ios-search placeholder-icon\\\"></i> <input type=\\\"search\\\" placeholder=\\\"{{\\'searchText\\' | translate}}\\\" \\nng-model=\\\"searchValue\\\"></label><button type=\\\"button\\\" class=\\\"button button-clear\\\" ng-show=\\\"searchValue.length\\\" \\nng-click=\\\"searchValue=\\'\\'\\\">Clear</button></div><ion-content class=\\\"has-subheader has-header\\\"><ion-list><ion-item \\nclass=\\\"item\\\" ng-click=\\\"selectLanguage(item)\\\" ng-repeat=\\\"item in languages | filter:searchValue\\\" \\nng-bind-html=\\\"item.translation | translate\\\"></ion-item></ion-list></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/main/account-friend-list/account-friend-list.html\",\"<ion-view><ion-content></ion-content></ion-view>\");\n$templateCache.put(\"app/main/feedback/feedback-modal.html\",\"<ion-modal-view class=\\\"modal-profile\\\"><ion-header-bar class=\\\"bar-light\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-arrow-thin-left\\\" ng-click=\\\"closeModal()\\\"></button><div class=\\\"title\\\" \\ntranslate=\\\"FEEDBACK.TITLE\\\"></div></ion-header-bar><ion-content><formly-form model=\\\"form\\\" form=\\\"rForm\\\" \\nfields=\\\"formFields\\\"></formly-form><div class=\\\"padding\\\"><button class=\\\"button button-block button-positive\\\" \\nng-click=\\\"submitFeedback()\\\"><span translate=\\\"BUTTON.SEND\\\"></span></button></div></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/main/gallery-comment/gallery-comment.html\",\"<ion-view class=\\\"modal-comment\\\" view-title=\\\"Comments\\\" cache-view=\\\"false\\\"><ion-nav-bar class=\\\"bar-light\\\"><ion-nav-title>\\n<div class=\\\"title\\\"><span translate=\\\"commentPhotoText\\\"></span>({{ comments.length }})</div></ion-nav-title>\\n<ion-nav-buttons side=\\\"left\\\"><button class=\\\"button button-icon button-clear ion-ios-arrow-left\\\" \\nng-click=\\\"$ionicGoBack()\\\"></button></ion-nav-buttons></ion-nav-bar><ion-content><div class=\\\"padding center\\\" \\nng-if=\\\"loading\\\"><ion-spinner></ion-spinner></div><ion-list class=\\\"list\\\" ng-if=\\\"!loading\\\" can-swipe=\\\"true\\\"><ion-item \\nng-repeat=\\\"item in comments \\\" class=\\\"item item-avatar\\\"><img ng-src=\\\"{{ ::item.user.photo._url || \\'./img/user.png\\'}}\\\">\\n<div class=\\\"row\\\"><h2>{{ ::item.user.name }}</h2></div><div class=\\\"row\\\"><div class=\\\"text\\\">{{ ::item.text }}</div></div>\\n<div class=\\\"row\\\"><p>{{ ::item.createdAt | amTimeAgo }}</p></div><div ng-if=\\\"item.canEdit\\\"><ion-option-button \\nclass=\\\"button-info\\\" ng-click=\\\"editComment(item, $index)\\\" translate=\\\"edit\\\">Edit</ion-option-button><ion-option-button \\nclass=\\\"button-assertive\\\" ng-click=\\\"deleteComment(item, $index)\\\" translate=\\\"remove\\\">Remove</ion-option-button></div>\\n</ion-item></ion-list><div class=\\\"center-ico\\\" ng-if=\\\"nocomments\\\"><i class=\\\"icon ion-ios-chatbubble-outline\\\"></i><h1 \\ntranslate=\\\"noComments\\\"></h1></div></ion-content><form name=\\\"rForm\\\" ng-submit=\\\"submitComment(rForm, form)\\\" novalidate>\\n<ion-footer-bar ng-hide=\\\"loading\\\" class=\\\"bar-stable item-input-inset message-footer\\\" keyboard-attach><label \\nclass=\\\"item-input-wrapper\\\"><i class=\\\"icon ion-ios-compose-outline placeholder-icon\\\"></i><textarea mentio \\nmentio-trigger-char=\\\"\\'@\\'\\\" mentio-items=\\\"people\\\" mentio-template-url=\\\"app/mentio/people-mentions.html\\\" \\nmentio-search=\\\"searchPeople(term)\\\" mentio-select=\\\"getPeopleTextRaw(item)\\\" mentio-id=\\\"\\'theTextArea\\'\\\" ng-trim=\\\"false\\\" \\nng-model=\\\"form.text\\\" focus-me id=\\\"textComment\\\" placeholder=\\\"Send a comment...\\\" required minlength=\\\"1\\\" maxlength=\\\"1500\\\">\\n                </textarea></label><div class=\\\"footer-btn-wrap\\\"><button class=\\\"button button-positive button-outline\\\" \\ntype=\\\"submit\\\" ng-disabled=\\\"!form.text || form.text === \\'\\'\\\">Publish</button></div></ion-footer-bar></form></ion-view>\");\n$templateCache.put(\"app/main/loading/loading.html\",\"<ion-view id=\\\"user-layout\\\" class=\\\"bg-animate\\\"><ion-content></ion-content></ion-view>\");\n$templateCache.put(\"app/main/profile/profile.html\",\"<ion-view cache-view=\\\"false\\\" id=\\\"account-view\\\"><ion-nav-bar class=\\\"bar bar-light\\\"><ion-nav-back-button>\\n</ion-nav-back-button></ion-nav-bar><ion-nav-title><span>{{ vm.user.name }}</span></ion-nav-title><ion-content \\nscroll-sista=\\\"header-tabs\\\" class=\\\"animated fadeIn\\\"><div class=\\\"profile-top\\\"><div class=\\\"row\\\"><div class=\\\"col-25\\\"><img \\nclass=\\\"avatar\\\" user-avatar ng-model=\\\"vm.user\\\" ng-src=\\\"{{ vm.user.photo._url || \\'img/user.png\\' }}\\\"></div><div \\nclass=\\\"col col-statics\\\"><div class=\\\"row\\\"><div class=\\\"col\\\"><span class=\\\"text-center\\\">{{ vm.user.galleriesTotal || 0}}\\n</span><h3 translate=\\\"postsText\\\"></h3></div><div class=\\\"col\\\" ng-click=\\\"vm.openFollowers()\\\"><span class=\\\"text-center\\\">\\n{{ vm.user.followersTotal || 0}}</span><h3 translate=\\\"followersText\\\"></h3></div><div class=\\\"col\\\" \\nng-click=\\\"vm.openFollowing()\\\"><span class=\\\"text-center\\\">{{ vm.user.followingsTotal || 0}}</span><h3 \\ntranslate=\\\"followingText\\\"></h3></div></div><div class=\\\"row col-edit\\\"><div class=\\\"col center\\\" ng-if=\\\"vm.loading\\\">\\n<ion-spinner></ion-spinner></div><div class=\\\"col\\\" ng-if=\\\"vm.isMe && !vm.loading\\\"><button profile-modal-edit \\nuser=\\\"vm.user\\\" class=\\\"button\\\"><div translate=\\\"editProfile\\\"></div></button></div><div class=\\\"col\\\" \\nng-if=\\\"!vm.isMe && !vm.loading\\\"><button \\nng-class=\\\"{\\'button-unfollow\\': vm.user.isFollow, \\'button-follow\\': !vm.user.isFollow}\\\" ng-click=\\\"vm.follow()\\\" \\nclass=\\\"button\\\"><span ng-show=\\\"!vm.user.isFollow\\\" translate>Follow</span> <span ng-show=\\\"vm.user.isFollow\\\" translate>\\nFollowing</span></button></div></div></div></div><div class=\\\"padding\\\"><span class=\\\"user-username\\\">{{ vm.user.name }}\\n</span><p class=\\\"user-status\\\">{{ vm.user.status }}</p></div></div><div class=\\\"item bar\\\"><div class=\\\"button-bar\\\"><button\\n class=\\\"button button-icon icon ion-grid\\\" ng-class=\\\"{active: vm.tab.grid}\\\" ng-click=\\\"vm.changeTab(\\'grid\\')\\\"></button> \\n<button class=\\\"button button-icon icon ion-drag\\\" ng-class=\\\"{active: vm.tab.list}\\\" ng-click=\\\"vm.changeTab(\\'list\\')\\\">\\n</button> <button class=\\\"button button-icon icon ion-ios-location\\\"></button></div></div><div class=\\\"center padding\\\" \\nng-if=\\\"vm.loading\\\"><ion-spinner></ion-spinner></div><div ng-if=\\\"!vm.loading\\\"><div class=\\\"item item-divider\\\" \\ntranslate=\\\"recentText\\\">Recent</div><div class=\\\"tab\\\" ng-if=\\\"vm.tab.list\\\"><photo-list username=\\\"vm.user.username\\\">\\n</photo-list></div><div class=\\\"tab\\\" ng-if=\\\"vm.tab.grid\\\"><photo-grid username=\\\"vm.user.username\\\"></photo-grid></div>\\n</div></ion-content></ion-view>\");\n$templateCache.put(\"app/main/share/post-modal.html\",\"<ion-modal-view class=\\\"modal-post\\\"><ion-header-bar class=\\\"bar-light\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-arrow-thin-left\\\" ng-click=\\\"closePost()\\\"></button><div class=\\\"title\\\" \\ntranslate=\\\"SHARE.TITLE\\\"></div><button class=\\\"button button-positive\\\" ng-click=\\\"submitPost(form)\\\"><i \\nclass=\\\"icon ion-arrow-right-b\\\"></i></button></ion-header-bar><ion-content><div id=\\\"image\\\"><img ng-src=\\\"{{image}}\\\">\\n</div><ul class=\\\"list\\\"><li class=\\\"item\\\"><textarea ng-model=\\\"form.title\\\" \\nplaceholder=\\\"{{ \\'SHARE.FORM.LEGEND\\' | translate }}\\\"></textarea></li></ul></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/main/share/share-modal.html\",\"<ion-modal-view class=\\\"modal-share\\\"><ion-header-bar class=\\\"bar-light\\\"><button \\nclass=\\\"button button-clear button-icon ion-ios-close-empty\\\" ng-click=\\\"close()\\\"></button><div class=\\\"title\\\" \\ntranslate=\\\"shareGalleryText\\\"></div></ion-header-bar><ion-content><div class=\\\"list\\\"><div \\nclass=\\\"item item-thumbnail-left\\\"><img ng-src=\\\"{{image}}\\\" ng-click=\\\"editFilter()\\\"><textarea mentio \\nmentio-trigger-char=\\\"\\'@\\'\\\" mentio-items=\\\"people\\\" mentio-template-url=\\\"app/mentio/people-mentions.html\\\" \\nmentio-search=\\\"searchPeople(term)\\\" mentio-select=\\\"getPeopleTextRaw(item)\\\" mentio-id=\\\"\\'theTextArea\\'\\\" ng-trim=\\\"false\\\" \\ntype=\\\"text\\\" ng-model=\\\"form.title\\\" placeholder=\\\"{{ \\'description\\'|translate }}\\\"></textarea></div></div><div class=\\\"list\\\">\\n<a class=\\\"item item-icon-left\\\" ion-location ng-model=\\\"form.address\\\" ng-if=\\\"!form.address.resume\\\"><i \\nclass=\\\"icon ion-ios-location\\\"></i> <span translate=\\\"addLocale\\\"></span> </a><a \\nclass=\\\"item item-icon-left item-button-right\\\" ng-if=\\\"form.address.resume\\\"><i class=\\\"icon ion-ios-location\\\"></i><h2>\\n{{form.address.name || form.address.resume}}</h2><p>{{form.address.resume}}</p><button class=\\\"button button-icon\\\" \\nng-click=\\\"closeAddress()\\\"><i class=\\\"icon ion-ios-close\\\"></i></button></a></div><div class=\\\"padding\\\"><button \\nclass=\\\"button button-block button-positive\\\" type=\\\"button\\\" ng-click=\\\"submit(form)\\\" translate=\\\"submit\\\"></button></div>\\n</ion-content></ion-modal-view>\");\n$templateCache.put(\"app/main/tab/main-tab.html\",\"<ion-view><ion-nav-bar class=\\\"bar bar-light\\\"><ion-nav-back-button></ion-nav-back-button></ion-nav-bar><ion-tabs \\nclass=\\\"tabs-light tabs-photogram\\\"><ion-tab title=\\\"{{ \\'PHOTOGRAM.TITLE.HOME\\' | translate }}\\\" icon-on=\\\"ion-ios-home\\\" \\nicon-off=\\\"ion-ios-home-outline\\\" ui-sref=\\\"tab.home\\\"><ion-nav-view name=\\\"tabHome\\\"></ion-nav-view></ion-tab><ion-tab \\ntitle=\\\"{{ \\'PHOTOGRAM.TITLE.SEARCH\\' | translate }}\\\" icon-on=\\\"ion-ios-world\\\" icon-off=\\\"ion-ios-world-outline\\\" \\nui-sref=\\\"tab.search\\\"><ion-nav-view name=\\\"tabSearch\\\"></ion-nav-view></ion-tab><ion-tab \\ntitle=\\\"{{ \\'PHOTOGRAM.TITLE.SHARE\\' | translate }}\\\" icon-on=\\\"ion-ios-camera\\\" icon-off=\\\"ion-ios-camera-outline\\\" \\nng-click=\\\"vm.postPhoto()\\\"><ion-nav-view name=\\\"tabCapture\\\"></ion-nav-view></ion-tab><ion-tab \\ntitle=\\\"{{ \\'PHOTOGRAM.TITLE.ACTIVITY\\' | translate }}\\\" icon-on=\\\"ion-ios-heart\\\" icon-off=\\\"ion-ios-heart-outline\\\" \\nui-sref=\\\"tab.activity\\\"><ion-nav-view name=\\\"tabActivity\\\"></ion-nav-view></ion-tab><ion-tab \\ntitle=\\\"{{ \\'PHOTOGRAM.TITLE.PROFILE\\' | translate }}\\\" icon-on=\\\"ion-ios-person\\\" icon-off=\\\"ion-ios-person-outline\\\" \\nui-sref=\\\"tab.account\\\"><ion-nav-view name=\\\"tabProfile\\\"></ion-nav-view></ion-tab></ion-tabs></ion-view>\");\n$templateCache.put(\"app/main/tab-account/account.html\",\"<ion-view cache-view=\\\"false\\\" id=\\\"account-view\\\"><ion-nav-title><span>{{ vm.user.attributes.name }}</span>\\n</ion-nav-title><ion-nav-buttons side=\\\"right\\\"><button settings-modal class=\\\"button button-icon icon ion-gear-a\\\">\\n</button></ion-nav-buttons><ion-content scroll-sista=\\\"header-tabs\\\" class=\\\"animated fadeIn\\\"><div class=\\\"profile-top\\\">\\n<div class=\\\"row\\\"><div class=\\\"col-25\\\"><img class=\\\"avatar\\\" user-avatar ng-model=\\\"currentUser\\\" \\nng-src=\\\"{{ currentUser.photo.url() || \\'img/user.png\\' }}\\\"></div><div class=\\\"col col-statics\\\"><div class=\\\"row\\\"><div \\nclass=\\\"col\\\"><span ng-if=\\\"!vm.loading\\\" class=\\\"text-center\\\">{{ vm.user.attributes.galleriesTotal || 0}}</span>\\n<ion-spinner ng-if=\\\"vm.loading\\\"></ion-spinner><h3 translate=\\\"postsText\\\"></h3></div><div class=\\\"col\\\" \\nng-click=\\\"vm.openFollowers()\\\"><span ng-if=\\\"!vm.loading\\\" class=\\\"text-center\\\">{{ vm.user.attributes.followersTotal || 0}}\\n</span><ion-spinner ng-if=\\\"vm.loading\\\"></ion-spinner><h3 translate=\\\"followersText\\\"></h3></div><div class=\\\"col\\\" \\nng-click=\\\"vm.openFollowing()\\\"><span ng-if=\\\"!vm.loading\\\" class=\\\"text-center\\\">\\n{{ vm.user.attributes.followingsTotal || 0}}</span><ion-spinner ng-if=\\\"vm.loading\\\"></ion-spinner><h3 \\ntranslate=\\\"followingText\\\"></h3></div></div><div class=\\\"row col-edit\\\"><div class=\\\"col\\\"><button profile-modal-edit \\nuser=\\\"vm.user\\\" class=\\\"button\\\"><div translate=\\\"editProfile\\\"></div></button></div></div></div></div><div class=\\\"padding\\\">\\n<span class=\\\"user-username\\\">{{ vm.user.attributes.name }}</span><p class=\\\"user-status\\\">{{ vm.user.attributes.status }}\\n</p></div></div><div class=\\\"item bar\\\"><div class=\\\"button-bar\\\"><button class=\\\"button button-icon icon ion-grid\\\" \\nng-class=\\\"{active: vm.tab.grid}\\\" ng-click=\\\"vm.changeTab(\\'grid\\')\\\"></button> <button \\nclass=\\\"button button-icon icon ion-drag\\\" ng-class=\\\"{active: vm.tab.list}\\\" ng-click=\\\"vm.changeTab(\\'list\\')\\\"></button> \\n<button class=\\\"button button-icon icon ion-ios-location\\\"></button></div></div><div class=\\\"item item-divider\\\" \\ntranslate=\\\"recentText\\\">Recent</div><div class=\\\"tab\\\" ng-if=\\\"vm.tab.list && !vm.loading\\\"><photo-list \\nusername=\\\"vm.user.attributes.username\\\"></photo-list></div><div class=\\\"tab\\\" ng-if=\\\"vm.tab.grid && !vm.loading\\\">\\n<photo-grid username=\\\"currentUser.username\\\"></photo-grid></div></ion-content></ion-view>\");\n$templateCache.put(\"app/main/tab-activity/activity.html\",\"<ion-view class=\\\"list-activity\\\"><ion-nav-title><span translate=\\\"activities\\\"></span></ion-nav-title><ion-content \\nscroll-sista=\\\"\\\"><div class=\\\"center padding\\\" ng-if=\\\"loading\\\"><ion-spinner></ion-spinner></div><div \\nclass=\\\"center padding\\\" ng-if=\\\"vm.showErrorView()\\\"><div class=\\\"error\\\"><i \\nclass=\\\"icon icon-large ion-ios-cloud-download-outline\\\"></i><p>{{ \\\"errorText\\\" | translate }}</p><button \\nclass=\\\"button button-positive\\\" ng-click=\\\"vm.onReload()\\\">{{ \\\"tryAgainText\\\" | translate }}</button></div></div><div \\nclass=\\\"center padding\\\" ng-if=\\\"vm.showEmptyView()\\\"><div class=\\\"error\\\"><i class=\\\"icon icon-large ion-android-alert\\\"></i>\\n<p>{{ \\\"activityNotFoundText\\\" | translate }}</p></div></div><ion-refresher pulling-text=\\\"{{\\'loadingText\\'| translate}}\\\" \\non-refresh=\\\"onReload()\\\"></ion-refresher><div class=\\\"list\\\"><div class=\\\"item item-avatar item-animate1\\\" \\nng-repeat=\\\"item in vm.data\\\"><img ng-src=\\\"{{ item.user.photo._url  || \\'./img/user.png\\'}}\\\"><h2 \\nng-click=\\\"vm.openProfile(item.user.username)\\\">{{ item.user.name}}</h2><div class=\\\"text\\\">{{ item.action | translate }}\\n</div><p>{{ item.createdAt | amTimeAgo }}</p><div class=\\\"img-right\\\" ng-if=\\\"item.item.gallery\\\"><img \\nng-src=\\\"{{ item.item.gallery.attributes.imageThumb._url}}\\\"></div><div class=\\\"item-button-right\\\" \\nng-if=\\\"!item.item.gallery\\\"><button class=\\\"button button-positive button-outline icon\\\" \\nng-class=\\\"{\\'ion-ios-person-outline\\': item.user.isFollow, \\'ion-ios-personadd-outline\\': !item.user.isFollow}\\\" \\nng-click=\\\"vm.follow(user)\\\"></button></div></div></div><ion-infinite-scroll on-infinite=\\\"onLoadMore()\\\" \\nng-if=\\\"vm.moreDataCanBeLoaded()\\\" spinner distance=\\\"1%\\\"></ion-infinite-scroll></ion-content></ion-view>\");\n$templateCache.put(\"app/main/tab-home/home.html\",\"<ion-view class=\\\"view-home\\\"><ion-nav-buttons side=\\\"left\\\"><button \\nclass=\\\"button button-icon icon ion-ios-personadd-outline\\\" ui-sref=\\\"tab.homeUserlist\\\"></button></ion-nav-buttons>\\n<ion-nav-title><span class=\\\"icon2-logo\\\"></span></ion-nav-title><ion-content><photo-list profile=\\\"true\\\" \\nload=\\\"vm.openProfile\\\" open-likers=\\\"vm.openLikers\\\"></photo-list></ion-content></ion-view>\");\n$templateCache.put(\"app/main/tab-search/search.html\",\"<ion-view><ion-nav-title><span>{{ \\'searchText\\' | translate }}</span></ion-nav-title><ion-nav-buttons side=\\\"right\\\">\\n<button class=\\\"button button-icon ion-ios-location\\\" ui-sref=\\\"tab.map\\\"></button></ion-nav-buttons><ion-header-bar \\nclass=\\\"bar bar-subheader item-input-inset\\\"><label class=\\\"item-input-wrapper\\\"><i \\nclass=\\\"icon ion-ios-search placeholder-icon\\\"></i> <input type=\\\"search\\\" ng-model=\\\"params.search\\\" ng-change=\\\"onSearch()\\\" \\nng-model-options=\\\"{debounce:1000}\\\" style=\\\"text-transform:lowercase\\\" placeholder=\\\"{{ \\'searchText\\' | translate }}\\\">\\n</label><button class=\\\"button button-clear\\\" ng-if=\\\"search.length\\\" ng-click=\\\"clearSearch()\\\">\\n{{ \\\"cancelText\\\" | translate }}</button></ion-header-bar><ion-content class=\\\"has-subheader\\\"><photo-grid user=\\\"\\\">\\n</photo-grid></ion-content></ion-view>\");\n$templateCache.put(\"app/main/tab-search-map/searchMap.html\",\"<ion-view id=\\\"view-map\\\"><ion-nav-title>{{ \\'mapTitle\\' | translate }}</ion-nav-title><ion-content scroll=\\\"false\\\"><div \\nid=\\\"map_canvas\\\" data-tap-disabled=\\\"true\\\"></div></ion-content><ion-footer-bar><div class=\\\"row\\\" ng-if=\\\"loading\\\"><div \\nclass=\\\"col\\\"><div class=\\\"center\\\"><ion-spinner></ion-spinner></div></div></div><button ng-if=\\\"!loading\\\" \\nclass=\\\"button button-positive button-block button-outline\\\" ng-click=\\\"onSearchHere()\\\">{{ \\'searchInHere\\' | translate }}\\n</button></ion-footer-bar></ion-view>\");\n$templateCache.put(\"app/main/user-avatar/user-avatar.html\",\"<ion-view id=\\\"user-layout\\\" class=\\\"bg-animate\\\"><ion-content class=\\\"padding view-avatar\\\"><div class=\\\"row step1\\\"><div \\nclass=\\\"col\\\"><img class=\\\"avatar\\\" user-avatar ng-model=\\\"vm.user\\\" ng-src=\\\"{{ vm.user._url || \\'img/user.png\\' }}\\\"></div>\\n</div><div class=\\\"step2\\\"><form><label class=\\\"item item-input\\\"><i class=\\\"icon icon-envelope placeholder-icon\\\"></i> \\n<input type=\\\"email\\\" name=\\\"email\\\" ng-model=\\\"vm.form.email\\\" disabled=\\\"disabled\\\"></label></form><formly-form \\nmodel=\\\"vm.form\\\" fields=\\\"vm.formFields\\\" form=\\\"vm.rForm\\\"></formly-form></div><div class=\\\"step3\\\"><button \\nng-click=\\\"vm.submitAvatar()\\\" class=\\\"button button-block button-positive\\\" translate=\\\"submit\\\"></button></div>\\n</ion-content></ion-view>\");\n$templateCache.put(\"app/main/user-followers/user-followers.html\",\"<ion-view id=\\\"user-list\\\"><ion-nav-title><span translate=\\\"followersText\\\"></span></ion-nav-title><ion-header-bar \\nclass=\\\"bar bar-subheader item-input-inset\\\"><label class=\\\"item-input-wrapper\\\"><i \\nclass=\\\"icon ion-ios-search placeholder-icon\\\"></i> <input type=\\\"text\\\" ng-model=\\\"searchValue\\\" \\nstyle=\\\"text-transform:lowercase\\\" placeholder=\\\"{{ \\'searchText\\' | translate }}\\\"></label><button \\nclass=\\\"button button-positive button-clear\\\" ng-if=\\\"searchValue.length>1\\\" ng-click=\\\"clearSearch()\\\" translate=\\\"cancel\\\">\\n</button></ion-header-bar><ion-content class=\\\"has-subheader\\\"><div class=\\\"center padding\\\" ng-if=\\\"vm.loading\\\">\\n<ion-spinner></ion-spinner></div><div class=\\\"list\\\"><div ng-repeat=\\\"user in vm.users | filter:searchValue\\\"><a \\nclass=\\\"item item-avatar item-button-right\\\"><img ng-src=\\\"{{ user.photo._url || \\'img/user.png\\'}}\\\" \\nng-click=\\\"vm.openProfile(user)\\\"><h2 ng-click=\\\"vm.openProfile(user)\\\">{{user.username}}</h2><p>{{user.status}}</p><button\\n class=\\\"button button-positive\\\" ng-class=\\\"{\\'button-unfollow\\': user.isFollow, \\'button-outline\\': !user.isFollow}\\\" \\nng-click=\\\"vm.follow(user)\\\"><div ng-show=\\\"!user.isFollow\\\" translate>Follow</div><div ng-show=\\\"user.isFollow\\\" translate>\\nUnfollow</div></button> </a><span class=\\\"row\\\"><span class=\\\"col\\\" ng-repeat=\\\"gallery in user.galleries\\\"><img \\nng-src=\\\"{{ gallery.imageThumb._url}}\\\" id=\\\"{{ ::gallery.id}}\\\"></span></span></div></div></ion-content></ion-view>\");\n$templateCache.put(\"app/main/user-following/user-following.html\",\"<ion-view id=\\\"user-list\\\"><ion-nav-title><span translate=\\\"followingText\\\"></span></ion-nav-title><ion-header-bar \\nclass=\\\"bar bar-subheader item-input-inset\\\"><label class=\\\"item-input-wrapper\\\"><i \\nclass=\\\"icon ion-ios-search placeholder-icon\\\"></i> <input type=\\\"text\\\" ng-model=\\\"searchValue\\\" \\nstyle=\\\"text-transform:lowercase\\\" placeholder=\\\"{{ \\'searchText\\' | translate }}\\\"></label><button \\nclass=\\\"button button-positive button-clear\\\" ng-if=\\\"searchValue.length>1\\\" ng-click=\\\"clearSearch()\\\" translate=\\\"cancel\\\">\\n</button></ion-header-bar><ion-content class=\\\"has-subheader\\\"><div class=\\\"center padding\\\" ng-if=\\\"vm.loading\\\">\\n<ion-spinner></ion-spinner></div><div class=\\\"list\\\"><div ng-repeat=\\\"user in vm.users | filter:searchValue\\\"><a \\nclass=\\\"item item-avatar item-button-right\\\"><img ng-src=\\\"{{ user.photo._url || \\'img/user.png\\'}}\\\" \\nng-click=\\\"vm.openProfile(user)\\\"><h2 ng-click=\\\"vm.openProfile(user)\\\">{{user.username}}</h2><p>{{user.status}}</p><button\\n class=\\\"button button-positive\\\" ng-class=\\\"{\\'button-unfollow\\': user.isFollow, \\'button-outline\\': !user.isFollow}\\\" \\nng-click=\\\"vm.follow(user)\\\"><div ng-show=\\\"!user.isFollow\\\" translate>Follow</div><div ng-show=\\\"user.isFollow\\\" translate>\\nUnfollow</div></button> </a><span class=\\\"row\\\"><span class=\\\"col\\\" ng-repeat=\\\"gallery in user.galleries\\\"><img \\nng-src=\\\"{{ gallery.imageThumb._url}}\\\" id=\\\"{{ ::gallery.id}}\\\"></span></span></div></div></ion-content></ion-view>\");\n$templateCache.put(\"app/main/user-intro/user-intro.html\",\"<ion-view id=\\\"user-layout\\\" class=\\\"bg-animate\\\" cache-view=\\\"false\\\"><div class=\\\"bar bar-header\\\"><ion-language>\\n</ion-language></div><ion-content class=\\\"padding\\\" scroll=\\\"false\\\"><div class=\\\"center\\\"><div class=\\\"step1\\\"><div \\nclass=\\\"logo\\\"><span class=\\\"icon2-logo\\\"></span></div><p>{{::\\'userIntroText\\' | translate}}</p><facebook-login>\\n</facebook-login></div></div></ion-content><ion-footer-bar><div class=\\\"row\\\"><div class=\\\"col\\\"><button \\nclass=\\\"button button-block button-light button-outline\\\" translate=\\\"signin\\\" signin-modal></button></div><div \\nclass=\\\"col\\\"><button class=\\\"button button-block button-light button-outline\\\" translate=\\\"register\\\" signup-modal></button>\\n</div></div></ion-footer-bar></ion-view>\");\n$templateCache.put(\"app/main/user-layout/user-layout.html\",\"<ion-view id=\\\"user-layout\\\" class=\\\"bg-animate\\\"><ion-content padding=\\\"false\\\"><ion-nav-view></ion-nav-view></ion-content>\\n</ion-view>\");\n$templateCache.put(\"app/main/user-likers/user-likers.html\",\"<ion-view id=\\\"user-list\\\"><ion-nav-title><span translate=\\\"likersText\\\"></span></ion-nav-title><ion-header-bar \\nclass=\\\"bar bar-subheader item-input-inset\\\"><label class=\\\"item-input-wrapper\\\"><i \\nclass=\\\"icon ion-ios-search placeholder-icon\\\"></i> <input type=\\\"text\\\" ng-model=\\\"searchValue\\\" \\nstyle=\\\"text-transform:lowercase\\\" placeholder=\\\"{{ \\'searchText\\' | translate }}\\\"></label><button \\nclass=\\\"button button-positive button-clear\\\" ng-if=\\\"searchValue.length>1\\\" ng-click=\\\"clearSearch()\\\" translate=\\\"cancel\\\">\\n</button></ion-header-bar><ion-content class=\\\"has-subheader\\\"><div class=\\\"center padding\\\" ng-if=\\\"vm.loading\\\">\\n<ion-spinner></ion-spinner></div><div class=\\\"list\\\"><div ng-repeat=\\\"user in vm.users | filter:searchValue\\\"><a \\nclass=\\\"item item-avatar item-button-right\\\"><img ng-src=\\\"{{ user.photo._url || \\'img/user.png\\'}}\\\" \\nng-click=\\\"vm.openProfile(user)\\\"><h2 ng-click=\\\"vm.openProfile(user)\\\">{{user.username}}</h2><p>{{user.status}}</p><button\\n class=\\\"button button-positive\\\" ng-class=\\\"{\\'button-unfollow\\': user.isFollow, \\'button-outline\\': !user.isFollow}\\\" \\nng-click=\\\"vm.follow(user)\\\"><div ng-show=\\\"!user.isFollow\\\" translate>Follow</div><div ng-show=\\\"user.isFollow\\\" translate>\\nUnfollow</div></button> </a><span class=\\\"row\\\"><span class=\\\"col\\\" ng-repeat=\\\"gallery in user.galleries\\\"><img \\nng-src=\\\"{{ gallery.imageThumb._url}}\\\" id=\\\"{{ ::gallery.id}}\\\"></span></span></div></div></ion-content></ion-view>\");\n$templateCache.put(\"app/main/user-list/user-list.html\",\"<ion-view id=\\\"user-list\\\" cache-view=\\\"false\\\"><ion-nav-title><span translate=\\\"findPeople\\\"></span></ion-nav-title>\\n<ion-header-bar class=\\\"bar bar-subheader item-input-inset\\\"><label class=\\\"item-input-wrapper\\\"><i \\nclass=\\\"icon ion-ios-search placeholder-icon\\\"></i> <input type=\\\"text\\\" ng-model=\\\"searchValue\\\" \\nstyle=\\\"text-transform:lowercase\\\" placeholder=\\\"{{ \\'searchText\\' | translate }}\\\"></label><button \\nclass=\\\"button button-positive button-clear\\\" ng-if=\\\"searchValue.length>1\\\" ng-click=\\\"clearSearch()\\\" translate=\\\"cancel\\\">\\n</button></ion-header-bar><ion-content class=\\\"has-subheader\\\"><div class=\\\"center padding\\\" ng-if=\\\"showErrorView()\\\"><div \\nclass=\\\"error\\\"><i class=\\\"icon icon-large ion-ios-cloud-download-outline\\\"></i><p>{{ \\\"errorText\\\" | translate }}</p><button\\n class=\\\"button button-primary\\\" ng-click=\\\"onReload()\\\">{{ \\\"tryAgainText\\\" | translate }}</button></div></div><div \\nclass=\\\"center padding\\\" ng-if=\\\"showEmptyView()\\\"><div class=\\\"error\\\"><i class=\\\"icon icon-large ion-android-alert\\\"></i><p>\\n{{ \\\"galleriesNotFoundText\\\" | translate }}</p></div></div><div class=\\\"center padding\\\" ng-if=\\\"vm.loading\\\"><ion-spinner>\\n</ion-spinner></div><ion-refresher pulling-text=\\\"{{\\'loadingText\\'| translate}}\\\" on-refresh=\\\"vm.onReload()\\\">\\n</ion-refresher><div class=\\\"list\\\"><div ng-repeat=\\\"user in vm.data | filter:searchValue\\\"><a \\nclass=\\\"item item-avatar item-button-right\\\"><img ng-src=\\\"{{ user.photo._url || \\'img/user.png\\'}}\\\" \\nng-click=\\\"vm.openProfile(user)\\\"><h2 ng-click=\\\"vm.openProfile(user)\\\">{{user.username}}</h2><p>{{user.status}}</p><button\\n class=\\\"button button-positive\\\" ng-disabled=\\\"user.loading\\\" \\nng-class=\\\"{\\'button-unfollow\\': user.isFollow, \\'button-outline\\': !user.isFollow}\\\" ng-click=\\\"vm.follow(user)\\\"><div \\nng-show=\\\"!user.isFollow\\\" translate>Follow</div><div ng-show=\\\"user.isFollow\\\" translate>Unfollow</div></button> </a><span\\n class=\\\"row\\\"><span class=\\\"col\\\" ng-repeat=\\\"gallery in user.galleries\\\"><img ng-src=\\\"{{ gallery.imageThumb._url}}\\\" \\nid=\\\"{{ ::gallery.id}}\\\"></span></span></div></div><ion-infinite-scroll on-infinite=\\\"vm.onLoadMore()\\\" \\nng-if=\\\"vm.moreDataCanBeLoaded()\\\" spinner distance=\\\"1%\\\"></ion-infinite-scroll></ion-content></ion-view>\");\n$templateCache.put(\"app/main/user-merge/merge.html\",\"<ion-view id=\\\"user-layout\\\" class=\\\"bg-animate\\\" cache-view=\\\"false\\\"><ion-content class=\\\"view-avatar padding\\\"><div \\nclass=\\\"row step1\\\"><div class=\\\"col\\\"><img class=\\\"avatar\\\" user-avatar \\nng-src=\\\"{{ tempUser.attributes.photo._url || \\'./img/user.png\\' }}\\\"></div></div><div class=\\\"step2\\\"><formly-form \\nmodel=\\\"vm.form\\\" fields=\\\"vm.formFields\\\" form=\\\"rForm\\\"><input type=\\\"hidden\\\" ng-model=\\\"vm.form.facebookimg\\\"></formly-form>\\n</div><div class=\\\"padding step3\\\"><button ng-click=\\\"vm.submit(rForm, vm.form)\\\" \\nclass=\\\"button button-block button-facebook\\\"><i class=\\\"icon ion-social-facebook\\\"></i> <span translate=\\\"mergeAccount\\\">\\n</span></button></div></ion-content></ion-view>\");\n$templateCache.put(\"app/main/walkthrough/walkthrough.html\",\"<ion-view class=\\\"view-intro bg-animate\\\" can-swipe-back=\\\"false\\\"><ion-content scroll=\\\"false\\\"><div class=\\\"intro-slider\\\">\\n<ion-slide-box active-slide=\\\"slideIndex\\\" show-pager=\\\"true\\\" on-slide-changed=\\\"vm.slideChanged($index)\\\"><ion-slide \\nng-repeat=\\\"item in vm.slides track by $index\\\"><div class=\\\"content\\\" ng-if=\\\"$index == vm.slideIndex\\\"><span class=\\\"top\\\">\\n<h2>{{ item.text | translate }}</h2></span><div class=\\\"phone {{ vm.device }}\\\"><img ng-src=\\\"{{ item.img }}\\\"></div></div>\\n</ion-slide><ion-slide><div class=\\\"content\\\" ng-if=\\\"vm.slides.length == vm.slideIndex\\\"><div class=\\\"last\\\"><div \\nclass=\\\"logo2 step1\\\"><img src=\\\"img/icon.png\\\"> <span class=\\\"icon2-logo\\\"></span></div><button \\nclass=\\\"button button-block button-clear step2\\\" ui-sref=\\\"user.intro\\\" translate=\\\"signin\\\"></button></div></div>\\n</ion-slide></ion-slide-box></div><button class=\\\"button button-positive button-fab left\\\" ng-if=\\\"vm.slideIndex\\\" \\nng-click=\\\"vm.previous()\\\"><i class=\\\"icon ion-ios-arrow-left\\\"></i></button> <button \\nclass=\\\"button button-positive button-fab right\\\" ng-hide=\\\"vm.slideIndex === vm.slides.length\\\" ng-click=\\\"vm.next()\\\"><i \\nclass=\\\"icon ion-ios-arrow-right\\\"></i></button></ion-content></ion-view>\");\n$templateCache.put(\"app/component/ion-photo/view/modal.share.photo.html\",\"<ion-modal-view class=\\\"modal-share\\\"><ion-header-bar class=\\\"bar-dark\\\"><div class=\\\"title\\\">{{ ::\\'Share\\' | translate }}\\n</div><button class=\\\"button button-positive\\\" ng-click=\\\"modal.hide()\\\"><i class=\\\"icon ion-arrow-right-b\\\"></i></button>\\n</ion-header-bar><ion-content ng-cloak><div id=\\\"image\\\"><img ng-src=\\\"{{ ::form.photo}}\\\"><div class=\\\"title\\\">\\n{{ ::form.title }}</div></div><ul class=\\\"list\\\"><li class=\\\"padding\\\"><button ng-repeat=\\\"social in sociais\\\" \\nng-click=\\\"share(form, social)\\\" class=\\\"button button-block button-{{ social }}\\\"><i class=\\\"icon ion-social-{{ social }}\\\">\\n</i> {{ ::social | uppercase }}</button></li></ul></ion-content></ion-modal-view>\");\n$templateCache.put(\"app/component/ion-photo/view/photo.filter.carousel.html\",\"<div class=\\\"wide-as-needed\\\"><a ng-repeat=\\\"filter in filters\\\" ng-click=\\\"applyFilter(\\'image\\', filter)\\\"><div caman \\nimage=\\\"image\\\" name=\\\"filter\\\" filter=\\\"filter\\\" class=\\\"image\\\" loading=\\\"loading\\\" ng-class=\\\"{disabled: loading}\\\"></div>\\n<ion-spinner ng-if=\\\"loading\\\"></ion-spinner><p>{{ ::filter }}</p></a></div>\");\n$templateCache.put(\"app/component/ion-photo/view/photo.filter.html\",\"<div class=\\\"capture-photo\\\"><div caman filter=\\\"\\'normal\\'\\\" loading=\\\"loadingMaster\\\" class=\\\"image\\\" \\nng-class=\\\"{disabled: loadingMaster}\\\" name=\\\"\\'image\\'\\\" image=\\\"image\\\"></div><ion-spinner ng-show=\\\"loadingMaster\\\">\\n</ion-spinner></div><photo-filter-carousel apply=\\\"applyFilter\\\" image=\\\"image\\\"></photo-filter-carousel>\");}]);\n}());\n"],"sourceRoot":"/source/"}